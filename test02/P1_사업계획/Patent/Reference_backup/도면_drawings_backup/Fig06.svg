<?xml version="1.0" encoding="UTF-8"?>
<!-- REFINED: Spec-Compliant Figure 6 (Recorder + Viewer System) -->
<svg width="1000" height="900" viewBox="0 0 1000 900" xmlns="http://www.w3.org/2000/svg">
    <rect width="100%" height="100%" fill="white"/>
    
    <defs>
        <marker id="arrow" markerWidth="6" markerHeight="6" refX="6" refY="3" orient="auto">
            <path d="M0,0 L6,3 L0,6 L1.5,3 Z" fill="black"/>
        </marker>
    </defs>

    <!-- TITLE -->
    <text x="500" y="60" text-anchor="middle" font-family="Malgun Gothic, AppleGothic, Dotum, sans-serif" font-size="36" font-weight="bold">도 6: SAL 그리드 레코더 및 뷰어 시스템</text>

    <!-- 0. Recorder (60) - Added at TOP as requested -->
    <g transform="translate(100, 120)">
        <rect x="0" y="0" width="800" height="80" fill="white" stroke="black" stroke-width="3"/>
        <text x="400" y="50" text-anchor="middle" font-family="Malgun Gothic, sans-serif" font-size="28" font-weight="bold">SAL 그리드 레코더 (60)</text>
    </g>
    <!-- Arrow: Recorder -> Data Source -->
    <line x1="500" y1="200" x2="500" y2="250" stroke="black" stroke-width="3" marker-end="url(#arrow)"/>


    <!-- Layer 1: Data Source (61) - Shifted Down -->
    <g transform="translate(100, 250)">
        <rect x="0" y="0" width="800" height="150" fill="white" stroke="black" stroke-width="3"/>
        <text x="400" y="40" text-anchor="middle" font-family="Malgun Gothic, sans-serif" font-size="28" font-weight="bold">데이터 소스 레이어 (61)</text>
        
        <!-- DB Source -->
        <rect x="100" y="60" width="250" height="70" fill="white" stroke="black" stroke-width="2"/>
        <text x="225" y="95" text-anchor="middle" font-family="Malgun Gothic, sans-serif" font-size="20">데이터베이스 소스</text>
        <text x="225" y="120" text-anchor="middle" font-family="Malgun Gothic, sans-serif" font-size="16">(관계형 DB)</text>

        <!-- "OR" -->
        <text x="400" y="105" text-anchor="middle" font-family="Malgun Gothic, sans-serif" font-size="20" font-weight="bold">또는</text>

        <!-- File Source -->
        <rect x="450" y="60" width="250" height="70" fill="white" stroke="black" stroke-width="2"/>
        <text x="575" y="95" text-anchor="middle" font-family="Malgun Gothic, sans-serif" font-size="20">파일 저장소</text>
        <text x="575" y="120" text-anchor="middle" font-family="Malgun Gothic, sans-serif" font-size="16">(JSON/XML)</text>
    </g>
    <line x1="500" y1="400" x2="500" y2="450" stroke="black" stroke-width="3" marker-end="url(#arrow)"/>

    <!-- Layer 2: Viewer Engine (62) - Shifted Down -->
    <g transform="translate(100, 450)">
        <rect x="0" y="0" width="800" height="150" fill="white" stroke="black" stroke-width="3"/>
        <text x="400" y="40" text-anchor="middle" font-family="Malgun Gothic, sans-serif" font-size="28" font-weight="bold">뷰어 엔진 (62)</text>

        <!-- Data Loader -->
        <rect x="100" y="60" width="250" height="70" fill="white" stroke="black" stroke-width="2"/>
        <text x="225" y="105" text-anchor="middle" font-family="Malgun Gothic, sans-serif" font-size="24">Data Loader</text>

        <line x1="350" y1="95" x2="450" y2="95" stroke="black" stroke-width="2" marker-end="url(#arrow)"/>

        <!-- State Parser -->
        <rect x="450" y="60" width="250" height="70" fill="white" stroke="black" stroke-width="2"/>
        <text x="575" y="105" text-anchor="middle" font-family="Malgun Gothic, sans-serif" font-size="24">State Parser</text>
    </g>
    <line x1="500" y1="600" x2="500" y2="650" stroke="black" stroke-width="3" marker-end="url(#arrow)"/>

    <!-- Layer 3: UI Rendering (63) - Shifted Down -->
    <g transform="translate(100, 650)">
        <rect x="0" y="0" width="800" height="150" fill="white" stroke="black" stroke-width="3"/>
        <text x="400" y="40" text-anchor="middle" font-family="Malgun Gothic, sans-serif" font-size="28" font-weight="bold">UI 렌더링 레이어 (63)</text>

        <!-- 2D Card View -->
        <rect x="50" y="60" width="210" height="70" fill="white" stroke="black" stroke-width="2"/>
        <text x="155" y="105" text-anchor="middle" font-family="Malgun Gothic, sans-serif" font-size="22">2D 카드 뷰</text>

        <!-- 3D Block View -->
        <rect x="295" y="60" width="210" height="70" fill="white" stroke="black" stroke-width="2"/>
        <text x="400" y="105" text-anchor="middle" font-family="Malgun Gothic, sans-serif" font-size="22">3D 블록 뷰</text>

        <!-- Dashboard -->
        <rect x="540" y="60" width="210" height="70" fill="white" stroke="black" stroke-width="2"/>
        <text x="645" y="105" text-anchor="middle" font-family="Malgun Gothic, sans-serif" font-size="22">Dashboard</text>
    </g>

</svg>
