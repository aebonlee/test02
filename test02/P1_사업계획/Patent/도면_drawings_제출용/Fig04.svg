<?xml version="1.0" encoding="UTF-8"?>
<!-- REFINED: Spec-Compliant Figure 4 (Solid Parser Module, External Grid Gen connection) -->
<svg width="1000" height="1200" viewBox="0 0 1000 1200" xmlns="http://www.w3.org/2000/svg">
    <rect width="100%" height="100%" fill="white"/>
    
    <defs>
        <marker id="arrow" markerWidth="6" markerHeight="6" refX="6" refY="3" orient="auto">
            <path d="M0,0 L6,3 L0,6 L1.5,3 Z" fill="black"/>
        </marker>
    </defs>

    <!-- TITLE -->
    <text x="500" y="60" text-anchor="middle" font-family="Malgun Gothic, AppleGothic, Dotum, sans-serif" font-size="40" font-weight="bold">도 4: 파서 프로세스</text>

    <!-- PARENT: Parser Module (40) - SOLID BOX -->
    <rect x="100" y="120" width="800" height="900" rx="10" fill="none" stroke="black" stroke-width="3"/>
    <text x="500" y="160" text-anchor="middle" font-family="Malgun Gothic, sans-serif" font-size="30" font-weight="bold">파서 모듈 (40)</text>

    <!-- 1. Input -->
    <g transform="translate(350, 200)">
        <rect x="0" y="0" width="300" height="60" rx="10" fill="white" stroke="black" stroke-width="2"/>
        <text x="150" y="40" text-anchor="middle" font-family="Malgun Gothic, sans-serif" font-size="20">입력: SAL ID 문자열</text>
    </g>
    <line x1="500" y1="260" x2="500" y2="300" stroke="black" stroke-width="2" marker-end="url(#arrow)"/>

    <!-- 2. Parsing (Decision) -->
    <!-- Diamond -->
    <path d="M 500,300 L 700,360 L 500,420 L 300,360 Z" fill="white" stroke="black" stroke-width="2" />
    <text x="500" y="360" text-anchor="middle" font-family="Malgun Gothic, sans-serif" font-size="20">파싱 처리</text>
    <text x="500" y="385" text-anchor="middle" font-family="Malgun Gothic, sans-serif" font-size="16">(Parsing)</text>
    
    <!-- Yes Path -->
    <text x="520" y="440" font-family="Malgun Gothic, sans-serif" font-size="16">Yes</text>
    <line x1="500" y1="420" x2="500" y2="480" stroke="black" stroke-width="2" marker-end="url(#arrow)"/>
    
    <!-- No Path (Right -> Exception) -->
    <text x="710" y="350" font-family="Malgun Gothic, sans-serif" font-size="16">No</text>
    <line x1="700" y1="360" x2="780" y2="360" stroke="black" stroke-width="2" marker-end="url(#arrow)"/>


    <!-- 3. Range Check (Decision) -->
    <path d="M 500,480 L 700,540 L 500,600 L 300,540 Z" fill="white" stroke="black" stroke-width="2" />
    <text x="500" y="540" text-anchor="middle" font-family="Malgun Gothic, sans-serif" font-size="20">범위 검사</text>
    <text x="500" y="565" text-anchor="middle" font-family="Malgun Gothic, sans-serif" font-size="16">(Range)</text>

    <!-- Yes Path -->
    <text x="520" y="620" font-family="Malgun Gothic, sans-serif" font-size="16">Yes</text>
    <line x1="500" y1="600" x2="500" y2="660" stroke="black" stroke-width="2" marker-end="url(#arrow)"/>

    <!-- No Path -->
    <text x="710" y="530" font-family="Malgun Gothic, sans-serif" font-size="16">No</text>
    <path d="M 700,540 L 780,540 L 780,450" fill="none" stroke="black" stroke-width="2" marker-end="url(#arrow)"/> 


    <!-- 4. Code Validation (Decision) -->
    <path d="M 500,660 L 700,720 L 500,780 L 300,720 Z" fill="white" stroke="black" stroke-width="2" />
    <text x="500" y="720" text-anchor="middle" font-family="Malgun Gothic, sans-serif" font-size="20">코드 유효성 검사</text>
    <text x="500" y="745" text-anchor="middle" font-family="Malgun Gothic, sans-serif" font-size="16">(Validation)</text>

    <!-- Yes Path -->
    <text x="520" y="800" font-family="Malgun Gothic, sans-serif" font-size="16">Yes</text>
    <line x1="500" y1="780" x2="500" y2="840" stroke="black" stroke-width="2" marker-end="url(#arrow)"/>

    <!-- No Path -->
    <text x="710" y="710" font-family="Malgun Gothic, sans-serif" font-size="16">No</text>
    <path d="M 700,720 L 840,720 L 840,450" fill="none" stroke="black" stroke-width="2" marker-end="url(#arrow)"/>


    <!-- EXCEPTION HANDLING BOX (Inside Parent, Right Side) -->
    <g transform="translate(750, 300)">
        <rect x="0" y="0" width="130" height="150" rx="5" fill="white" stroke="black" stroke-width="2"/>
        <text x="65" y="40" text-anchor="middle" font-family="Malgun Gothic, sans-serif" font-size="18" font-weight="bold">예외 처리</text>
        <text x="65" y="80" text-anchor="middle" font-family="Malgun Gothic, sans-serif" font-size="14">(Unassigned</text>
        <text x="65" y="100" text-anchor="middle" font-family="Malgun Gothic, sans-serif" font-size="14">Queue)</text>
    </g>


    <!-- 5. Sort Key Generation (Process) -->
    <rect x="300" y="840" width="400" height="60" fill="white" stroke="black" stroke-width="2"/>
    <text x="500" y="880" text-anchor="middle" font-family="Malgun Gothic, sans-serif" font-size="20">정렬키 생성</text>
    <line x1="500" y1="900" x2="500" y2="940" stroke="black" stroke-width="2" marker-end="url(#arrow)"/>

    <!-- 6. Parsed Object (Internal Result) -->
    <g transform="translate(300, 940)">
        <rect x="0" y="0" width="400" height="60" fill="white" stroke="black" stroke-width="2"/>
        <text x="200" y="35" text-anchor="middle" font-family="Malgun Gothic, sans-serif" font-size="20">파싱된 객체</text>
    </g>
    
    <!-- ARROW TO EXTERNAL -->
    <line x1="500" y1="1000" x2="500" y2="1080" stroke="black" stroke-width="3" marker-end="url(#arrow)"/>

    <!-- 7. EXTERNAL: Grid Generator -->
    <rect x="300" y="1080" width="400" height="80" fill="white" stroke="black" stroke-width="3"/>
    <text x="500" y="1130" text-anchor="middle" font-family="Malgun Gothic, sans-serif" font-size="24" font-weight="bold">SAL 그리드 생성기 (52)</text>

</svg>