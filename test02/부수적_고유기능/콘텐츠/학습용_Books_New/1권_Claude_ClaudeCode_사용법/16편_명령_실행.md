# 16편 | 명령 실행

---

Claude Code는 터미널 명령어를 직접 실행할 수 있다. git, npm, docker 등 개발에 필요한 모든 명령어를 Claude Code를 통해 실행하고 결과를 확인할 수 있다. 이 편에서는 명령 실행과 관련된 3가지 도구를 살펴본다.

## 1. 명령 실행 도구 개요

### 1-1 3가지 도구

| 도구 | 기능 | 사용 시점 |
|------|------|----------|
| **Bash** | 셸 명령어 실행 | 터미널 명령 실행 시 |
| **KillShell** | 백그라운드 작업 중지 | 장시간 작업 종료 시 |
| **TaskOutput** | 작업 결과 가져오기 | 백그라운드 작업 결과 확인 시 |

### 1-2 기본 흐름

```
일반 명령어
    → Bash 실행 → 결과 반환

장시간 명령어
    → Bash (백그라운드) → TaskOutput으로 결과 확인
                       → 필요시 KillShell로 중지
```

## 2. Bash - 셸 명령어 실행

### 2-1 기본 사용

Bash는 터미널 명령어를 실행한다. "이 명령어 실행해줘"라고 하면 Claude Code가 Bash 도구를 사용한다.

```
사용자: git status 실행해줘
Claude: [Bash 도구로 명령 실행]
        On branch main
        nothing to commit, working tree clean
```

### 2-2 지원하는 명령어

개발에 사용하는 대부분의 명령어를 실행할 수 있다.

**버전 관리:**
```
git status
git add .
git commit -m "메시지"
git push
git pull
```

**패키지 관리:**
```
npm install
npm run build
npm test
pip install 패키지
```

**빌드 및 실행:**
```
npm run dev
python script.py
docker build .
docker-compose up
```

**시스템 명령어:**
```
ls -la
pwd
mkdir 폴더명
rm 파일명
```

### 2-3 타임아웃

명령어 실행에는 기본 2분(120초) 타임아웃이 있다. 최대 10분(600초)까지 설정 가능하다.

```
사용자: 빌드 실행해줘 (오래 걸릴 수 있어)
Claude: [Bash 도구 - timeout: 300000 (5분)]
```

타임아웃이 지나면 명령이 중단된다. 더 오래 걸리는 작업은 백그라운드 실행을 사용한다.

### 2-4 백그라운드 실행

오래 걸리는 명령어는 백그라운드로 실행할 수 있다.

```
사용자: 서버 실행해줘 (백그라운드로)
Claude: [Bash 도구 - run_in_background: true]
        백그라운드에서 서버가 시작되었습니다.
        작업 ID: shell_abc123
```

백그라운드 실행 후:
- 다른 작업을 계속할 수 있음
- TaskOutput으로 결과 확인 가능
- KillShell로 중지 가능

### 2-5 명령어 연결

여러 명령어를 한 번에 실행할 수 있다.

**순차 실행 (앞 명령 성공 시에만):**
```
npm install && npm run build && npm test
```

**순차 실행 (실패해도 계속):**
```
npm install; npm run build; npm test
```

**병렬 실행:**
Claude Code에서 여러 Bash 도구를 동시에 호출하면 병렬로 실행된다.

### 2-6 출력 제한

명령어 출력이 30,000자를 초과하면 잘린다. 긴 출력이 예상되면 파일로 저장하는 것이 좋다.

```
npm test > test-result.txt
```

## 3. KillShell - 백그라운드 작업 중지

### 3-1 기본 사용

KillShell은 실행 중인 백그라운드 셸을 종료한다.

```
사용자: 아까 실행한 서버 중지해줘
Claude: [KillShell 도구 - shell_id: shell_abc123]
        서버가 종료되었습니다.
```

### 3-2 작업 ID 확인

실행 중인 작업 목록은 `/tasks` 명령어로 확인할 수 있다.

```
사용자: /tasks
Claude: 현재 실행 중인 작업:
        - shell_abc123: npm run dev (실행 중)
        - shell_def456: npm test (완료)
```

### 3-3 언제 사용하는가

- 개발 서버 중지
- 무한 루프에 빠진 스크립트 종료
- 오래 걸리는 작업 취소
- 잘못된 명령어 중단

## 4. TaskOutput - 작업 결과 가져오기

### 4-1 기본 사용

TaskOutput은 백그라운드 작업의 결과를 가져온다.

```
사용자: 아까 실행한 테스트 결과 보여줘
Claude: [TaskOutput 도구 - task_id: shell_def456]
        테스트 결과:
        ✓ 24 tests passed
        ✗ 2 tests failed
```

### 4-2 블로킹 vs 논블로킹

**블로킹 (기본값):**
작업이 완료될 때까지 기다린다.
```
block: true (기본값)
```

**논블로킹:**
현재 상태만 확인하고 바로 반환한다.
```
block: false
```

### 4-3 타임아웃

결과를 기다리는 최대 시간을 설정할 수 있다.

```
timeout: 30000 (30초)
```

기본값은 30초이고, 최대 10분(600,000ms)까지 설정 가능하다.

### 4-4 활용 예시

```
사용자: 빌드 백그라운드로 실행하고 결과 알려줘

Claude:
1. [Bash - run_in_background: true]
   빌드 시작... 작업 ID: shell_xyz789

2. [TaskOutput - task_id: shell_xyz789, block: true]
   빌드 완료!
   Bundle size: 245KB
   Time: 23.5s
```

## 5. 실전 활용

### 5-1 Git 워크플로우

```
사용자: 현재 변경사항 커밋하고 푸시해줘

Claude:
1. [Bash: git status]
   변경된 파일 3개 확인

2. [Bash: git add .]
   스테이징 완료

3. [Bash: git commit -m "feat: 새 기능 추가"]
   커밋 생성

4. [Bash: git push]
   푸시 완료
```

### 5-2 개발 서버 관리

```
사용자: 개발 서버 시작해줘

Claude: [Bash - run_in_background: true]
        npm run dev
        → 서버가 http://localhost:3000 에서 시작되었습니다.
        → 백그라운드에서 실행 중 (ID: shell_server01)

사용자: 서버 로그 보여줘

Claude: [TaskOutput - task_id: shell_server01, block: false]
        최근 로그:
        [15:30:22] Request: GET /api/users
        [15:30:23] Response: 200 OK

사용자: 서버 중지해줘

Claude: [KillShell - shell_id: shell_server01]
        서버가 종료되었습니다.
```

### 5-3 테스트 실행

```
사용자: 테스트 실행하고 실패한 것만 알려줘

Claude:
1. [Bash: npm test]

2. 결과 분석:
   ✓ 45 tests passed
   ✗ 2 tests failed:
   - user.test.js: 로그인 테스트 실패
   - api.test.js: 타임아웃 에러
```

### 5-4 빌드 및 배포

```
사용자: 프로덕션 빌드하고 배포해줘

Claude:
1. [Bash: npm run build]
   빌드 완료 (2분 30초)

2. [Bash: npm run deploy]
   배포 완료
   URL: https://my-app.vercel.app
```

### 5-5 Docker 작업

```
사용자: Docker 이미지 빌드하고 실행해줘

Claude:
1. [Bash: docker build -t myapp .]
   이미지 빌드 완료

2. [Bash - run_in_background: true]
   docker run -p 3000:3000 myapp
   → 컨테이너 실행 중
```

## 6. 보안 및 주의사항

### 6-1 위험한 명령어

Claude Code는 위험한 명령어 실행 전에 경고하거나 거부한다.

**주의가 필요한 명령어:**
- `rm -rf /` - 시스템 전체 삭제
- `git push --force` - 원격 히스토리 덮어쓰기
- `DROP DATABASE` - 데이터베이스 삭제
- 비밀번호나 API 키가 포함된 명령어

### 6-2 샌드박스 모드

일부 환경에서는 샌드박스 모드로 실행되어 특정 명령어가 제한될 수 있다.

```
dangerouslyDisableSandbox: true
→ 샌드박스 비활성화 (권장하지 않음)
```

### 6-3 환경 변수

민감한 정보는 환경 변수로 관리하고, 명령어에 직접 입력하지 않는다.

```
✗ curl -H "Authorization: Bearer sk-abc123" ...
✓ curl -H "Authorization: Bearer $API_KEY" ...
```

### 6-4 현재 디렉토리

Bash는 지정된 작업 디렉토리에서 실행된다. `cd` 명령어보다 절대 경로 사용을 권장한다.

```
✗ cd /project && npm test
✓ npm test --prefix /project
```

### 6-5 출력 주의

명령어 출력에 민감한 정보가 포함될 수 있다.

- 환경 변수 출력 (`env`, `printenv`)
- 설정 파일 내용 (`cat .env`)
- 로그 파일 (API 키, 토큰 등)

## 7. 정리

### 도구별 역할

| 도구 | 언제 사용 | 예시 |
|------|----------|------|
| Bash | 명령어 실행 | git, npm, docker 등 |
| KillShell | 백그라운드 작업 중지 | 서버 종료, 작업 취소 |
| TaskOutput | 백그라운드 결과 확인 | 빌드 결과, 서버 로그 |

### 명령어 실행 패턴

| 상황 | 방법 |
|------|------|
| 짧은 명령어 | Bash (기본) |
| 긴 명령어 | Bash (timeout 증가) |
| 서버 실행 | Bash (백그라운드) + TaskOutput |
| 작업 취소 | KillShell |
| 여러 명령어 순차 | `&&`로 연결 |

---

**작성일: 2025-12-20 / 글자수: 약 4,200자 / 작성자: Claude / 프롬프터: 써니**

