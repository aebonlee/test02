# .env 파일로 환경변수 안전하게 관리하고 배포 환경별로 분리하기

> 이 문서는 환경변수(.env)를 안전하고 효율적으로 관리하는 방법을 설명합니다.

---

## 핵심 원칙

1. **.env.example은 Git에 커밋**: 필요한 변수 목록 공유
2. **.env.local은 .gitignore에 추가**: 실제 값은 커밋 금지
3. **서버 재시작 필수**: 환경변수 변경 후 반드시 재시작

---

## 파일 구조

| 파일 | Git 커밋 | 용도 |
|------|:--------:|------|
| `.env.example` | O | 필요한 변수 목록 (빈 값) |
| `.env.local` | X | 로컬 개발용 실제 값 |
| `.env.production` | X | 프로덕션용 값 (서버에서 관리) |

---

## .env.example 작성 예시

```bash
# Supabase 설정
SUPABASE_URL=
SUPABASE_ANON_KEY=
SUPABASE_SERVICE_ROLE_KEY=

# OpenAI API
OPENAI_API_KEY=

# 앱 설정
NEXT_PUBLIC_APP_URL=http://localhost:3000
NEXT_PUBLIC_SITE_NAME=My App
```

---

## .gitignore 설정

```gitignore
# 환경변수 (실제 값이 있는 파일)
.env
.env.local
.env.development
.env.production

# 예외: 템플릿은 커밋
!.env.example
```

---

## 설정 순서

```bash
# 1. 템플릿 복사
cp .env.example .env.local

# 2. 편집기로 열기
code .env.local

# 3. 실제 값 입력 후 저장

# 4. 서버 재시작 (필수!)
npm run dev
```

---

## 프레임워크별 브라우저 접근 접두사

| 프레임워크 | 접두사 | 예시 |
|-----------|--------|------|
| Next.js | `NEXT_PUBLIC_` | `NEXT_PUBLIC_APP_URL` |
| Vite | `VITE_` | `VITE_API_URL` |
| Create React App | `REACT_APP_` | `REACT_APP_API_URL` |

**주의**: 접두사가 있는 변수만 브라우저에서 접근 가능. API 키처럼 민감한 정보는 접두사 없이 서버에서만 사용.

---

## Claude Code에게 요청하기

```
".env.example 파일 만들어줘"
"환경변수 설정 확인해줘"
".gitignore에 .env 추가해줘"
"NEXT_PUBLIC 변수 어떤 게 있는지 찾아줘"
```

---

## 흔한 실수

| 실수 | 해결 |
|------|------|
| 환경변수 변경 후 안 됨 | 서버 재시작 |
| 브라우저에서 undefined | NEXT_PUBLIC_ 접두사 확인 |
| Git에 .env 커밋됨 | .gitignore 추가 후 git rm --cached |

---

*상세 내용: `API_키_보안_관리.md` 참조*
