# 배포 및 도메인 설정 가이드

> Vercel + Whois DNS + 환경변수

---

# Part A - 기초

> PO(Project Owner; 사람)가 직접 해야 할 설정

---

## Step 1: Vercel 프로젝트 생성

1. https://vercel.com 접속 → GitHub 로그인
2. **Add New...** → **Project**
3. GitHub 저장소 선택
4. 아래 정보 입력:

| 항목 | 입력 |
|------|------|
| Project Name | ssal-works (소문자, 하이픈만) |
| Framework Preset | Other |
| Root Directory | Production/Frontend |
| Build Command | (비워두기) |

5. **Deploy** 클릭

---

## Step 2: 환경변수 설정

1. Vercel → Project → **Settings** → **Environment Variables**
2. 아래 환경변수 추가:

| Key | Value |
|-----|-------|
| SUPABASE_URL | https://xxx.supabase.co |
| SUPABASE_ANON_KEY | eyJxxx... |
| SUPABASE_SERVICE_ROLE_KEY | eyJxxx... |
| RESEND_API_KEY | re_xxx... |

3. Environment: **All** 선택

---

## Step 3: Vercel에 도메인 추가

1. Vercel → Project → **Settings** → **Domains**
2. 도메인 입력: `www.ssalworks.ai.kr`
3. **Add** 클릭
4. 아래 정보 복사:

| Type | Name | Value |
|------|------|-------|
| A | www | 76.76.21.21 |
| TXT | _vercel | vc-domain-verify=... |

---

## Step 4: Whois DNS 설정

1. https://whois.co.kr 로그인
2. 도메인 관리 → 해당 도메인 선택
3. 부가서비스 → **네임서버 고급설정**

### A 레코드 추가
1. **A 레코드 관리** → 관리페이지 열기
2. 입력:

| 호스트명 | IP 주소 |
|----------|---------|
| www | 76.76.21.21 |

### TXT 레코드 추가
1. **SPF(TXT) 레코드 관리** → 관리페이지 열기
2. 입력:

| 호스트명 | 값 |
|----------|-----|
| _vercel | vc-domain-verify=... (Vercel에서 복사) |

---

## Step 5: DNS 전파 확인

1. 명령어로 확인:
   ```
   nslookup www.ssalworks.ai.kr 8.8.8.8
   ```

2. Vercel Dashboard에서 상태 확인:
   - ⚠️ Verification Needed → 전파 대기
   - ✅ Valid Configuration → 성공

---

## 체크리스트

- [ ] Vercel 프로젝트 생성 완료
- [ ] 환경변수 설정 완료
- [ ] Vercel에 도메인 추가 완료
- [ ] Whois A 레코드 추가 완료
- [ ] Whois TXT 레코드 추가 완료
- [ ] DNS 전파 확인 완료
- [ ] https://www.ssalworks.ai.kr 접속 성공

---

# Part B - 심화

> Claude Code 참조용 기술 문서

**전제조건**: Part A 완료 (Vercel 배포, 도메인 연결)

---

## 1. 폴더 구조

```
Production/
├── Database/          ← DB 스키마/SQL
└── Frontend/          ← Vercel Root Directory
    ├── api/           ← Serverless Functions
    │   ├── auth/
    │   ├── email/
    │   └── subscription/
    ├── assets/
    ├── pages/
    ├── index.html
    └── vercel.json
```

---

## 2. vercel.json 설정

```json
{
  "version": 2,
  "name": "ssalworks-v1",
  "buildCommand": null,
  "outputDirectory": ".",
  "framework": null,
  "rewrites": [
    {
      "source": "/api/:path*",
      "destination": "/api/:path*"
    }
  ],
  "headers": [
    {
      "source": "/api/(.*)",
      "headers": [
        { "key": "Access-Control-Allow-Credentials", "value": "true" },
        { "key": "Access-Control-Allow-Origin", "value": "*" },
        { "key": "Access-Control-Allow-Methods", "value": "GET,POST,PUT,DELETE,OPTIONS" },
        { "key": "Access-Control-Allow-Headers", "value": "X-CSRF-Token, X-Requested-With, Accept, Accept-Version, Content-Length, Content-MD5, Content-Type, Date, X-Api-Version, Authorization" }
      ]
    }
  ],
  "functions": {
    "api/**/*.js": {
      "maxDuration": 30,
      "memory": 1024
    }
  }
}
```

---

## 3. 트러블슈팅

### 문제 1: Project Name 에러

**증상**: `The name contains invalid characters`

**해결**: 소문자, 숫자, 하이픈만 사용
- ❌ `SSALWorks`
- ✅ `ssal-works`

### 문제 2: 함수 패턴 에러

**증상**: `The pattern doesn't match any Serverless Functions`

**해결**: vercel.json에서 존재하지 않는 패턴 제거

### 문제 3: 도메인 소유권 확인

**증상**: `This domain is linked to another Vercel account`

**해결**:
1. TXT 레코드 추가 (_vercel)
2. DNS 전파 대기
3. Vercel에서 "Refresh" 클릭

### 문제 4: DNS_PROBE_FINISHED_NXDOMAIN

**해결**: DNS 전파 완료까지 대기 (최대 48시간)

### 문제 5: 특수문자 입력 불가

**해결**: 일반 DNS 관리가 아닌 **네임서버 고급설정** 사용

---

## 4. 권장 설정

| 항목 | 권장 값 |
|------|---------|
| 네임서버 | Whois 기본값 (ns1.whoisdomain.kr) |
| DNS 관리 | Whois 네임서버 고급설정 |
| 도메인 | www.ssalworks.ai.kr (www 포함) |
| A 레코드 | 76.76.21.21 |

---

## 참고 문서

- [Vercel - Adding a Domain](https://vercel.com/docs/projects/domains/add-a-domain)
- [Vercel - Serverless Functions](https://vercel.com/docs/functions)
- [Vercel - Environment Variables](https://vercel.com/docs/projects/environment-variables)
