# Task 불일치 원인 분석 보고서

> **작성일**: 2025-12-19
> **분석 대상**: Task Plan vs Task Instruction vs Seed SQL vs Verification Instruction
> **발견된 불일치**: 52개 중 약 25개 불일치 (48%)

---

## 1. 불일치 유형 분류

### 유형 A: 완전 누락 (Task 자체가 없음)
| Task ID | Task Name | 원인 |
|---------|-----------|------|
| S1BI2 | Sentry 에러 트래킹 설정 | v4.0에서 Stage 이동 (S4BI1 → S1BI2) |
| S2F3 | 회원가입 UI | v4.0에서 신규 추가 |
| S2BA4 | 회원가입 API | v4.0에서 신규 추가 |
| S2BA5 | 프로젝트 관리 API | v4.0에서 신규 추가 |
| S3F1 | AI Q&A 인터페이스 | v4.0에서 Stage 이동 (S4F2 → S3F1) |
| S3BA2 | AI 가격 조회 API | v4.0에서 신규 추가 |
| S4F3 | 크레딧 충전 UI | v4.0에서 신규 추가 |
| S4F4 | 결제 수단 등록 UI | v4.0에서 신규 추가 |
| S4BA3 | 결제 수단 등록 API | v4.0에서 신규 추가 |
| S4BA4 | 크레딧 충전 API | v4.0에서 신규 추가 |
| S4BA5 | 설치비 입금 확인 API | v4.0에서 신규 추가 |
| S4D1 | 결제/크레딧 테이블 | v4.0에서 신규 추가 |

**소계**: 12개 Task 누락

### 유형 B: Task Name 불일치 (파일은 있지만 내용이 다름)
| Task ID | 기존 (잘못됨) | 수정 후 (Task Plan 일치) |
|---------|-------------|----------------------|
| S4S1 | 결제 보안 | 관리자 권한 체크 |
| S4T1 | 결제 테스트 | E2E 테스트 |
| S4T2 | E2E 결제 테스트 | API 통합 테스트 |
| S4O1 | PG사 설정 | Cron Jobs 설정 |
| S4M1 | MVP 최종 검토 | 관리자 가이드 |
| S5F1 | 랜딩페이지 최적화 | 버그 수정 (프론트엔드) |
| S5BA1 | 모니터링 API | API 버그 수정 및 최적화 |
| S5S1 | SSL/보안 설정 | 보안 점검 및 패치 |
| S5O1 | 도메인 연결 | 프로덕션 배포 |
| S5O3 | 모니터링 설정 | SSL 인증서 확인 |

**소계**: 10개 Task Name 불일치

### 유형 C: 불필요한 파일 존재 (삭제 대상)
| Task ID | 원래 용도 | 삭제 이유 |
|---------|----------|----------|
| S4BI1 | Sentry 에러 트래킹 | S1BI2로 Stage 이동 |
| S4F2 | AI Q&A UI | S3F1로 Stage 이동 |

**소계**: 2개 불필요 파일

---

## 2. 근본 원인 분석

### 원인 1: 잦은 Task Plan 변경 (1주일에 10회)

```
버전 변화 타임라인:
────────────────────────────────────────────────────────────
2025-11-27  v1.0  │ 86개 Task  │ 초기 작성
2025-12-12  v2.0  │ 50개 Task  │ 구조 변경 (-36)
2025-12-12  v3.0  │ 42개 Task  │ 아키텍처 확정 (-8)
2025-12-17  v3.1  │ 41개 Task  │ S5O2 삭제 (-1)
2025-12-17  v3.2  │ 42개 Task  │ S2BI3 추가 (+1)
2025-12-18  v3.3  │ 42개 Task  │ 이메일 도메인 인증 추가
2025-12-19  v3.4  │ 42개 Task  │ 이름 통일
2025-12-19  v4.0  │ 52개 Task  │ 누락 Task 10개 추가 (+10)
────────────────────────────────────────────────────────────

문제: Task Plan이 1주일 동안 8번 변경됨
      하위 문서들은 v3.0 시점 기준으로 생성되어 이후 변경 미반영
```

### 원인 2: 늦은 User Flow 분석

```
문제 발생 순서:
────────────────────────────────────────────────────────────
1. Task Plan v3.0 작성 (42개 Task)
   ↓
2. Task Instruction 파일 42개 생성 (v3.0 기준)
   ↓
3. Seed SQL 작성 (v3.0 기준)
   ↓
4. Verification Instruction 파일 생성 (v3.0 기준)
   ↓
5. ★ User Flow 상세 분석 수행 ★
   ↓
6. 누락 Task 10개 발견!
   - 회원가입 UI/API 누락
   - 크레딧 충전 UI/API 누락
   - 결제 수단 등록 UI/API 누락
   - AI 가격 조회 API 누락
   - 결제/크레딧 테이블 누락
   ↓
7. Task Plan v4.0으로 업데이트 (52개 Task)
   ↓
8. 하위 문서들은 여전히 42개 기준 ← 불일치 발생!
────────────────────────────────────────────────────────────

원인: User Flow 분석이 Task Plan 작성 이후에 수행됨
      처음부터 User Flow를 기반으로 Task를 도출했어야 함
```

### 원인 3: 동기화 프로세스 부재

```
현재 상황 (동기화 프로세스 없음):
────────────────────────────────────────────────────────────
Task Plan 수정
    ↓ (수동)
Task Instruction 수정 ← 누락 가능
    ↓ (수동)
Seed SQL 수정 ← 누락 가능
    ↓ (수동)
Verification Instruction 수정 ← 누락 가능
    ↓ (수동)
Order Sheet 수정 ← 누락 가능
────────────────────────────────────────────────────────────

이상적인 상황 (동기화 프로세스 있음):
────────────────────────────────────────────────────────────
Task Plan 수정
    ↓ (자동)
┌─ Task Instruction 동기화
├─ Seed SQL 동기화
├─ Verification Instruction 동기화
└─ Order Sheet 동기화
────────────────────────────────────────────────────────────
```

### 원인 4: Stage 이동 시 연쇄 수정 누락

```
예시: Sentry 에러 트래킹 Task

v3.0:  S4BI1 (Stage 4에 배치)
       ↓
v4.0:  S1BI2로 Stage 이동 결정 (개발 초기 설정 필요)
       ↓
문제:  S4BI1_instruction.md는 그대로 남아있고
       S1BI2_instruction.md는 생성 안 됨
       ↓
결과:  - S4BI1 파일 삭제 필요
       - S1BI2 파일 신규 생성 필요
       - Seed SQL에서 S4BI1 삭제, S1BI2 추가 필요
       - Verification에서도 동일 작업 필요
       ↓
       모두 수동으로 해야 함 → 누락 발생
```

---

## 3. 특정 불일치 사례 분석

### 사례 1: S4S1 "결제 보안" → "관리자 권한 체크"

```
발생 원인:
- Task Plan v3.0에서 S4S1은 "결제 보안"으로 정의
- v4.0에서 결제 기능이 확장되며 S4 Stage 재구성
- S4S1의 역할이 "관리자 권한 체크"로 변경
- 하지만 Instruction/Verification 파일은 "결제 보안" 내용 그대로

영향:
- Instruction에는 결제 보안 코드 작성 지시
- 실제 필요한 것은 관리자 RBAC 로직
- Task 실행 시 완전히 다른 작업 수행할 뻔함
```

### 사례 2: 회원가입 기능 완전 누락

```
발생 원인:
- 로그인/로그아웃 UI는 있음 (S2F1)
- OAuth API는 있음 (S2BA1)
- 하지만 "회원가입" 기능 자체가 없었음!
- User Flow: 신규 사용자 → 회원가입 → 로그인
- 초기 Task Plan 작성 시 "OAuth만 있으면 되겠지" 판단
- 실제로는 회원가입 UI + API가 별도로 필요

누락된 항목:
- S2F3 회원가입 UI
- S2BA4 회원가입 API

교훈:
- User Flow 기반 Task 도출 필수
- "당연히 있겠지" 가정 금지
```

### 사례 3: 크레딧 시스템 완전 누락

```
발생 원인:
- Task Plan v3.0에서 "결제" 관련은 S4BA1, S4BA2만 존재
- S4BA1: 결제 웹훅 API
- S4BA2: 관리자 API
- 크레딧 충전 기능 완전 누락!

User Flow 분석 결과:
사용자 → 크레딧 충전 → 결제 수단 선택 → 토스 결제 → 크레딧 적립

필요한 Task:
- S4F3: 크레딧 충전 UI
- S4F4: 결제 수단 등록 UI
- S4BA3: 결제 수단 등록 API
- S4BA4: 크레딧 충전 API
- S4BA5: 설치비 입금 확인 API
- S4D1: 결제/크레딧 테이블

교훈:
- 하나의 기능(결제)에 여러 Task 필요
- End-to-End User Flow 분석 필수
```

---

## 4. 불일치 패턴 요약

| 패턴 | 발생 원인 | 영향 |
|------|----------|------|
| Task 완전 누락 | User Flow 분석 미흡 | 필수 기능 구현 불가 |
| Task Name 불일치 | 잦은 변경 + 동기화 누락 | 잘못된 작업 수행 |
| Stage 이동 미반영 | 연쇄 수정 프로세스 부재 | 파일 위치 혼란 |
| 불필요 파일 잔존 | 삭제 프로세스 부재 | 프로젝트 구조 오염 |

---

## 5. 재발 방지 권장사항

### 권장 1: User Flow 기반 Task 도출 (선행 작업)

```
올바른 순서:
1. User Flow 다이어그램 완성
2. 각 Flow별 필요 기능 도출
3. 기능별 Task 정의
4. Task Plan 작성
5. 하위 문서 생성

잘못된 순서 (현재):
1. 대략적인 Task Plan 작성
2. 하위 문서 생성
3. 나중에 User Flow 분석
4. 누락 발견
5. Task Plan 수정
6. 하위 문서 동기화 필요 (누락 발생)
```

### 권장 2: 변경 시 5단계 연쇄 동기화 필수

```
TASK_MODIFICATION_PROCESS.md 준수:

1단계: Task Plan 수정
    ↓
2단계: Task Instruction 수정
    ↓
3단계: Seed SQL 수정
    ↓
4단계: Verification Instruction 수정
    ↓
5단계: Order Sheet 수정

★ 모든 단계 완료 전까지 작업 미완료 처리!
```

### 권장 3: 자동화 스크립트 활용

```javascript
// validate_task_consistency.js
// 모든 소스 간 일치 여부 자동 검증

// 검증 항목:
// - Task Plan의 Task ID가 모든 Instruction에 존재하는가?
// - Task Name이 모든 소스에서 일치하는가?
// - Dependencies가 일치하는가?
// - 불필요한 파일이 있는가?
```

### 권장 4: Task Plan 변경 최소화

```
현재 문제:
- 1주일에 8번 변경
- 매 변경 시 동기화 부담

권장:
- Task Plan 확정 후 최소 변경
- 변경 필요 시 반드시 영향도 분석
- 변경 이력에 영향 받는 문서 명시
```

---

## 6. 결론

### 핵심 원인 3가지

1. **늦은 User Flow 분석**: Task Plan 작성 후에 User Flow 분석하여 누락 발생
2. **동기화 프로세스 부재**: Task Plan 변경 시 하위 문서 동기화 자동화 없음
3. **잦은 변경**: 1주일에 8번 변경으로 동기화 부담 가중

### 교훈

> **"Task Plan 변경은 쉽지만, 연쇄 동기화는 어렵다"**
>
> Task Plan을 한 줄 수정하면 최소 4개 문서를 수정해야 한다.
> 52개 Task × 5개 문서 유형 = 260개 항목을 일관되게 유지해야 한다.
> 수동 관리는 불일치를 유발한다.

### 앞으로의 방향

1. User Flow 기반 Task 도출 (선행)
2. 5단계 연쇄 동기화 프로세스 준수
3. 자동화 스크립트로 일관성 검증
4. Task Plan 변경 최소화

---

**보고서 끝**
