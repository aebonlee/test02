# User Flow #2: 프로젝트 등록 (Project Registration Flow)

> **최종 수정:** 2025-12-25
> **버전:** 1.1 (웰컴 크레딧 ₩50,000, 3개월 무료 반영)

---

## 1. 플로우 개요

**목적:** 사용자가 설치비를 납부하고 새로운 웹사이트 개발 프로젝트를 등록한다.

**전제 조건:** 회원가입 완료 (무료 회원)
**시작:** Dashboard에서 "새 프로젝트 등록" 버튼 클릭
**종료:** 설치비 납부 완료 + 프로젝트 등록 완료 + PROJECT SAL Grid 작업 시작
**예상 소요 시간:** 설치비 입금 확인까지 24시간 이내

---

## 2. 정상 플로우 (Normal Flow)

### Step 1: "새 프로젝트 등록" 버튼 클릭
- **위치:** Dashboard
- **액션:** 사용자가 "새 프로젝트 등록" 버튼 클릭
- **서버 확인:**
  1. 설치비 납부 여부 확인 (`installation_fee_paid`)
  2. 진행 중인 프로젝트 확인 (`status = 'in_progress'`)

---

### Step 2-A: 설치비 미납 시 → 설치비 안내 페이지

**페이지:** `/payment/installation`

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
프로젝트를 등록하려면 설치비 납부가 필요합니다

💰 SSAL Works 설치비: ₩3,000,000

포함 내용:
✅ 프로젝트 무제한 등록 (단, 프로젝트 진행은 1개씩 만)
✅ PROJECT SAL Grid 시스템 무제한 사용
✅ 플랫폼 이용료 3개월 면제 (₩150,000)
✅ AI 크레딧 ₩50,000 지급 (웰컴 크레딧 - ChatGPT, Gemini, Perplexity)
✅ Books + FAQ 무제한
✅ "써니에게 묻기" 무제한 (비즈니스 멘토링)

🎁 특별 혜택:
성공 시 50% 환불 (₩1,500,000)

환불 조건 (3개월 내):
✅ 웹사이트 완성 및 배포
✅ 서비스 런칭
✅ 10명 이상 고객 수입 발생

[설치비 납부하기] [나중에]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

---

### Step 3: 입금 안내 페이지

**[설치비 납부하기] 버튼 클릭 시:**

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
💳 입금 정보

은행: 신한은행
계좌번호: 110-123-456789
예금주: 써니(SSAL Works)
입금액: ₩3,000,000

⚠️ 입금자명: 김써니 (회원가입 시 입력한 실명)

입금 후 아래 버튼을 클릭해주세요.
[입금 완료]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

---

### Step 4: 입금 완료 클릭

- **API:** `POST /api/payment/installation-confirm`
- **Request:**
```json
{
  "user_id": "uuid",
  "depositor_name": "김써니"
}
```

- **응답 화면:**
```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
입금 확인 요청이 접수되었습니다.

관리자(써니)가 입금을 확인하는 대로
이메일과 플랫폼 알림으로 안내드리겠습니다.

평균 확인 시간: 24시간 이내 (영업일 기준)

[Dashboard로 이동]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

---

### Step 5: 관리자 입금 확인 (관리자 작업)

- **관리자 액션:**
  1. 계좌 입금 내역 확인
  2. 입금자명 일치 확인 (실명)
  3. 금액 확인 (₩3,000,000)
  4. 플랫폼에서 "입금 승인" 버튼 클릭

- **API:** `POST /api/admin/confirm-installation`
- **DB 업데이트:**
```sql
UPDATE users SET
  subscription_status = 'active',
  installation_fee_paid = true,
  installation_date = NOW(),
  platform_fee_start_date = NOW() + INTERVAL '90 days',
  credit_balance = 50000
WHERE id = 'uuid';
```

- **사용자 알림:**
  - 이메일: "설치 완료! 프로젝트를 등록하세요"
  - 플랫폼 알림: "₩50,000 웰컴 크레딧이 지급되었습니다"

---

### Step 2-B: 설치비 납부 완료 + 진행 중인 프로젝트 있음 → 완료 유도

**페이지:** 모달 팝업

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
⚠️ 진행 중인 프로젝트가 있습니다

현재 프로젝트: 블로그 프로젝트
진행률: 85% (Stage 4/5)

새 프로젝트를 등록하려면
기존 프로젝트를 먼저 완료해야 합니다.

완료 후:
- 프로젝트가 "완료됨" 목록으로 이동
- 새 프로젝트를 등록할 수 있습니다
- Order Sheet 발행으로 수정 가능

기존 프로젝트를 완료하시겠습니까?

[완료하기] [취소]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

**[완료하기] 클릭 시:**
- **API:** `POST /api/projects/{project_id}/complete`
- **DB 업데이트:**
```sql
UPDATE projects SET
  status = 'completed',
  completed_at = NOW()
WHERE id = 'project_id' AND user_id = 'user_id';
```

---

### Step 2-C: 설치비 납부 완료 + 진행 중인 프로젝트 없음 → 프로젝트 등록 페이지

**페이지:** `/projects/new`

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📁 새 프로젝트 등록

프로젝트 정보를 입력해주세요.

프로젝트명 *
┌──────────────────────────────┐
│ 예: 블로그 프로젝트           │
└──────────────────────────────┘

프로젝트 설명
┌──────────────────────────────┐
│ 개인 블로그 사이트            │
│ 일상, 여행, 사진 공유         │
└──────────────────────────────┘

웹사이트 유형 *
○ 블로그 / 포트폴리오
○ 쇼핑몰 / 이커머스
○ 회사 홈페이지
○ 커뮤니티 / 포럼
○ 기타

목표 완료일 (선택)
┌──────────────────────────────┐
│ 2026-03-01                    │
└──────────────────────────────┘

[프로젝트 등록하기] [취소]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

---

### Step 6: 프로젝트 등록 완료

**[프로젝트 등록하기] 클릭 시:**

- **API:** `POST /api/projects`
- **Request:**
```json
{
  "user_id": "uuid",
  "project_name": "블로그 프로젝트",
  "project_description": "개인 블로그 사이트...",
  "website_type": "blog",
  "target_completion_date": "2026-03-01"
}
```

- **DB 레코드 생성:**
```sql
INSERT INTO projects (
  id, user_id, project_name, description,
  website_type, status, created_at
) VALUES (
  'uuid', 'user_id', '블로그 프로젝트', '개인 블로그...',
  'blog', 'in_progress', NOW()
);
```

- **성공 팝업:**
```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🎉 프로젝트가 등록되었습니다!

프로젝트: 블로그 프로젝트
등록일: 2025-12-01

이제 PROJECT SAL Grid에서
작업을 시작할 수 있습니다!

[프로젝트 시작하기]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

---

### Step 7: PROJECT SAL Grid 화면 진입

**페이지:** `/projects/{project_id}/grid`

- **표시 내용:**
  - PROJECT SAL Grid (5 Stages)
  - 빈 그리드 (Task 없음)
  - "Task 추가" 버튼
  - 시작 안내 배너

```
┌────────────────────────────────────────┐
│  📁 블로그 프로젝트                     │
│  진행률: 0% (0/0 Task)                  │
│                                        │
│  💡 프로젝트를 시작하려면               │
│     Task를 추가해주세요!                │
│     [Task 추가 가이드 보기]             │
│                                        │
│  PROJECT SAL Grid                      │
│  ┌──────────────────────────────────┐ │
│  │  Stage 1  Stage 2  Stage 3      │ │
│  │  Stage 4  Stage 5               │ │
│  │  (비어있음)                      │ │
│  └──────────────────────────────────┘ │
│                                        │
│  [+ Task 추가]                         │
└────────────────────────────────────────┘
```

---

## 3. 예외 플로우 (Exception Flows)

### 3-1. 입금자명 불일치

- **조건:** 입금자명이 실명과 다름
- **관리자 액션:**
  1. "입금자명 불일치" 상태로 표시
  2. 사용자에게 문의 메시지 발송

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
⚠️ 입금자명 불일치 안내

입금자명: 홍길동
회원 실명: 김써니

입금자명이 실명과 다릅니다.
다음 중 하나를 선택해주세요:

A) 실명을 "홍길동"으로 수정하기
B) 다시 입금하기 (김써니 명의로)
C) 써니에게 문의하기

[선택하기]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

### 3-2. 프로젝트명 중복

- **조건:** 같은 사용자의 기존 프로젝트와 이름 중복
- **시스템 응답:**
```
❌ 이미 같은 이름의 프로젝트가 있습니다.
다른 이름을 사용해주세요.

기존 프로젝트:
- 블로그 프로젝트 (완료됨, 2025-11-15)

추천 이름:
- 블로그 프로젝트 v2
- 블로그 프로젝트 2025
- 새 블로그 프로젝트
```

### 3-3. 설치비 미납 상태에서 다른 경로 접근

- **조건:** URL 직접 입력 등으로 `/projects/new` 접근
- **시스템 응답:** 자동으로 `/payment/installation` 리다이렉트

---

## 4. 플로우 다이어그램

```
[Dashboard]
    ↓
[새 프로젝트 등록] 버튼 클릭
    ↓
설치비 납부 확인
    ├─ 미납 → [설치비 안내 페이지]
    │           ↓
    │        [입금 안내]
    │           ↓
    │        [입금 완료 클릭]
    │           ↓
    │        [관리자 확인 대기]
    │           ↓
    │        [관리자 승인]
    │           ↓
    │        [설치비 납부 완료]
    │
    └─ 완료 → 진행 중인 프로젝트 확인
               ├─ 있음 → [완료 유도 모달]
               │           ↓
               │        [완료하기] 클릭
               │           ↓
               │        [프로젝트 완료 처리]
               │
               └─ 없음 → [프로젝트 등록 페이지]
                           ↓
                        [프로젝트 정보 입력]
                        - 프로젝트명
                        - 설명
                        - 웹사이트 유형
                        - 목표 완료일
                           ↓
                        [프로젝트 등록하기]
                           ↓
                        [DB 레코드 생성]
                           ↓
                        [성공 팝업]
                           ↓
                        [PROJECT SAL Grid 화면 진입]
```

---

## 5. 데이터 플로우

### 프로젝트 등록 시 생성되는 데이터

**projects 테이블:**
```json
{
  "id": "uuid",
  "user_id": "user_uuid",
  "project_name": "블로그 프로젝트",
  "description": "개인 블로그 사이트...",
  "website_type": "blog",
  "status": "in_progress",
  "progress": 0,
  "current_stage": 0,
  "total_stages": 5,
  "target_completion_date": "2026-03-01",
  "created_at": "2025-12-01T10:00:00Z",
  "completed_at": null
}
```

---

## 6. 성공 기준

### 6-1. 기능적 성공
- ✅ 설치비 미납 시 안내 페이지로 이동
- ✅ 입금 확인 후 계정 활성화
- ✅ 진행 중인 프로젝트 있으면 완료 유도
- ✅ 프로젝트 등록 완료
- ✅ PROJECT SAL Grid 화면 진입

### 6-2. UX 성공
- ✅ 설치비 필요성이 명확히 안내됨
- ✅ 입금 절차가 간단함
- ✅ 동시 1개 제약이 명확히 안내됨
- ✅ 프로젝트 등록이 직관적임

### 6-3. 비즈니스 성공
- ✅ 설치비 납부 완료
- ✅ 사용자가 프로젝트 시작
- ✅ 플랫폼 사용 본격 시작

---

## 7. 구현 시 고려사항

### 7-1. 보안
- 입금 확인은 관리자 수동 승인 (자동화 X)
- 실명 확인 필수
- 금액 정확히 일치해야 함

### 7-2. 성능
- 프로젝트 등록 응답 시간: < 1초
- 입금 확인 알림: 실시간 (Supabase Realtime)

### 7-3. 데이터 무결성
- 동시 1개 프로젝트 제약 (DB constraint)
- 설치비 납부 전 프로젝트 등록 차단
- 중복 프로젝트명 방지

---

**문서 작성:** Claude Code
**승인:** 2025-12-01
