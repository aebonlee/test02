<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSAL Works Admin - ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <!-- DOMPurify for XSS Protection -->
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.6/dist/purify.min.js"></script>
    <!-- Supabase JS Client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Main Theme - Purple (Header, Main Elements) */
            --primary: #6B5CCC;
            --primary-dark: #5847B3;

            /* Secondary Theme - Orange (Buttons, Actions) */
            --secondary: #CC785C;
            --secondary-dark: #B35A44;

            /* Status Colors */
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --info: #0099ff;
            --neutral: #6c757d;

            /* Background */
            --bg-light: #f8f9fa;
            --bg-white: #ffffff;
            --border-color: #dee2e6;

            /* Misc */
            --border-radius: 8px;
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.12);
            --shadow-md: 0 4px 6px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 20px rgba(0,0,0,0.15);
        }

        body {
            font-family: 'Noto Sans KR', 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            font-size: 14px;
            line-height: 1.6;
            color: #212529;
            background: var(--bg-light);
            padding: 0 20px;
        }

        /* ========== Layout Grid ========== */
        .layout-container {
            display: grid;
            grid-template-columns: 180px 1fr;
            grid-template-rows: 70px 1fr 60px;
            min-height: 100vh;
            gap: 0;
            max-width: 1800px;
            margin: 0 auto;
            box-shadow: 0 0 40px rgba(0,0,0,0.15);
        }

        /* ========== Header ========== */
        .header {
            grid-column: 1 / 3;
            grid-row: 1;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 32px;
            box-shadow: var(--shadow-md);
            z-index: 100;
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .rice-logo {
            display: flex;
            align-items: center;
            gap: 3px;
            transform: rotate(-15deg);
        }

        .rice-grain {
            width: 7px;
            height: 12px;
            background: linear-gradient(135deg, #ffffff 0%, #f5f5f5 100%);
            border-radius: 40%;
            box-shadow: 0 1px 2px rgba(0,0,0,0.2);
            display: inline-block;
        }

        .header-title {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .header-title-main {
            font-size: 22px;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .header-title-sub {
            font-size: 11px;
            opacity: 0.85;
            font-weight: 400;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .admin-badge {
            background: var(--secondary);
            color: white;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        .logout-btn {
            padding: 8px 16px;
            background: rgba(255,255,255,0.15);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.2s;
        }

        .logout-btn:hover {
            background: rgba(255,255,255,0.25);
        }

        /* ========== Left Sidebar ========== */
        .sidebar {
            grid-column: 1;
            grid-row: 2;
            background: white;
            border-right: 2px solid var(--border-color);
            overflow-y: auto;
            padding: 20px 0;
        }

        .menu-section {
            margin-bottom: 24px;
        }

        .menu-section-title {
            font-size: 11px;
            font-weight: 700;
            color: #868e96;
            padding: 0 16px;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .menu-item {
            padding: 10px 16px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #495057;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 13px;
            font-weight: 500;
            border-left: 3px solid transparent;
        }

        .menu-item:hover {
            background: #f8f9fa;
            color: var(--primary);
        }

        .menu-item.active {
            background: linear-gradient(90deg, rgba(107,92,204,0.1) 0%, transparent 100%);
            color: var(--primary);
            border-left-color: var(--primary);
            font-weight: 600;
        }

        .menu-badge {
            margin-left: auto;
            background: var(--danger);
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 600;
        }

        /* ========== Main Content ========== */
        .main-content {
            grid-column: 2;
            grid-row: 2;
            background: var(--bg-light);
            overflow-y: auto;
            padding: 32px;
        }

        .content-header {
            margin-bottom: 24px;
        }

        .content-title {
            font-size: 26px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 8px;
        }

        .content-subtitle {
            font-size: 14px;
            color: #6c757d;
        }

        /* ========== Stats Cards ========== */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }

        .stat-card {
            background: white;
            padding: 24px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-sm);
            border-left: 4px solid;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-md);
        }

        .stat-card.primary { border-left-color: var(--primary); }
        .stat-card.success { border-left-color: var(--success); }
        .stat-card.warning { border-left-color: var(--warning); }
        .stat-card.danger { border-left-color: var(--danger); }

        .stat-icon {
            font-size: 28px;
            margin-bottom: 12px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 13px;
            color: #6c757d;
            font-weight: 500;
        }

        /* ========== Content Sections ========== */
        .content-section {
            background: white;
            padding: 24px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-sm);
            margin-bottom: 24px;
        }

        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--border-color);
        }

        .section-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--primary);
        }

        .section-action {
            padding: 6px 14px;
            background: var(--secondary);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.2s;
        }

        .section-action:hover {
            background: var(--secondary-dark);
        }

        /* ========== Table ========== */
        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table thead {
            background: #f8f9fa;
        }

        .data-table th {
            padding: 12px;
            text-align: left;
            font-size: 12px;
            font-weight: 600;
            color: #495057;
            border-bottom: 2px solid var(--border-color);
        }

        .data-table td {
            padding: 12px;
            font-size: 13px;
            border-bottom: 1px solid #e9ecef;
        }

        .data-table tr:hover {
            background: #f8f9fa;
        }

        .status-badge {
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            display: inline-block;
        }

        .status-badge.pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-badge.answered {
            background: #d4edda;
            color: #155724;
        }

        .status-badge.active {
            background: #d1ecf1;
            color: #0c5460;
        }

        .action-link {
            color: var(--primary);
            text-decoration: none;
            font-weight: 500;
            font-size: 12px;
        }

        .action-link:hover {
            text-decoration: underline;
        }

        /* ========== Footer ========== */
        .footer {
            grid-column: 1 / 3;
            grid-row: 3;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 12px 32px;
            font-size: 12px;
            gap: 8px;
            position: relative;
        }

        .footer-links {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .footer-link {
            color: rgba(255, 255, 255, 0.95);
            text-decoration: none;
            transition: color 0.2s;
            font-size: 13px;
            font-weight: 500;
        }

        .footer-link:hover {
            color: white;
        }

        .footer-copyright {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 10px;
            opacity: 0.7;
        }

        .home-link {
            position: absolute;
            right: 32px;
            bottom: 12px;
            opacity: 0.15;
            font-size: 9px;
            transition: opacity 0.3s;
            color: rgba(255, 255, 255, 0.95);
            text-decoration: none;
        }

        .home-link:hover {
            opacity: 0.6;
        }

        /* ========== Form Styles ========== */
        .form-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .form-modal {
            background: white;
            border-radius: var(--border-radius);
            padding: 32px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: var(--shadow-lg);
        }

        .form-header {
            font-size: 20px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 24px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--border-color);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 13px;
            font-weight: 600;
            color: #495057;
            margin-bottom: 8px;
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 14px;
            font-family: inherit;
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--primary);
        }

        .form-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 24px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }

        .form-btn {
            padding: 10px 20px;
            border: none;
            border-radius: var(--border-radius);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .form-btn-primary {
            background: var(--primary);
            color: white;
        }

        .form-btn-primary:hover {
            background: var(--primary-dark);
        }

        .form-btn-secondary {
            background: var(--neutral);
            color: white;
        }

        .form-btn-secondary:hover {
            background: #5a6268;
        }

        /* ========== Filter Buttons (FAQ Category) ========== */
        .filter-btn {
            padding: 10px 20px;
            border: 2px solid var(--border-color);
            background: white;
            color: #495057;
            border-radius: var(--border-radius);
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .filter-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
            background: #f8f9fa;
        }

        .filter-btn.active {
            border-color: var(--primary);
            background: var(--primary);
            color: white;
        }

        /* ========== Responsive Design (Mobile) ========== */
        @media (max-width: 768px) {
            body {
                padding: 0;
            }

            .layout-container {
                grid-template-columns: 1fr;
                grid-template-rows: 70px auto auto 60px;
                box-shadow: none;
            }

            .sidebar {
                grid-column: 1;
                grid-row: 2;
                border-right: none;
                border-bottom: 2px solid var(--border-color);
                display: flex;
                overflow-x: auto;
                padding: 10px 0;
            }

            .menu-section {
                display: flex;
                flex-direction: row;
                gap: 8px;
                margin-bottom: 0;
                margin-right: 16px;
            }

            .menu-section-title {
                display: none;
            }

            .menu-item {
                white-space: nowrap;
                padding: 8px 12px;
                font-size: 12px;
            }

            .main-content {
                grid-column: 1;
                grid-row: 3;
                padding: 16px;
            }

            .header {
                grid-column: 1;
                padding: 0 16px;
            }

            .header-title-main {
                font-size: 18px;
            }

            .header-title-sub {
                font-size: 10px;
            }

            .admin-badge {
                display: none;
            }

            .user-info span {
                display: none;
            }

            .footer {
                grid-column: 1;
                padding: 8px 16px;
            }

            .footer-links {
                flex-direction: column;
                gap: 8px;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .form-modal {
                width: 95%;
                padding: 20px;
            }

            .data-table {
                font-size: 12px;
            }

            .data-table th,
            .data-table td {
                padding: 8px 6px;
            }
        }

        /* ========== Toast Notification ========== */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 16px 24px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            transform: translateX(400px);
            transition: transform 0.3s ease-out;
            z-index: 9999;
            min-width: 280px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 14px;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast-success {
            border-left: 4px solid var(--success);
        }

        .toast-error {
            border-left: 4px solid var(--danger);
        }

        .toast-warning {
            border-left: 4px solid var(--warning);
        }

        .toast-info {
            border-left: 4px solid var(--info);
        }

        .toast-icon {
            font-size: 20px;
        }

        .toast-message {
            flex: 1;
            font-weight: 500;
        }

        /* ========== Loading Spinner ========== */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .loading-overlay.show {
            display: flex;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255,255,255,0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-text {
            color: white;
            margin-top: 16px;
            font-size: 14px;
            font-weight: 500;
        }

        /* ========== Screen Reader Only ========== */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        /* ========== Learning Content Tree ========== */
        .learning-tree {
            font-size: 14px;
        }

        .tree-depth1 {
            margin-bottom: 8px;
        }

        .tree-depth2 {
            margin-left: 24px;
            margin-top: 4px;
        }

        .tree-depth3 {
            margin-left: 24px;
            margin-top: 2px;
        }

        .tree-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .tree-item:hover {
            background: #f8f9fa;
        }

        .depth1-item {
            background: #f0f0ff;
            border-left: 4px solid var(--primary);
            font-weight: 600;
        }

        .depth1-item:hover {
            background: #e8e8ff;
        }

        .depth2-item {
            background: #f8f9fa;
            border-left: 3px solid var(--success);
            font-weight: 500;
        }

        .depth2-item:hover {
            background: #e9ecef;
        }

        .depth3-item {
            background: white;
            border: 1px solid #e9ecef;
            font-weight: 400;
        }

        .depth3-item:hover {
            background: #f8f9fa;
            border-color: var(--primary);
        }

        .tree-arrow {
            font-size: 10px;
            color: #6c757d;
            transition: transform 0.2s;
            width: 12px;
        }

        .tree-arrow.open {
            transform: rotate(90deg);
        }

        .tree-icon {
            font-size: 16px;
        }

        .tree-name {
            flex: 1;
        }

        .tree-link-status {
            font-size: 11px;
            padding: 2px 8px;
            border-radius: 10px;
            margin-right: 8px;
        }

        .tree-link-status.linked {
            background: #d4edda;
            color: #155724;
        }

        .tree-link-status.not-linked {
            background: #fff3cd;
            color: #856404;
        }

        .tree-actions {
            display: flex;
            gap: 4px;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .tree-item:hover .tree-actions {
            opacity: 1;
        }

        .tree-btn {
            padding: 4px 8px;
            font-size: 11px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
        }

        .tree-btn.edit {
            background: #e3f2fd;
            color: #1976d2;
        }

        .tree-btn.edit:hover {
            background: #1976d2;
            color: white;
        }

        .tree-btn.add {
            background: #e8f5e9;
            color: #388e3c;
        }

        .tree-btn.add:hover {
            background: #388e3c;
            color: white;
        }

        .tree-btn.delete {
            background: #ffebee;
            color: #d32f2f;
        }

        .tree-btn.delete:hover {
            background: #d32f2f;
            color: white;
        }

        .tree-btn.link {
            background: #fff3e0;
            color: #f57c00;
        }

        .tree-btn.link:hover {
            background: #f57c00;
            color: white;
        }

        .tree-btn.move {
            background: #f5f5f5;
            color: #616161;
        }

        .tree-btn.move:hover {
            background: #616161;
            color: white;
        }

        .tree-children {
            overflow: hidden;
        }

        /* ========== Admin Home Dashboard Enhancements ========== */

        /* Enhanced Stat Cards with Change Indicators */
        .stat-card-enhanced {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .stat-header {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            font-weight: 600;
            color: #495057;
        }

        .stat-header .stat-icon {
            font-size: 20px;
        }

        .stat-change {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 12px;
            font-weight: 600;
        }

        .stat-change.up {
            color: var(--success);
        }

        .stat-change.down {
            color: var(--danger);
        }

        .change-arrow {
            font-size: 14px;
            font-weight: 700;
        }

        .change-value {
            font-weight: 700;
        }

        .change-period {
            color: #6c757d;
            font-weight: 500;
        }

        .stat-urgent {
            margin-top: 4px;
        }

        .urgent-badge {
            display: inline-block;
            background: rgba(220, 53, 69, 0.1);
            color: var(--danger);
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 700;
            border: 1px solid rgba(220, 53, 69, 0.3);
        }

        /* Dual Section Grid (Activity + Urgent Tasks) */
        .dual-section-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 24px;
        }

        /* Activity Timeline */
        .activity-timeline {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .activity-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 14px;
            background: white;
            border-radius: var(--border-radius);
            border-left: 3px solid #e9ecef;
            transition: all 0.2s;
        }

        .activity-item:hover {
            background: #f8f9fa;
            box-shadow: var(--shadow-sm);
            transform: translateX(2px);
        }

        .activity-item.urgent {
            border-left-color: var(--danger);
            background: rgba(220, 53, 69, 0.03);
        }

        .activity-item.warning {
            border-left-color: var(--warning);
        }

        .activity-item.normal {
            border-left-color: var(--success);
        }

        .activity-icon {
            font-size: 18px;
            line-height: 1;
        }

        .activity-content {
            flex: 1;
        }

        .activity-message {
            font-size: 14px;
            font-weight: 500;
            color: #212529;
            margin-bottom: 4px;
        }

        .activity-time {
            font-size: 12px;
            color: #6c757d;
        }

        /* Urgent Tasks List */
        .urgent-tasks-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .urgent-task {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px;
            background: white;
            border-radius: var(--border-radius);
            border: 1px solid #e9ecef;
            cursor: pointer;
            transition: all 0.2s;
        }

        .urgent-task:hover {
            background: #f8f9fa;
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
            border-color: var(--primary);
        }

        .urgent-task.high {
            border-left: 4px solid var(--danger);
            background: rgba(220, 53, 69, 0.03);
        }

        .urgent-task.medium {
            border-left: 4px solid var(--warning);
        }

        .urgent-task-icon {
            font-size: 20px;
        }

        .urgent-task-content {
            flex: 1;
        }

        .urgent-task-title {
            font-size: 14px;
            font-weight: 600;
            color: #212529;
            margin-bottom: 4px;
        }

        .urgent-task-count {
            font-size: 12px;
            color: #6c757d;
        }

        .urgent-task-arrow {
            font-size: 18px;
            color: #adb5bd;
            transition: all 0.2s;
        }

        .urgent-task:hover .urgent-task-arrow {
            color: var(--primary);
            transform: translateX(4px);
        }

        /* Charts Grid */
        .charts-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 24px;
        }

        .chart-container {
            min-height: 350px;
        }

        .chart-container canvas {
            max-height: 300px;
        }

        .section-subtitle {
            font-size: 12px;
            color: #6c757d;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <!-- ê³µì§€ì‚¬í•­ ì‘ì„±/ìˆ˜ì • ëª¨ë‹¬ -->
    <div id="noticeModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9999; align-items: center; justify-content: center;">
        <div style="background: white; border-radius: 12px; width: 600px; max-width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
            <div style="padding: 24px; border-bottom: 1px solid var(--border-color);">
                <h2 style="margin: 0; color: var(--primary);" id="noticeModalTitle">ğŸ“ ê³µì§€ì‚¬í•­ ì‘ì„±</h2>
            </div>
            <div style="padding: 24px;">
                <form id="noticeForm" onsubmit="handleNoticeSubmit(event)">
                    <!-- ì¤‘ìš”ë„ ì„ íƒ -->
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; font-size: 14px;">ì¤‘ìš”ë„</label>
                        <div style="display: flex; gap: 12px;">
                            <label style="flex: 1; cursor: pointer;">
                                <input type="radio" name="importance" value="important" style="margin-right: 6px;">
                                <span style="color: #dc3545; font-weight: 600;">ğŸ”´ ì¤‘ìš”</span>
                            </label>
                            <label style="flex: 1; cursor: pointer;">
                                <input type="radio" name="importance" value="normal" checked style="margin-right: 6px;">
                                <span style="color: #6c757d;">ì¼ë°˜</span>
                            </label>
                        </div>
                    </div>

                    <!-- ì œëª© -->
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; font-size: 14px;">ì œëª© *</label>
                        <input type="text" id="noticeTitle" required
                               style="width: 100%; padding: 12px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 14px;"
                               placeholder="ê³µì§€ì‚¬í•­ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>

                    <!-- ë‚´ìš© -->
                    <div style="margin-bottom: 24px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; font-size: 14px;">ë‚´ìš© *</label>
                        <textarea id="noticeContent" required rows="8"
                                  style="width: 100%; padding: 12px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 14px; resize: vertical; font-family: inherit;"
                                  placeholder="ê³µì§€ì‚¬í•­ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                    </div>

                    <!-- ë²„íŠ¼ -->
                    <div style="display: flex; gap: 12px; justify-content: flex-end;">
                        <button type="button" onclick="closeNoticeModal()"
                                style="padding: 12px 24px; background: var(--neutral); color: white; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer;">
                            ì·¨ì†Œ
                        </button>
                        <button type="submit"
                                style="padding: 12px 24px; background: var(--primary); color: white; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer;">
                            ì €ì¥
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="layout-container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <div class="rice-logo">
                    <span class="rice-grain"></span>
                    <span class="rice-grain"></span>
                    <span class="rice-grain"></span>
                </div>
                <div class="header-title">
                    <div class="header-title-main">SSAL Works Admin</div>
                    <div class="header-title-sub">ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ</div>
                </div>
            </div>
            <div class="header-right">
                <div class="admin-badge">ğŸ‘¨â€ğŸ’¼ ê´€ë¦¬ì</div>
                <div class="user-info">
                    <div class="user-avatar">ì¨ë‹ˆ</div>
                    <span style="font-size: 14px; font-weight: 500;">ì¨ë‹ˆë‹˜</span>
                </div>
                <button class="logout-btn" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
            </div>
        </header>

        <!-- Left Sidebar -->
        <aside class="sidebar">
            <div class="menu-section">
                <div class="menu-section-title">ë©”ì¸</div>
                <div class="menu-item active" onclick="showSection('overview', event)">
                    ğŸ“Š ëŒ€ì‹œë³´ë“œ ê°œìš”
                </div>
            </div>

            <div class="menu-section">
                <div class="menu-section-title">ì»¨í…ì¸  ê´€ë¦¬</div>
                <div class="menu-item" onclick="showSection('notice', event)">
                    ğŸ“¢ ê³µì§€ì‚¬í•­ ê´€ë¦¬
                </div>
                <div class="menu-item" onclick="showSection('manual', event)">
                    ğŸ“– ë§¤ë‰´ì–¼ ê´€ë¦¬
                </div>
                <div class="menu-item" onclick="showSection('faq', event)">
                    ğŸ™‹ FAQ & Tip ê´€ë¦¬
                </div>
                <div class="menu-item" onclick="showSection('ordersheet', event)">
                    ğŸ“ Order Sheet í…œí”Œë¦¿
                </div>
                <div class="menu-item" onclick="showSection('guide', event)">
                    ğŸ“– ì•ˆë‚´ë¬¸ ê´€ë¦¬
                </div>
            </div>

            <div class="menu-section">
                <div class="menu-section-title">íšŒì›/ê²°ì œ</div>
                <div class="menu-item" onclick="showSection('users', event)">
                    ğŸ‘¥ íšŒì› ê´€ë¦¬
                </div>
                <div class="menu-item" onclick="showSection('installation', event)">
                    ğŸ  ì„¤ì¹˜ë¹„ ê´€ë¦¬
                    <span class="menu-badge" id="installationPendingBadge" style="display:none;">0</span>
                </div>
                <div class="menu-item" onclick="showSection('projects', event)">
                    ğŸ“ í”„ë¡œì íŠ¸ ê´€ë¦¬
                </div>
                <div class="menu-item" onclick="showSection('subscription', event)">
                    ğŸ”„ êµ¬ë… ê´€ë¦¬
                </div>
                <div class="menu-item" onclick="showSection('payment', event)">
                    ğŸ’³ ê²°ì œ ê´€ë¦¬
                </div>
                <div class="menu-item" onclick="showSection('credit', event)">
                    ğŸª™ í¬ë ˆë”§ ê´€ë¦¬
                </div>
                <div class="menu-item" onclick="showSection('inquiries', event)">
                    ğŸ’¬ ë¬¸ì˜ ê´€ë¦¬
                    <span class="menu-badge">5</span>
                </div>
            </div>

            <div class="menu-section">
                <div class="menu-section-title">í†µê³„</div>
                <div class="menu-item" onclick="showSection('stats', event)">
                    ğŸ“ˆ í†µê³„ ë° ë¶„ì„
                </div>
                <div class="menu-item" onclick="showSection('api', event)">
                    ğŸ”Œ API ì‚¬ìš©ëŸ‰
                </div>
            </div>

            <div class="menu-section">
                <div class="menu-section-title">ì‹œìŠ¤í…œ</div>
                <div class="menu-item" onclick="showSection('settings', event)">
                    âš™ï¸ ì„¤ì •
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Overview Section -->
            <div id="overview-section" class="content-view">
                <div class="content-header">
                    <h1 class="content-title">ğŸ  ëŒ€ì‹œë³´ë“œ í™ˆ</h1>
                    <p class="content-subtitle">ì•ˆë…•í•˜ì„¸ìš”, ì¨ë‹ˆë‹˜! ğŸ‘‹ ì˜¤ëŠ˜ì˜ ì „ì²´ í˜„í™©ì„ í™•ì¸í•˜ì„¸ìš”.</p>
                </div>

                <!-- Stats Grid with Change Indicators -->
                <div class="stats-grid">
                    <div class="stat-card stat-card-enhanced primary">
                        <div class="stat-header">
                            <span class="stat-icon">ğŸ‘¥</span>
                            <span class="stat-label">ì´ íšŒì› ìˆ˜</span>
                        </div>
                        <div class="stat-value">1,234</div>
                        <div class="stat-change up">
                            <span class="change-arrow">â†‘</span>
                            <span class="change-value">+15</span>
                            <span class="change-period">ì–´ì œ ëŒ€ë¹„</span>
                        </div>
                    </div>
                    <div class="stat-card stat-card-enhanced success">
                        <div class="stat-header">
                            <span class="stat-icon">ğŸ’°</span>
                            <span class="stat-label">ì´ë²ˆ ë‹¬ ë§¤ì¶œ</span>
                        </div>
                        <div class="stat-value">â‚©5,200,000</div>
                        <div class="stat-change up">
                            <span class="change-arrow">â†‘</span>
                            <span class="change-value">+8%</span>
                            <span class="change-period">ì „ì›” ëŒ€ë¹„</span>
                        </div>
                    </div>
                    <div class="stat-card stat-card-enhanced warning">
                        <div class="stat-header">
                            <span class="stat-icon">ğŸª™</span>
                            <span class="stat-label">í¬ë ˆë”§ íŒë§¤</span>
                        </div>
                        <div class="stat-value">830,000 C</div>
                        <div class="stat-change down">
                            <span class="change-arrow">â†“</span>
                            <span class="change-value">-5%</span>
                            <span class="change-period">ì „ì›” ëŒ€ë¹„</span>
                        </div>
                    </div>
                    <div class="stat-card stat-card-enhanced danger">
                        <div class="stat-header">
                            <span class="stat-icon">ğŸ“</span>
                            <span class="stat-label">ë¯¸ì²˜ë¦¬ ë¬¸ì˜</span>
                        </div>
                        <div class="stat-value">12</div>
                        <div class="stat-urgent">
                            <span class="urgent-badge">âš ï¸ ê¸´ê¸‰ 3ê±´</span>
                        </div>
                    </div>
                </div>

                <!-- Activity and Urgent Tasks Row -->
                <div class="dual-section-grid">
                    <!-- Recent Activity Timeline -->
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">ğŸ“‹ ìµœê·¼ í™œë™</h2>
                            <span class="section-subtitle">ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸</span>
                        </div>
                        <div class="activity-timeline" id="activityTimeline">
                            <div class="activity-item urgent">
                                <span class="activity-icon">ğŸ”´</span>
                                <div class="activity-content">
                                    <div class="activity-message">ê¸´ê¸‰ ë¬¸ì˜: ê²°ì œ ì˜¤ë¥˜</div>
                                    <div class="activity-time">3ë¶„ ì „</div>
                                </div>
                            </div>
                            <div class="activity-item normal">
                                <span class="activity-icon">ğŸŸ¢</span>
                                <div class="activity-content">
                                    <div class="activity-message">ì‹ ê·œ ê°€ì…: í™ê¸¸ë™</div>
                                    <div class="activity-time">12ë¶„ ì „</div>
                                </div>
                            </div>
                            <div class="activity-item warning">
                                <span class="activity-icon">ğŸŸ¡</span>
                                <div class="activity-content">
                                    <div class="activity-message">í¬ë ˆë”§ í™˜ë¶ˆ ìš”ì²­</div>
                                    <div class="activity-time">25ë¶„ ì „</div>
                                </div>
                            </div>
                            <div class="activity-item normal">
                                <span class="activity-icon">ğŸŸ¢</span>
                                <div class="activity-content">
                                    <div class="activity-message">êµ¬ë… ê°±ì‹  ì™„ë£Œ</div>
                                    <div class="activity-time">1ì‹œê°„ ì „</div>
                                </div>
                            </div>
                            <div class="activity-item normal">
                                <span class="activity-icon">ğŸŸ¢</span>
                                <div class="activity-content">
                                    <div class="activity-message">ì‹ ê·œ ê°€ì…: ê¹€ì² ìˆ˜</div>
                                    <div class="activity-time">2ì‹œê°„ ì „</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Urgent Tasks -->
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">âš ï¸ ê¸´ê¸‰ ì²˜ë¦¬ í•„ìš”</h2>
                            <span class="section-subtitle">ìš°ì„ ìˆœìœ„ ìˆœ</span>
                        </div>
                        <div class="urgent-tasks-list" id="urgentTasksList">
                            <div class="urgent-task high" onclick="showSection('subscription', event)">
                                <span class="urgent-task-icon">ğŸ”´</span>
                                <div class="urgent-task-content">
                                    <div class="urgent-task-title">ë¯¸ë‚© íšŒì› 3ëª… (êµ¬ë… ì •ì§€ ì˜ˆì •)</div>
                                    <div class="urgent-task-count">3ê±´</div>
                                </div>
                                <span class="urgent-task-arrow">â†’</span>
                            </div>
                            <div class="urgent-task high" onclick="showSection('credit', event)">
                                <span class="urgent-task-icon">ğŸ”´</span>
                                <div class="urgent-task-content">
                                    <div class="urgent-task-title">í¬ë ˆë”§ í™˜ë¶ˆ ìš”ì²­</div>
                                    <div class="urgent-task-count">5ê±´</div>
                                </div>
                                <span class="urgent-task-arrow">â†’</span>
                            </div>
                            <div class="urgent-task medium" onclick="showSection('credit', event)">
                                <span class="urgent-task-icon">ğŸŸ¡</span>
                                <div class="urgent-task-content">
                                    <div class="urgent-task-title">ì”ì•¡ ë¶€ì¡± íšŒì›</div>
                                    <div class="urgent-task-count">12ëª…</div>
                                </div>
                                <span class="urgent-task-arrow">â†’</span>
                            </div>
                            <div class="urgent-task medium" onclick="showSection('inquiries', event)">
                                <span class="urgent-task-icon">ğŸŸ¡</span>
                                <div class="urgent-task-content">
                                    <div class="urgent-task-title">ì‹ ê·œ ë¬¸ì˜ (ë¯¸ë‹µë³€)</div>
                                    <div class="urgent-task-count">8ê±´</div>
                                </div>
                                <span class="urgent-task-arrow">â†’</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Charts Section -->
                <div class="charts-grid">
                    <div class="content-section chart-container">
                        <div class="section-header">
                            <h2 class="section-title">ğŸ“ˆ íšŒì› ê°€ì… ì¶”ì´</h2>
                            <span class="section-subtitle">ìµœê·¼ 7ì¼</span>
                        </div>
                        <canvas id="memberSignupChart" style="height: 300px;"></canvas>
                    </div>
                    <div class="content-section chart-container">
                        <div class="section-header">
                            <h2 class="section-title">ğŸ’° ë§¤ì¶œ ì¶”ì´</h2>
                            <span class="section-subtitle">ìµœê·¼ 4ì£¼</span>
                        </div>
                        <canvas id="revenueChart" style="height: 300px;"></canvas>
                    </div>
                </div>

                <!-- Recent Inquiries -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">ğŸ“‹ ìµœê·¼ ë¬¸ì˜ (ì‹¤ì‹œê°„)</h2>
                        <button class="section-action" onclick="showSection('inquiries', event)">ì „ì²´ ë³´ê¸°</button>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ì‚¬ìš©ì</th>
                                <th>ì œëª©</th>
                                <th>ìƒíƒœ</th>
                                <th>ì‹œê°„</th>
                                <th>ì‘ì—…</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>user@example.com</td>
                                <td>íšŒì›ê°€ì… ì˜¤ë¥˜</td>
                                <td><span class="status-badge pending">ë¯¸ë‹µë³€</span></td>
                                <td>2ë¶„ ì „</td>
                                <td><a href="#" class="action-link">ë‹µë³€í•˜ê¸°</a></td>
                            </tr>
                            <tr>
                                <td>test@test.com</td>
                                <td>API ì—°ë™ ë¬¸ì˜</td>
                                <td><span class="status-badge pending">ë¯¸ë‹µë³€</span></td>
                                <td>15ë¶„ ì „</td>
                                <td><a href="#" class="action-link">ë‹µë³€í•˜ê¸°</a></td>
                            </tr>
                            <tr>
                                <td>admin@ssal.com</td>
                                <td>ê²°ì œ ë¬¸ì˜</td>
                                <td><span class="status-badge answered">ë‹µë³€ì™„ë£Œ</span></td>
                                <td>1ì‹œê°„ ì „</td>
                                <td><a href="#" class="action-link">ë³´ê¸°</a></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Recent Users -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">ğŸ‘¥ ìµœê·¼ ê°€ì… ì‚¬ìš©ì</h2>
                        <button class="section-action" onclick="showSection('users', event)">ì „ì²´ ë³´ê¸°</button>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ì´ë©”ì¼</th>
                                <th>ì´ë¦„</th>
                                <th>ìƒíƒœ</th>
                                <th>ê°€ì…ì¼</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>user@example.com</td>
                                <td>í™ê¸¸ë™</td>
                                <td><span class="status-badge active">í™œì„±</span></td>
                                <td>2025-11-17</td>
                            </tr>
                            <tr>
                                <td>test@test.com</td>
                                <td>ê¹€ì² ìˆ˜</td>
                                <td><span class="status-badge active">í™œì„±</span></td>
                                <td>2025-11-16</td>
                            </tr>
                            <tr>
                                <td>admin@ssal.com</td>
                                <td>ë°•ì˜í¬</td>
                                <td><span class="status-badge active">í™œì„±</span></td>
                                <td>2025-11-15</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Notice Section -->
            <div id="notice-section" class="content-view" style="display:none;">
                <div class="content-header">
                    <h1 class="content-title">ğŸ“¢ ê³µì§€ì‚¬í•­ ê´€ë¦¬</h1>
                    <p class="content-subtitle">ì‚¬ìš©ìì—ê²Œ í‘œì‹œë  ê³µì§€ì‚¬í•­ì„ ê´€ë¦¬í•˜ì„¸ìš”.</p>
                </div>

                <!-- ê³µì§€ì‚¬í•­ í†µê³„ -->
                <div class="stats-grid">
                    <div class="stat-card primary">
                        <div class="stat-value" id="noticeCountTotal">0</div>
                        <div class="stat-label">ì „ì²´ ê³µì§€</div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-value" id="noticeCountPublished">0</div>
                        <div class="stat-label">ê²Œì‹œ ì¤‘</div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-value" id="noticeCountImportant">0</div>
                        <div class="stat-label">ì¤‘ìš” ê³µì§€</div>
                    </div>
                </div>

                <!-- ê³µì§€ì‚¬í•­ ëª©ë¡ -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">ğŸ“‹ ê³µì§€ì‚¬í•­ ëª©ë¡</h2>
                        <button class="section-action" onclick="showNoticeForm()">+ ìƒˆ ê³µì§€ ì¶”ê°€</button>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ì¤‘ìš”ë„</th>
                                <th>ì œëª©</th>
                                <th>ê²Œì‹œì¼</th>
                                <th>ìƒíƒœ</th>
                                <th>ì¡°íšŒìˆ˜</th>
                                <th>ì‘ì—…</th>
                            </tr>
                        </thead>
                        <tbody id="noticesTableBody">
                            <!-- Supabaseì—ì„œ ë™ì ìœ¼ë¡œ ë¡œë“œë¨ -->
                            <tr>
                                <td colspan="6" style="text-align:center; padding: 40px; color: #999;">
                                    ê³µì§€ì‚¬í•­ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>


            <!-- Manual Section -->
            <div id="manual-section" class="content-view" style="display:none;">
                <div class="content-header">
                    <h1 class="content-title">ğŸ“– ë§¤ë‰´ì–¼ ê´€ë¦¬</h1>
                    <p class="content-subtitle">í”Œë«í¼ ì‚¬ìš© ë§¤ë‰´ì–¼ì˜ ë©”íƒ€ë°ì´í„°ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤. (GitHub Actionsë¡œ HTML ìë™ ë³€í™˜)</p>
                </div>

                <!-- ìë™í™” ì•ˆë‚´ -->
                <div style="background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); border-radius: 12px; padding: 16px 20px; margin-bottom: 24px; border-left: 4px solid #4caf50;">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <span style="font-size: 24px;">ğŸ”„</span>
                        <div>
                            <div style="font-weight: 600; color: #2e7d32; margin-bottom: 4px;">GitHub Actions ìë™í™” ì‹œìŠ¤í…œ</div>
                            <div style="font-size: 13px; color: #388e3c;">MD íŒŒì¼ ì‘ì„± (Project-SSAL-Grid/manual/) â†’ GitHub Push â†’ HTML ìë™ ë³€í™˜ â†’ ì´ í˜ì´ì§€ì—ì„œ DB ë©”íƒ€ë°ì´í„° ë“±ë¡</div>
                        </div>
                    </div>
                </div>

                <!-- ë§¤ë‰´ì–¼ í†µê³„ -->
                <div class="stats-grid">
                    <div class="stat-card primary">
                        <div class="stat-value" id="manualCategoryCount">0</div>
                        <div class="stat-label">ì¹´í…Œê³ ë¦¬ ìˆ˜</div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-value" id="manualTotalCount">0</div>
                        <div class="stat-label">ì „ì²´ ë§¤ë‰´ì–¼ ìˆ˜</div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-value" id="manualActiveCount">0</div>
                        <div class="stat-label">í™œì„± ë§¤ë‰´ì–¼ ìˆ˜</div>
                    </div>
                </div>

                <!-- ë§¤ë‰´ì–¼ ê´€ë¦¬ -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">ğŸ“‹ ë§¤ë‰´ì–¼ ëª©ë¡ ê´€ë¦¬</h2>
                        <div style="display: flex; gap: 8px;">
                            <button class="section-action" onclick="showAddManualForm()">+ ë§¤ë‰´ì–¼ ì¶”ê°€</button>
                            <button class="section-action" onclick="loadManuals()" style="background: #6c757d;">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>
                        </div>
                    </div>

                    <!-- ë§¤ë‰´ì–¼ ëª©ë¡ í…Œì´ë¸” -->
                    <div class="table-responsive">
                        <table class="data-table" id="manualTable">
                            <thead>
                                <tr>
                                    <th style="width: 80px;">ìˆœì„œ</th>
                                    <th style="width: 120px;">ì¹´í…Œê³ ë¦¬</th>
                                    <th style="width: 120px;">í•˜ìœ„ ì¹´í…Œê³ ë¦¬</th>
                                    <th>ì œëª©</th>
                                    <th style="width: 80px;">ìƒíƒœ</th>
                                    <th style="width: 120px;">ê´€ë¦¬</th>
                                </tr>
                            </thead>
                            <tbody id="manualTableBody">
                                <tr>
                                    <td colspan="6" style="text-align:center; padding: 40px; color: #999;">
                                        ë§¤ë‰´ì–¼ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- FAQ Section -->
            <div id="faq-section" class="content-view" style="display:none;">
                <div class="content-header">
                    <h1 class="content-title">ğŸ™‹ FAQ & Tip ê´€ë¦¬</h1>
                    <p class="content-subtitle">ìì£¼ ë¬»ëŠ” ì§ˆë¬¸ê³¼ ìœ ìš©í•œ íŒì„ ê´€ë¦¬í•˜ì„¸ìš”. (3ë‹¨ê³„ êµ¬ì¡°)</p>
                </div>

                <!-- FAQ í†µê³„ -->
                <div class="stats-grid">
                    <div class="stat-card primary">
                        <div class="stat-value" id="faqDepth1Count">3</div>
                        <div class="stat-label">ëŒ€ë¶„ë¥˜ (Depth 1)</div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-value" id="faqDepth2Count">15</div>
                        <div class="stat-label">ì¤‘ë¶„ë¥˜ (Depth 2)</div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-value" id="faqDepth3Count">75</div>
                        <div class="stat-label">ì†Œë¶„ë¥˜ (Depth 3)</div>
                    </div>
                </div>

                <!-- FAQ íŠ¸ë¦¬ ê´€ë¦¬ -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">ğŸ“‹ FAQ & Tip êµ¬ì¡° ê´€ë¦¬</h2>
                        <button class="section-action" onclick="showAddFaqDepth1Form()">+ ëŒ€ë¶„ë¥˜ ì¶”ê°€</button>
                    </div>

                    <!-- íŠ¸ë¦¬ êµ¬ì¡° (ë™ì ìœ¼ë¡œ ìƒì„±ë¨) -->
                    <div id="faqTree" class="learning-tree">
                        <div style="text-align: center; padding: 40px; color: #999;">
                            FAQ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                        </div>
                    </div>
                </div>
            </div>

            <!-- Order Sheet Template Section -->
            <div id="ordersheet-section" class="content-view" style="display:none;">
                <div class="content-header">
                    <h1 class="content-title">ğŸ“ Order Sheet í…œí”Œë¦¿ ê´€ë¦¬</h1>
                    <p class="content-subtitle">ê° ë‹¨ê³„ë³„ Order Sheet í…œí”Œë¦¿ì„ ê´€ë¦¬í•˜ì„¸ìš”.</p>
                </div>

                <!-- Order Sheet í†µê³„ -->
                <div class="stats-grid">
                    <div class="stat-card primary">
                        <div class="stat-value">8</div>
                        <div class="stat-label">ë‹¨ê³„ ê·¸ë£¹</div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-value">32</div>
                        <div class="stat-label">í…œí”Œë¦¿ ìˆ˜</div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-value">5</div>
                        <div class="stat-label">ë¯¸ì‘ì„±</div>
                    </div>
                </div>

                <!-- í…œí”Œë¦¿ ëª©ë¡ -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">ğŸ“‹ í…œí”Œë¦¿ ëª©ë¡</h2>
                        <button class="section-action" onclick="showOrderSheetForm()">+ ìƒˆ í…œí”Œë¦¿ ì¶”ê°€</button>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ë‹¨ê³„ ID</th>
                                <th>ë‹¨ê³„ëª…</th>
                                <th>í…œí”Œë¦¿ ìƒíƒœ</th>
                                <th>ìˆ˜ì •ì¼</th>
                                <th>ì‘ì—…</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>dir_structure</code></td>
                                <td>ì‘ì—… ë””ë ‰í† ë¦¬ êµ¬ì¡° ìƒì„±</td>
                                <td><span class="status-badge active">ì‘ì„±ì™„ë£Œ</span></td>
                                <td>2025-11-20</td>
                                <td>
                                    <a href="#" class="action-link" onclick="event.preventDefault(); editOrderSheet('dir_structure')">ìˆ˜ì •</a>
                                    <a href="#" class="action-link" style="color: #6c757d;">ë¯¸ë¦¬ë³´ê¸°</a>
                                </td>
                            </tr>
                            <tr>
                                <td><code>biz_0_1</code></td>
                                <td>ê¸°ì—… ë¹„ì „ ì„¤ì •</td>
                                <td><span class="status-badge active">ì‘ì„±ì™„ë£Œ</span></td>
                                <td>2025-11-18</td>
                                <td>
                                    <a href="#" class="action-link">ìˆ˜ì •</a>
                                    <a href="#" class="action-link" style="color: #6c757d;">ë¯¸ë¦¬ë³´ê¸°</a>
                                </td>
                            </tr>
                            <tr>
                                <td><code>biz_0_2</code></td>
                                <td>ë¹„ì¦ˆë‹ˆìŠ¤ ëª©í‘œ ë° ëª©ì  ìˆ˜ë¦½</td>
                                <td><span class="status-badge active">ì‘ì„±ì™„ë£Œ</span></td>
                                <td>2025-11-18</td>
                                <td>
                                    <a href="#" class="action-link">ìˆ˜ì •</a>
                                    <a href="#" class="action-link" style="color: #6c757d;">ë¯¸ë¦¬ë³´ê¸°</a>
                                </td>
                            </tr>
                            <tr>
                                <td><code>plan_1_1</code></td>
                                <td>í”„ë¡œì íŠ¸ ê°œìš” ì •ì˜</td>
                                <td><span class="status-badge pending">ë¯¸ì‘ì„±</span></td>
                                <td>-</td>
                                <td>
                                    <a href="#" class="action-link">ì‘ì„±</a>
                                </td>
                            </tr>
                            <tr>
                                <td><code>s1</code></td>
                                <td>í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ</td>
                                <td><span class="status-badge active">ì‘ì„±ì™„ë£Œ</span></td>
                                <td>2025-11-15</td>
                                <td>
                                    <a href="#" class="action-link">ìˆ˜ì •</a>
                                    <a href="#" class="action-link" style="color: #6c757d;">ë¯¸ë¦¬ë³´ê¸°</a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- ë‹¨ê³„ ê·¸ë£¹ë³„ ê´€ë¦¬ -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">ğŸ“ ë‹¨ê³„ ê·¸ë£¹ë³„ í˜„í™©</h2>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px;">
                        <div style="padding: 16px; background: #f8f9fa; border-radius: 8px; text-align: center;">
                            <div style="font-size: 24px; margin-bottom: 8px;">â˜†</div>
                            <div style="font-weight: 600; margin-bottom: 4px;">íŠ¹ë³„ë‹¨ê³„</div>
                            <div style="font-size: 12px; color: #6c757d;">1/1 ì™„ë£Œ</div>
                        </div>
                        <div style="padding: 16px; background: #f8f9fa; border-radius: 8px; text-align: center;">
                            <div style="font-size: 24px; margin-bottom: 8px;">0</div>
                            <div style="font-weight: 600; margin-bottom: 4px;">ì‚¬ì—…ê³„íš</div>
                            <div style="font-size: 12px; color: #6c757d;">3/3 ì™„ë£Œ</div>
                        </div>
                        <div style="padding: 16px; background: #f8f9fa; border-radius: 8px; text-align: center;">
                            <div style="font-size: 24px; margin-bottom: 8px;">1</div>
                            <div style="font-weight: 600; margin-bottom: 4px;">í”„ë¡œì íŠ¸ ê¸°íš</div>
                            <div style="font-size: 12px; color: var(--danger);">2/6 ì™„ë£Œ</div>
                        </div>
                        <div style="padding: 16px; background: #f8f9fa; border-radius: 8px; text-align: center;">
                            <div style="font-size: 24px; margin-bottom: 8px;">2-7</div>
                            <div style="font-weight: 600; margin-bottom: 4px;">ê°œë°œ ë‹¨ê³„</div>
                            <div style="font-size: 12px; color: #6c757d;">6/6 ì™„ë£Œ</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Guide Content Section -->
            <div id="guide-section" class="content-view" style="display:none;">
                <div class="content-header">
                    <h1 class="content-title">ğŸ“– ì•ˆë‚´ë¬¸ ê´€ë¦¬</h1>
                    <p class="content-subtitle">ê° ë‹¨ê³„ë³„ ê°€ì´ë“œ ì•ˆë‚´ë¬¸ì„ ê´€ë¦¬í•˜ì„¸ìš”.</p>
                </div>

                <!-- ì•ˆë‚´ë¬¸ í†µê³„ -->
                <div class="stats-grid">
                    <div class="stat-card primary">
                        <div class="stat-value">32</div>
                        <div class="stat-label">ì „ì²´ ì•ˆë‚´ë¬¸</div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-value">28</div>
                        <div class="stat-label">ì‘ì„± ì™„ë£Œ</div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-value">4</div>
                        <div class="stat-label">ë¯¸ì‘ì„±</div>
                    </div>
                </div>

                <!-- ì•ˆë‚´ë¬¸ ëª©ë¡ -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">ğŸ“‹ ì•ˆë‚´ë¬¸ ëª©ë¡</h2>
                        <button class="section-action" onclick="showGuideForm()">+ ìƒˆ ì•ˆë‚´ë¬¸ ì¶”ê°€</button>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ë‹¨ê³„ ID</th>
                                <th>ë‹¨ê³„ëª…</th>
                                <th>hasAction</th>
                                <th>í™•ì¸ ë©”ì‹œì§€</th>
                                <th>ìƒíƒœ</th>
                                <th>ì‘ì—…</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>welcome</code></td>
                                <td>í™˜ì˜í•©ë‹ˆë‹¤</td>
                                <td><span class="status-badge" style="background: #e9ecef;">false</span></td>
                                <td>-</td>
                                <td><span class="status-badge active">ì™„ë£Œ</span></td>
                                <td>
                                    <a href="#" class="action-link" onclick="event.preventDefault(); editGuide('welcome')">ìˆ˜ì •</a>
                                    <a href="#" class="action-link" style="color: #6c757d;">ë¯¸ë¦¬ë³´ê¸°</a>
                                </td>
                            </tr>
                            <tr>
                                <td><code>dir_structure</code></td>
                                <td>ì‘ì—… ë””ë ‰í† ë¦¬ êµ¬ì¡° ìƒì„±</td>
                                <td><span class="status-badge" style="background: #d4edda; color: #155724;">true</span></td>
                                <td>ë””ë ‰í† ë¦¬ êµ¬ì¡°ë¥¼ ìƒì„±í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</td>
                                <td><span class="status-badge active">ì™„ë£Œ</span></td>
                                <td>
                                    <a href="#" class="action-link">ìˆ˜ì •</a>
                                    <a href="#" class="action-link" style="color: #6c757d;">ë¯¸ë¦¬ë³´ê¸°</a>
                                </td>
                            </tr>
                            <tr>
                                <td><code>biz_0_1</code></td>
                                <td>ê¸°ì—… ë¹„ì „ ì„¤ì •</td>
                                <td><span class="status-badge" style="background: #d4edda; color: #155724;">true</span></td>
                                <td>ê¸°ì—… ë¹„ì „ì„ ì„¤ì •í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</td>
                                <td><span class="status-badge active">ì™„ë£Œ</span></td>
                                <td>
                                    <a href="#" class="action-link">ìˆ˜ì •</a>
                                    <a href="#" class="action-link" style="color: #6c757d;">ë¯¸ë¦¬ë³´ê¸°</a>
                                </td>
                            </tr>
                            <tr>
                                <td><code>plan_1_1</code></td>
                                <td>í”„ë¡œì íŠ¸ ê°œìš” ì •ì˜</td>
                                <td><span class="status-badge" style="background: #d4edda; color: #155724;">true</span></td>
                                <td>-</td>
                                <td><span class="status-badge pending">ë¯¸ì‘ì„±</span></td>
                                <td>
                                    <a href="#" class="action-link">ì‘ì„±</a>
                                </td>
                            </tr>
                            <tr>
                                <td><code>project_example</code></td>
                                <td>SSAL Works (ì˜ˆì‹œ)</td>
                                <td><span class="status-badge" style="background: #e9ecef;">false</span></td>
                                <td>-</td>
                                <td><span class="status-badge active">ì™„ë£Œ</span></td>
                                <td>
                                    <a href="#" class="action-link">ìˆ˜ì •</a>
                                    <a href="#" class="action-link" style="color: #6c757d;">ë¯¸ë¦¬ë³´ê¸°</a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Inquiries Section -->
            <div id="inquiries-section" class="content-view" style="display:none;">
                <div class="content-header">
                    <h1 class="content-title">ğŸ’¬ ë¬¸ì˜ ê´€ë¦¬</h1>
                    <p class="content-subtitle">ê³ ê°ì„¼í„° ë¬¸ì˜ë¥¼ í™•ì¸í•˜ê³  ë‹µë³€í•˜ì„¸ìš”.</p>
                </div>

                <!-- ì»¨íŠ¸ë¡¤ ë³´ë“œ -->
                <div class="stats-grid">
                    <div class="stat-card primary">
                        <div class="stat-icon">ğŸ“¬</div>
                        <div class="stat-value" id="inquiriesTotalCount">-</div>
                        <div class="stat-label">ì´ ì ‘ìˆ˜</div>
                    </div>
                    <div class="stat-card danger">
                        <div class="stat-icon">â³</div>
                        <div class="stat-value" id="inquiriesPendingCount">-</div>
                        <div class="stat-label">ëŒ€ê¸° ì¤‘</div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-icon">ğŸ”„</div>
                        <div class="stat-value" id="inquiriesInProgressCount">-</div>
                        <div class="stat-label">ì²˜ë¦¬ ì¤‘</div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-icon">âœ…</div>
                        <div class="stat-value" id="inquiriesAnsweredCount">-</div>
                        <div class="stat-label">ë‹µë³€ ì™„ë£Œ</div>
                    </div>
                </div>

                <!-- ë¬¸ì˜ ëª©ë¡ -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">ğŸ“‹ ë¬¸ì˜ ëª©ë¡</h2>
                        <div style="display: flex; gap: 10px;">
                            <button class="section-action" id="btnInquiryAll" style="background: var(--primary);" onclick="filterInquiries('all')">ì „ì²´</button>
                            <button class="section-action" id="btnInquiryPending" style="background: var(--neutral);" onclick="filterInquiries('pending')">ëŒ€ê¸°</button>
                            <button class="section-action" id="btnInquiryInProgress" style="background: var(--neutral);" onclick="filterInquiries('in_progress')">ì²˜ë¦¬ì¤‘</button>
                            <button class="section-action" id="btnInquiryAnswered" style="background: var(--neutral);" onclick="filterInquiries('answered')">ì™„ë£Œ</button>
                        </div>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ìœ í˜•</th>
                                <th>ì œëª©</th>
                                <th>ì‘ì„±ì</th>
                                <th>ì´ë©”ì¼</th>
                                <th>ìƒíƒœ</th>
                                <th>ìš°ì„ ìˆœìœ„</th>
                                <th>ì ‘ìˆ˜ì¼</th>
                                <th>ì‘ì—…</th>
                            </tr>
                        </thead>
                        <tbody id="inquiriesTableBody">
                            <tr>
                                <td colspan="8" style="text-align: center; padding: 40px; color: #6c757d;">
                                    ë¡œë”© ì¤‘...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- ë¬¸ì˜ ìƒì„¸ ëª¨ë‹¬ -->
                <div id="inquiryDetailModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center;">
                    <div style="background: white; border-radius: 12px; width: 90%; max-width: 700px; max-height: 90vh; overflow-y: auto;">
                        <div style="padding: 24px; border-bottom: 1px solid #dee2e6;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <h3 style="margin: 0;">ğŸ“¬ ë¬¸ì˜ ìƒì„¸</h3>
                                <button onclick="closeInquiryModal()" style="background: none; border: none; font-size: 24px; cursor: pointer;">&times;</button>
                            </div>
                        </div>
                        <div style="padding: 24px;" id="inquiryDetailContent">
                            <!-- ë™ì ìœ¼ë¡œ ì±„ì›Œì§ -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Payment Section -->
            <div id="payment-section" class="content-view" style="display:none;">
                <div class="content-header">
                    <h1 class="content-title">ğŸ’³ ê²°ì œ ê´€ë¦¬</h1>
                    <p class="content-subtitle">ê²°ì œ ë‚´ì—­ ë° ìˆ˜ìµì„ ê´€ë¦¬í•˜ì„¸ìš”.</p>
                </div>

                <!-- ê²°ì œ í†µê³„ -->
                <div class="stats-grid">
                    <div class="stat-card success">
                        <div class="stat-icon">ğŸ’°</div>
                        <div class="stat-value">â‚©5,420,000</div>
                        <div class="stat-label">ì´ë²ˆ ë‹¬ ë§¤ì¶œ</div>
                    </div>
                    <div class="stat-card primary">
                        <div class="stat-value">143</div>
                        <div class="stat-label">ì™„ë£Œëœ ê²°ì œ</div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-value">5</div>
                        <div class="stat-label">ëŒ€ê¸° ì¤‘</div>
                    </div>
                    <div class="stat-card danger">
                        <div class="stat-value">2</div>
                        <div class="stat-label">í™˜ë¶ˆ ìš”ì²­</div>
                    </div>
                </div>

                <!-- ê²°ì œ ë‚´ì—­ -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">ğŸ“‹ ê²°ì œ ë‚´ì—­</h2>
                        <button class="section-action">ë‚´ë³´ë‚´ê¸° (CSV)</button>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ê²°ì œ ID</th>
                                <th>ì‚¬ìš©ì</th>
                                <th>ê¸ˆì•¡</th>
                                <th>ê²°ì œ ìˆ˜ë‹¨</th>
                                <th>ìƒíƒœ</th>
                                <th>ê²°ì œì¼</th>
                                <th>ì‘ì—…</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>PAY-2025-001</td>
                                <td>user@example.com</td>
                                <td>â‚©50,000</td>
                                <td>ì‹ ìš©ì¹´ë“œ</td>
                                <td><span class="status-badge answered">ì™„ë£Œ</span></td>
                                <td>2025-11-24 15:30</td>
                                <td><a href="#" class="action-link" onclick="event.preventDefault(); showPaymentDetail()">ìƒì„¸</a></td>
                            </tr>
                            <tr>
                                <td>PAY-2025-002</td>
                                <td>test@test.com</td>
                                <td>â‚©30,000</td>
                                <td>ì¹´ì¹´ì˜¤í˜ì´</td>
                                <td><span class="status-badge pending">ëŒ€ê¸°</span></td>
                                <td>2025-11-24 14:20</td>
                                <td><a href="#" class="action-link">ìƒì„¸</a></td>
                            </tr>
                            <tr>
                                <td>PAY-2025-003</td>
                                <td>admin@ssal.com</td>
                                <td>â‚©100,000</td>
                                <td>ì‹ ìš©ì¹´ë“œ</td>
                                <td><span class="status-badge answered">ì™„ë£Œ</span></td>
                                <td>2025-11-24 10:15</td>
                                <td><a href="#" class="action-link">ìƒì„¸</a></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Credit Section -->
            <div id="credit-section" class="content-view" style="display:none;">
                <div class="content-header">
                    <h1 class="content-title">AI í¬ë ˆë”§ ê´€ë¦¬</h1>
                    <p class="content-subtitle">AI ì„œë¹„ìŠ¤ ê°€ê²© ì„¤ì • ë° ì‚¬ìš©ì í¬ë ˆë”§ì„ ê´€ë¦¬í•˜ì„¸ìš”.</p>
                </div>

                <!-- í¬ë ˆë”§ í†µê³„ -->
                <div class="stats-grid">
                    <div class="stat-card primary">
                        <div class="stat-icon">ğŸ’°</div>
                        <div class="stat-value" id="creditTotalBalance">â‚©0</div>
                        <div class="stat-label">ì „ì²´ í¬ë ˆë”§ ì”ì•¡</div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-value" id="creditTodayCharge">+â‚©0</div>
                        <div class="stat-label">ì˜¤ëŠ˜ ì¶©ì „</div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-value" id="creditTodayUsage">-â‚©0</div>
                        <div class="stat-label">ì˜¤ëŠ˜ ì‚¬ìš©</div>
                    </div>
                    <div class="stat-card primary">
                        <div class="stat-value" id="creditAIUsageCount">0íšŒ</div>
                        <div class="stat-label">AI ì‚¬ìš© íšŸìˆ˜</div>
                    </div>
                </div>

                <!-- AI ì„œë¹„ìŠ¤ ê°€ê²© ì„¤ì • -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">AI ì„œë¹„ìŠ¤ ê°€ê²© ì„¤ì •</h2>
                        <button class="section-action" onclick="loadAIPricing()">ìƒˆë¡œê³ ì¹¨</button>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ì„œë¹„ìŠ¤</th>
                                <th>ì‚¬ìš©ì ê°€ê²©</th>
                                <th>API ì›ê°€</th>
                                <th>ë§ˆì§„ìœ¨</th>
                                <th>ì„¤ëª…</th>
                                <th>ìƒíƒœ</th>
                                <th>ì‘ì—…</th>
                            </tr>
                        </thead>
                        <tbody id="aiPricingTableBody">
                            <tr>
                                <td colspan="7" style="text-align: center; color: #6c757d; padding: 40px;">
                                    ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- ì‚¬ìš©ìë³„ í¬ë ˆë”§ -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">ì‚¬ìš©ìë³„ í¬ë ˆë”§</h2>
                        <button class="section-action" onclick="showCreditChargeModal()">+ ìˆ˜ë™ ì¶©ì „/ì°¨ê°</button>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ì‚¬ìš©ì ID</th>
                                <th>ì´ë¦„</th>
                                <th>ì”ì•¡</th>
                                <th>ë§ˆì§€ë§‰ í™œë™</th>
                                <th>ì‘ì—…</th>
                            </tr>
                        </thead>
                        <tbody id="userCreditTableBody">
                            <tr>
                                <td colspan="5" style="text-align: center; color: #6c757d; padding: 40px;">
                                    ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- í¬ë ˆë”§ ê±°ë˜ ë‚´ì—­ -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">í¬ë ˆë”§ ê±°ë˜ ë‚´ì—­</h2>
                        <button class="section-action" onclick="exportCreditTransactions()">ë‚´ë³´ë‚´ê¸° (CSV)</button>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ì¼ì‹œ</th>
                                <th>ì‚¬ìš©ì</th>
                                <th>ìœ í˜•</th>
                                <th>ê¸ˆì•¡</th>
                                <th>ì”ì•¡</th>
                                <th>ì„¤ëª…</th>
                                <th>ì„œë¹„ìŠ¤</th>
                            </tr>
                        </thead>
                        <tbody id="creditTransactionsTableBody">
                            <tr>
                                <td colspan="7" style="text-align: center; color: #6c757d; padding: 40px;">
                                    ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- AI ì‚¬ìš© ë¡œê·¸ -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">AI ì‚¬ìš© ë¡œê·¸</h2>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ì¼ì‹œ</th>
                                <th>ì‚¬ìš©ì</th>
                                <th>AI ì„œë¹„ìŠ¤</th>
                                <th>í† í°</th>
                                <th>ë¹„ìš©</th>
                                <th>ì‘ë‹µì‹œê°„</th>
                                <th>ì§ˆë¬¸ ë¯¸ë¦¬ë³´ê¸°</th>
                            </tr>
                        </thead>
                        <tbody id="aiUsageLogTableBody">
                            <tr>
                                <td colspan="7" style="text-align: center; color: #6c757d; padding: 40px;">
                                    ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- ì”ì•¡ ë¶€ì¡± ì•Œë¦¼ ëŒ€ìƒ -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">ì”ì•¡ ë¶€ì¡± ì•Œë¦¼ ëŒ€ìƒ (1,000ì› ë¯¸ë§Œ)</h2>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ì‚¬ìš©ì</th>
                                <th>í˜„ì¬ ì”ì•¡</th>
                                <th>ì‘ì—…</th>
                            </tr>
                        </thead>
                        <tbody id="lowBalanceTableBody">
                            <tr>
                                <td colspan="3" style="text-align: center; color: #6c757d; padding: 40px;">
                                    ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Installation Fee Section (ì„¤ì¹˜ë¹„ ê´€ë¦¬) -->
            <div id="installation-section" class="content-view" style="display:none;">
                <div class="content-header">
                    <h1 class="content-title">ğŸ  ì„¤ì¹˜ë¹„ ê´€ë¦¬</h1>
                    <p class="content-subtitle">ì„¤ì¹˜ë¹„ ì…ê¸ˆ ìš”ì²­ì„ ê´€ë¦¬í•˜ì„¸ìš”.</p>
                </div>

                <!-- ì„¤ì¹˜ë¹„ í†µê³„ -->
                <div class="stats-grid">
                    <div class="stat-card warning">
                        <div class="stat-icon">â³</div>
                        <div class="stat-value" id="installationPendingCount">0</div>
                        <div class="stat-label">ëŒ€ê¸° ì¤‘</div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-icon">âœ…</div>
                        <div class="stat-value" id="installationApprovedCount">0</div>
                        <div class="stat-label">ìŠ¹ì¸ ì™„ë£Œ</div>
                    </div>
                    <div class="stat-card danger">
                        <div class="stat-icon">âŒ</div>
                        <div class="stat-value" id="installationRejectedCount">0</div>
                        <div class="stat-label">ê±°ë¶€</div>
                    </div>
                    <div class="stat-card primary">
                        <div class="stat-icon">ğŸ’°</div>
                        <div class="stat-value" id="installationTotalAmount">â‚©0</div>
                        <div class="stat-label">ì´ ì„¤ì¹˜ë¹„ ë§¤ì¶œ</div>
                    </div>
                </div>

                <!-- ì…ê¸ˆ ëŒ€ê¸° ëª©ë¡ -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">â³ ì…ê¸ˆ ëŒ€ê¸° ëª©ë¡</h2>
                        <button class="section-action" onclick="loadInstallationRequests()">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>íšŒì› ID</th>
                                <th>ì´ë©”ì¼</th>
                                <th>ì‹¤ëª… (ì…ê¸ˆìëª…)</th>
                                <th>ì…ê¸ˆìëª… (ì…ë ¥)</th>
                                <th>ê¸ˆì•¡</th>
                                <th>ìš”ì²­ì¼</th>
                                <th>ì‘ì—…</th>
                            </tr>
                        </thead>
                        <tbody id="installationPendingTableBody">
                            <tr>
                                <td colspan="7" style="text-align: center; color: #6c757d; padding: 40px;">
                                    ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- ì²˜ë¦¬ ì™„ë£Œ ëª©ë¡ -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">ğŸ“‹ ì²˜ë¦¬ ì™„ë£Œ ëª©ë¡</h2>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>íšŒì› ID</th>
                                <th>ì´ë©”ì¼</th>
                                <th>ì…ê¸ˆìëª…</th>
                                <th>ê¸ˆì•¡</th>
                                <th>ìš”ì²­ì¼</th>
                                <th>ì²˜ë¦¬ì¼</th>
                                <th>ìƒíƒœ</th>
                            </tr>
                        </thead>
                        <tbody id="installationProcessedTableBody">
                            <tr>
                                <td colspan="7" style="text-align: center; color: #6c757d; padding: 40px;">
                                    ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Projects Section (í”„ë¡œì íŠ¸ ê´€ë¦¬) -->
            <div id="projects-section" class="content-view" style="display:none;">
                <div class="content-header">
                    <h1 class="content-title">ğŸ“ í”„ë¡œì íŠ¸ ê´€ë¦¬</h1>
                    <p class="content-subtitle">ì‚¬ìš©ì í”„ë¡œì íŠ¸ í˜„í™©ì„ ê´€ë¦¬í•˜ì„¸ìš”.</p>
                </div>

                <!-- í”„ë¡œì íŠ¸ í†µê³„ -->
                <div class="stats-grid">
                    <div class="stat-card primary">
                        <div class="stat-icon">ğŸ“</div>
                        <div class="stat-value" id="projectsTotalCount">0</div>
                        <div class="stat-label">ì „ì²´ í”„ë¡œì íŠ¸</div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-icon">ğŸ”„</div>
                        <div class="stat-value" id="projectsInProgressCount">0</div>
                        <div class="stat-label">ì§„í–‰ ì¤‘</div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-icon">âœ…</div>
                        <div class="stat-value" id="projectsCompletedCount">0</div>
                        <div class="stat-label">ì™„ë£Œ</div>
                    </div>
                    <div class="stat-card neutral">
                        <div class="stat-icon">ğŸ“¦</div>
                        <div class="stat-value" id="projectsArchivedCount">0</div>
                        <div class="stat-label">ë³´ê´€</div>
                    </div>
                </div>

                <!-- ê²€ìƒ‰ -->
                <div class="content-section" style="margin-bottom: 16px;">
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <input type="text" id="projectSearchInput" placeholder="í”„ë¡œì íŠ¸ ID, í”„ë¡œì íŠ¸ëª…, ì‚¬ìš©ì ID ê²€ìƒ‰..." style="flex: 1; padding: 10px 14px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;">
                        <button class="section-action" onclick="searchProjects()">ğŸ” ê²€ìƒ‰</button>
                        <button class="section-action" onclick="loadProjects()">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>
                    </div>
                </div>

                <!-- í”„ë¡œì íŠ¸ ëª©ë¡ -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">ğŸ“‹ í”„ë¡œì íŠ¸ ëª©ë¡</h2>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>í”„ë¡œì íŠ¸ ID</th>
                                <th>í”„ë¡œì íŠ¸ëª…</th>
                                <th>ì‚¬ìš©ì ID</th>
                                <th>ìƒíƒœ</th>
                                <th>ì§„í–‰ë¥ </th>
                                <th>ë“±ë¡ì¼</th>
                                <th>ì‘ì—…</th>
                            </tr>
                        </thead>
                        <tbody id="projectsTableBody">
                            <tr>
                                <td colspan="7" style="text-align: center; color: #6c757d; padding: 40px;">
                                    ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Stats Section -->
            <div id="stats-section" class="content-view" style="display:none;">
                <div class="content-header">
                    <h1 class="content-title">ğŸ“ˆ í†µê³„ ë° ë¶„ì„</h1>
                    <p class="content-subtitle">í”Œë«í¼ ë‚´ë¶€ì—ì„œ ì¸¡ì • ê°€ëŠ¥í•œ í†µê³„ì…ë‹ˆë‹¤.</p>
                </div>

                <!-- ê¸°ê°„ ì„ íƒ -->
                <div class="content-section" style="margin-bottom: 24px;">
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <span style="font-weight: 600;">ê¸°ê°„:</span>
                        <button class="section-action" style="background: var(--primary);">ì˜¤ëŠ˜</button>
                        <button class="section-action" style="background: var(--neutral);">7ì¼</button>
                        <button class="section-action" style="background: var(--neutral);">30ì¼</button>
                        <button class="section-action" style="background: var(--neutral);">ì „ì²´</button>
                    </div>
                </div>

                <!-- íšŒì› í†µê³„ -->
                <div class="stats-grid">
                    <div class="stat-card primary">
                        <div class="stat-icon">ğŸ‘¥</div>
                        <div class="stat-value" id="totalUsersCount">-</div>
                        <div class="stat-label">ì´ íšŒì› ìˆ˜</div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-icon">âœ¨</div>
                        <div class="stat-value">+12</div>
                        <div class="stat-label">ì‹ ê·œ ê°€ì… (ê¸°ê°„)</div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-icon">ğŸ”„</div>
                        <div class="stat-value">45</div>
                        <div class="stat-label">í™œì„± êµ¬ë…ì</div>
                    </div>
                    <div class="stat-card primary">
                        <div class="stat-icon">ğŸ“</div>
                        <div class="stat-value">567</div>
                        <div class="stat-label">Order ì‘ì„± ìˆ˜</div>
                    </div>
                </div>

                <!-- ë§¤ì¶œ í†µê³„ -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">ğŸ’° ë§¤ì¶œ í†µê³„</h2>
                        <button class="section-action">ë‚´ë³´ë‚´ê¸° (CSV)</button>
                    </div>
                    <div class="stats-grid" style="margin-top: 16px;">
                        <div class="stat-card success">
                            <div class="stat-value">â‚©135M</div>
                            <div class="stat-label">ì„¤ì¹˜ë¹„ ë§¤ì¶œ (ëˆ„ì )</div>
                        </div>
                        <div class="stat-card success">
                            <div class="stat-value">â‚©2.25M</div>
                            <div class="stat-label">ì›” ì‚¬ìš©ë£Œ (ì´ë²ˆ ë‹¬)</div>
                        </div>
                        <div class="stat-card warning">
                            <div class="stat-value">â‚©1.24M</div>
                            <div class="stat-label">í¬ë ˆë”§ íŒë§¤ (ì´ë²ˆ ë‹¬)</div>
                        </div>
                        <div class="stat-card primary">
                            <div class="stat-value">â‚©3.49M</div>
                            <div class="stat-label">ì´ë²ˆ ë‹¬ ì´ ë§¤ì¶œ</div>
                        </div>
                    </div>
                </div>

                <!-- AI ì‚¬ìš© í†µê³„ -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">ğŸ¤– AI ì‚¬ìš© í†µê³„</h2>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>AI ì„œë¹„ìŠ¤</th>
                                <th>í˜¸ì¶œ ìˆ˜</th>
                                <th>í¬ë ˆë”§ ìˆ˜ìµ</th>
                                <th>ì‹¤ì œ ë¹„ìš©</th>
                                <th>ë§ˆì§„</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>ğŸŸ  Perplexity</td>
                                <td>23,456</td>
                                <td style="color: var(--success);">â‚©468,900</td>
                                <td style="color: var(--danger);">â‚©312,000</td>
                                <td style="color: var(--success); font-weight: 600;">â‚©156,900</td>
                            </tr>
                            <tr>
                                <td>ğŸŸ¢ ChatGPT</td>
                                <td>15,678</td>
                                <td style="color: var(--success);">â‚©235,170</td>
                                <td style="color: var(--danger);">â‚©156,780</td>
                                <td style="color: var(--success); font-weight: 600;">â‚©78,390</td>
                            </tr>
                            <tr>
                                <td>ğŸ”µ Gemini</td>
                                <td>6,544</td>
                                <td style="color: var(--success);">â‚©65,440</td>
                                <td style="color: var(--danger);">â‚©32,720</td>
                                <td style="color: var(--success); font-weight: 600;">â‚©32,720</td>
                            </tr>
                            <tr style="background: #f8f9fa; font-weight: 600;">
                                <td>í•©ê³„</td>
                                <td>45,678</td>
                                <td style="color: var(--success);">â‚©769,510</td>
                                <td style="color: var(--danger);">â‚©501,500</td>
                                <td style="color: var(--success);">â‚©268,010</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

            </div>

            <!-- API Usage Section -->
            <div id="api-section" class="content-view" style="display:none;">
                <div class="content-header">
                    <h1 class="content-title">ğŸ”Œ API ì‚¬ìš©ëŸ‰</h1>
                    <p class="content-subtitle">AI API ì‚¬ìš©ëŸ‰ ë° ë¹„ìš©ì„ ëª¨ë‹ˆí„°ë§í•˜ì„¸ìš”.</p>
                </div>

                <!-- API ì‚¬ìš©ëŸ‰ í†µê³„ -->
                <div class="stats-grid">
                    <div class="stat-card primary">
                        <div class="stat-icon">ğŸ¤–</div>
                        <div class="stat-value">45,678</div>
                        <div class="stat-label">ì´ API í˜¸ì¶œ</div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-icon">ğŸ’°</div>
                        <div class="stat-value">$234.56</div>
                        <div class="stat-label">ì´ë²ˆ ë‹¬ ë¹„ìš©</div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-icon">ğŸ“Š</div>
                        <div class="stat-value">1,523</div>
                        <div class="stat-label">ì˜¤ëŠ˜ í˜¸ì¶œ</div>
                    </div>
                    <div class="stat-card danger">
                        <div class="stat-icon">âš ï¸</div>
                        <div class="stat-value">78%</div>
                        <div class="stat-label">í•œë„ ì‚¬ìš©ë¥ </div>
                    </div>
                </div>

                <!-- AIë³„ ì‚¬ìš©ëŸ‰ -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">ğŸ¤– AIë³„ ì‚¬ìš©ëŸ‰</h2>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>AI ì„œë¹„ìŠ¤</th>
                                <th>í˜¸ì¶œ ìˆ˜</th>
                                <th>í† í° ì‚¬ìš©ëŸ‰</th>
                                <th>ë¹„ìš©</th>
                                <th>ìƒíƒœ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>ğŸŸ  Perplexity</td>
                                <td>23,456</td>
                                <td>4,567,890</td>
                                <td>$156.78</td>
                                <td><span class="status-badge active">ì •ìƒ</span></td>
                            </tr>
                            <tr>
                                <td>ğŸŸ¢ ChatGPT</td>
                                <td>15,678</td>
                                <td>3,234,567</td>
                                <td>$67.89</td>
                                <td><span class="status-badge active">ì •ìƒ</span></td>
                            </tr>
                            <tr>
                                <td>ğŸ”µ Gemini</td>
                                <td>6,544</td>
                                <td>1,234,567</td>
                                <td>$9.89</td>
                                <td><span class="status-badge active">ì •ìƒ</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- API í‚¤ ê´€ë¦¬ -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">ğŸ”‘ API í‚¤ ê´€ë¦¬</h2>
                        <button class="section-action">+ ìƒˆ í‚¤ ì¶”ê°€</button>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ì„œë¹„ìŠ¤</th>
                                <th>API í‚¤</th>
                                <th>ìƒíƒœ</th>
                                <th>ë§Œë£Œì¼</th>
                                <th>ì‘ì—…</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Perplexity</td>
                                <td>pplx-****-****-****-7890</td>
                                <td><span class="status-badge active">í™œì„±</span></td>
                                <td>2026-01-15</td>
                                <td><a href="#" class="action-link">ìˆ˜ì •</a></td>
                            </tr>
                            <tr>
                                <td>OpenAI</td>
                                <td>sk-****-****-****-abcd</td>
                                <td><span class="status-badge active">í™œì„±</span></td>
                                <td>ë¬´ê¸°í•œ</td>
                                <td><a href="#" class="action-link">ìˆ˜ì •</a></td>
                            </tr>
                            <tr>
                                <td>Google AI</td>
                                <td>AIza****-****-****-wxyz</td>
                                <td><span class="status-badge active">í™œì„±</span></td>
                                <td>ë¬´ê¸°í•œ</td>
                                <td><a href="#" class="action-link">ìˆ˜ì •</a></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Settings Section -->
            <div id="settings-section" class="content-view" style="display:none;">
                <div class="content-header">
                    <h1 class="content-title">âš™ï¸ ì„¤ì •</h1>
                    <p class="content-subtitle">ì‹œìŠ¤í…œ ì„¤ì •ì„ ê´€ë¦¬í•˜ì„¸ìš”.</p>
                </div>

                <!-- ì¼ë°˜ ì„¤ì • -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">ğŸ  ì¼ë°˜ ì„¤ì •</h2>
                    </div>
                    <div class="form-group">
                        <label class="form-label">í”Œë«í¼ ì´ë¦„</label>
                        <input type="text" class="form-input" value="SSAL Works">
                    </div>
                    <div class="form-group">
                        <label class="form-label">ê´€ë¦¬ì ì´ë©”ì¼</label>
                        <input type="email" class="form-input" value="admin@ssal.works">
                    </div>
                    <div class="form-group">
                        <label class="form-label">ì‹œê°„ëŒ€</label>
                        <select class="form-select">
                            <option value="Asia/Seoul" selected>Asia/Seoul (KST)</option>
                            <option value="UTC">UTC</option>
                        </select>
                    </div>
                </div>

                <!-- ì•Œë¦¼ ì„¤ì • -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">ğŸ”” ì•Œë¦¼ ì„¤ì •</h2>
                    </div>
                    <div class="form-group" style="display: flex; align-items: center; gap: 12px;">
                        <input type="checkbox" id="notifyInquiry" checked>
                        <label for="notifyInquiry" style="font-weight: 500;">ìƒˆ ë¬¸ì˜ ì ‘ìˆ˜ ì‹œ ì´ë©”ì¼ ì•Œë¦¼</label>
                    </div>
                    <div class="form-group" style="display: flex; align-items: center; gap: 12px;">
                        <input type="checkbox" id="notifyPayment" checked>
                        <label for="notifyPayment" style="font-weight: 500;">ê²°ì œ ì™„ë£Œ ì‹œ ì´ë©”ì¼ ì•Œë¦¼</label>
                    </div>
                    <div class="form-group" style="display: flex; align-items: center; gap: 12px;">
                        <input type="checkbox" id="notifySignup">
                        <label for="notifySignup" style="font-weight: 500;">ì‹ ê·œ ê°€ì… ì‹œ ì´ë©”ì¼ ì•Œë¦¼</label>
                    </div>
                    <div class="form-group" style="display: flex; align-items: center; gap: 12px;">
                        <input type="checkbox" id="notifyApi" checked>
                        <label for="notifyApi" style="font-weight: 500;">API í•œë„ 80% ë„ë‹¬ ì‹œ ì•Œë¦¼</label>
                    </div>
                </div>

                <!-- ìš”ê¸ˆ ì„¤ì • -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">ğŸ’° ìš”ê¸ˆ ì„¤ì •</h2>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ì„¤ì¹˜ë¹„ (ì›)</label>
                        <input type="number" class="form-input" value="3000000">
                    </div>
                    <div class="form-group">
                        <label class="form-label">ì›” ì‚¬ìš©ë£Œ (ì›)</label>
                        <input type="number" class="form-input" value="50000">
                    </div>
                    <div class="form-group">
                        <label class="form-label">í¬ë ˆë”§ ë‹¨ê°€ (ì›/í¬ë ˆë”§)</label>
                        <input type="number" class="form-input" value="10">
                    </div>
                </div>

                <!-- ë°ì´í„° ê´€ë¦¬ -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">ğŸ’¾ ë°ì´í„° ê´€ë¦¬</h2>
                    </div>
                    <div style="display: flex; gap: 12px; flex-wrap: wrap;">
                        <button class="section-action" style="background: var(--primary);">ğŸ“¥ ë°ì´í„° ë°±ì—…</button>
                        <button class="section-action" style="background: var(--warning); color: #000;">ğŸ“¤ ë°ì´í„° ë³µì›</button>
                        <button class="section-action" style="background: var(--neutral);">ğŸ“Š ì‚¬ìš© í†µê³„ ë‚´ë³´ë‚´ê¸°</button>
                    </div>
                    <p style="margin-top: 12px; font-size: 12px; color: #6c757d;">
                        ë§ˆì§€ë§‰ ë°±ì—…: 2025-11-24 03:00 (ìë™)
                    </p>
                </div>

                <div style="margin-top: 24px; text-align: right;">
                    <button class="form-btn form-btn-primary" onclick="showToast('ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success')">ì„¤ì • ì €ì¥</button>
                </div>
            </div>

            <!-- Subscription Section -->
            <div id="subscription-section" class="content-view" style="display:none;">
                <div class="content-header">
                    <h1 class="content-title">ğŸ”„ êµ¬ë… ê´€ë¦¬</h1>
                    <p class="content-subtitle">ì„¤ì¹˜ë¹„ ë° ì›” ì‚¬ìš©ë£Œ ê²°ì œ í˜„í™©ì„ ê´€ë¦¬í•˜ì„¸ìš”.</p>
                </div>

                <!-- êµ¬ë… í†µê³„ -->
                <div class="stats-grid">
                    <div class="stat-card primary">
                        <div class="stat-icon">ğŸ‘¥</div>
                        <div class="stat-value">45</div>
                        <div class="stat-label">ì „ì²´ êµ¬ë…ì</div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-icon">âœ…</div>
                        <div class="stat-value">42</div>
                        <div class="stat-label">ì •ìƒ êµ¬ë…</div>
                    </div>
                    <div class="stat-card danger">
                        <div class="stat-icon">âš ï¸</div>
                        <div class="stat-value">3</div>
                        <div class="stat-label">ë¯¸ë‚©/ë§Œë£Œ</div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-icon">ğŸ’°</div>
                        <div class="stat-value">â‚©2.25M</div>
                        <div class="stat-label">ì´ë²ˆ ë‹¬ ì˜ˆìƒ ìˆ˜ìµ</div>
                    </div>
                </div>

                <!-- ì„¤ì¹˜ë¹„ ê²°ì œ í˜„í™© -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">ğŸ  ì„¤ì¹˜ë¹„ ê²°ì œ í˜„í™©</h2>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ì‚¬ìš©ì</th>
                                <th>ì„¤ì¹˜ë¹„</th>
                                <th>ê²°ì œë°©ì‹</th>
                                <th>ê²°ì œì¼</th>
                                <th>ìƒíƒœ</th>
                                <th>ì‘ì—…</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>user@example.com</td>
                                <td>â‚©3,000,000</td>
                                <td>ì¼ì‹œë¶ˆ</td>
                                <td>2025-11-01</td>
                                <td><span class="status-badge active">ì™„ë‚©</span></td>
                                <td><a href="#" class="action-link">ìƒì„¸</a></td>
                            </tr>
                            <tr>
                                <td>test@test.com</td>
                                <td>â‚©3,000,000</td>
                                <td>3íšŒ ë¶„í• </td>
                                <td>2025-10-15</td>
                                <td><span class="status-badge warning" style="background: #fff3cd; color: #856404;">2/3 ì™„ë£Œ</span></td>
                                <td><a href="#" class="action-link">ìƒì„¸</a></td>
                            </tr>
                            <tr>
                                <td>new@company.com</td>
                                <td>â‚©3,000,000</td>
                                <td>ì¼ì‹œë¶ˆ</td>
                                <td>-</td>
                                <td><span class="status-badge pending">ë¯¸ê²°ì œ</span></td>
                                <td>
                                    <a href="#" class="action-link">ê²°ì œìš”ì²­</a>
                                    <a href="#" class="action-link">ìƒì„¸</a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- ì›” ì‚¬ìš©ë£Œ í˜„í™© -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">ğŸ“… ì›” ì‚¬ìš©ë£Œ í˜„í™© (â‚©50,000/ì›”)</h2>
                        <button class="section-action" onclick="sendPaymentReminder()">ë¯¸ë‚©ì ì•Œë¦¼ ë°œì†¡</button>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ì‚¬ìš©ì</th>
                                <th>êµ¬ë… ì‹œì‘ì¼</th>
                                <th>ê²°ì œì¼</th>
                                <th>ë‹¤ìŒ ê²°ì œ</th>
                                <th>ìë™ê²°ì œ</th>
                                <th>ìƒíƒœ</th>
                                <th>ì‘ì—…</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>user@example.com</td>
                                <td>2025-11-01</td>
                                <td>ë§¤ì›” 1ì¼</td>
                                <td>2025-12-01</td>
                                <td><span class="status-badge active">ON</span></td>
                                <td><span class="status-badge active">ì •ìƒ</span></td>
                                <td><a href="#" class="action-link">ê´€ë¦¬</a></td>
                            </tr>
                            <tr>
                                <td>test@test.com</td>
                                <td>2025-10-15</td>
                                <td>ë§¤ì›” 15ì¼</td>
                                <td>2025-12-15</td>
                                <td><span class="status-badge active">ON</span></td>
                                <td><span class="status-badge active">ì •ìƒ</span></td>
                                <td><a href="#" class="action-link">ê´€ë¦¬</a></td>
                            </tr>
                            <tr>
                                <td>overdue@company.com</td>
                                <td>2025-09-20</td>
                                <td>ë§¤ì›” 20ì¼</td>
                                <td>2025-11-20 (ì—°ì²´)</td>
                                <td><span class="status-badge" style="background: #e9ecef;">OFF</span></td>
                                <td><span class="status-badge" style="background: #dc3545; color: white;">ë¯¸ë‚© 8ì¼</span></td>
                                <td>
                                    <a href="#" class="action-link">ë…ì´‰</a>
                                    <a href="#" class="action-link">ê´€ë¦¬</a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- êµ¬ë… ë§Œë£Œ ì˜ˆì • -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">â° ê°±ì‹ /ë§Œë£Œ ì˜ˆì • (7ì¼ ì´ë‚´)</h2>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ì‚¬ìš©ì</th>
                                <th>ë§Œë£Œì¼</th>
                                <th>ë‚¨ì€ ì¼ìˆ˜</th>
                                <th>ìë™ê°±ì‹ </th>
                                <th>ì‘ì—…</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>renewal@test.com</td>
                                <td>2025-11-30</td>
                                <td><span style="color: var(--warning); font-weight: 600;">2ì¼</span></td>
                                <td><span class="status-badge active">ON</span></td>
                                <td><a href="#" class="action-link">í™•ì¸</a></td>
                            </tr>
                            <tr>
                                <td>expire@company.com</td>
                                <td>2025-12-01</td>
                                <td><span style="color: var(--success);">3ì¼</span></td>
                                <td><span class="status-badge" style="background: #e9ecef;">OFF</span></td>
                                <td>
                                    <a href="#" class="action-link">ê°±ì‹ ìš”ì²­</a>
                                    <a href="#" class="action-link">í™•ì¸</a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Users Section -->
            <div id="users-section" class="content-view" style="display:none;">
                <div class="content-header">
                    <h1 class="content-title">ğŸ‘¥ íšŒì› ê´€ë¦¬</h1>
                    <p class="content-subtitle">ì „ì²´ íšŒì›ì„ ê´€ë¦¬í•˜ì„¸ìš”.</p>
                </div>

                <!-- íšŒì› í†µê³„ -->
                <div class="stats-grid">
                    <div class="stat-card primary">
                        <div class="stat-icon">ğŸ‘¥</div>
                        <div class="stat-value" id="totalUsersCount">-</div>
                        <div class="stat-label">ì „ì²´ íšŒì›</div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-value" id="activeUsersCount">-</div>
                        <div class="stat-label">í™œì„± íšŒì›</div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-value" id="paidUsersCount">-</div>
                        <div class="stat-label">ì„¤ì¹˜ë¹„ ë‚©ë¶€</div>
                    </div>
                    <div class="stat-card primary">
                        <div class="stat-value" id="totalCreditsCount">-</div>
                        <div class="stat-label">ì´ í¬ë ˆë”§</div>
                    </div>
                </div>

                <!-- íšŒì› ëª©ë¡ -->
                <div class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">ğŸ“‹ íšŒì› ëª©ë¡</h2>
                        <div style="display: flex; gap: 10px;">
                            <input type="text" id="userSearchInput" placeholder="ì´ë©”ì¼/ë‹‰ë„¤ì„ ê²€ìƒ‰..." style="padding: 6px 12px; border: 1px solid var(--border-color); border-radius: 4px; min-width: 200px;" onkeypress="if(event.key==='Enter') searchUsers()">
                            <button class="section-action" onclick="searchUsers()">ê²€ìƒ‰</button>
                            <button class="section-action" onclick="loadUsers()" style="background: var(--neutral);">ìƒˆë¡œê³ ì¹¨</button>
                        </div>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>íšŒì›ID</th>
                                <th>ì´ë©”ì¼</th>
                                <th>ë‹‰ë„¤ì„</th>
                                <th>í”Œëœ</th>
                                <th>ìƒíƒœ</th>
                                <th>í¬ë ˆë”§</th>
                                <th>ê°€ì…ì¼</th>
                                <th>ì‘ì—…</th>
                            </tr>
                        </thead>
                        <tbody id="usersTableBody">
                            <tr>
                                <td colspan="8" style="text-align: center; padding: 40px;">
                                    ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </main>

        <!-- Form Modals -->
        <!-- í•™ìŠµì½˜í…ì¸  ê´€ë ¨ ëª¨ë‹¬ ì œê±°ë¨ (ìë™í™” ì‹œìŠ¤í…œìœ¼ë¡œ ì „í™˜) -->

        <!-- FAQ Depth1 (ëŒ€ë¶„ë¥˜) ì¶”ê°€/ìˆ˜ì • Modal -->
        <div id="faqDepth1FormOverlay" class="form-overlay" onclick="if(event.target === this) closeFaqDepth1Form()">
            <div class="form-modal">
                <div class="form-header">ğŸ“ FAQ ëŒ€ë¶„ë¥˜ ì¶”ê°€/ìˆ˜ì •</div>
                <form onsubmit="event.preventDefault(); saveFaqDepth1();">
                    <div class="form-group">
                        <label class="form-label">ëŒ€ë¶„ë¥˜ ì œëª©</label>
                        <input type="text" id="faqDepth1Title" class="form-input" placeholder="ì˜ˆ: ë¡œê·¸ì¸/íšŒì›ê°€ì…" required>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="form-btn form-btn-secondary" onclick="closeFaqDepth1Form()">ì·¨ì†Œ</button>
                        <button type="submit" class="form-btn form-btn-primary">ì €ì¥</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- FAQ Depth2 (ì¤‘ë¶„ë¥˜) ì¶”ê°€/ìˆ˜ì • Modal -->
        <div id="faqDepth2FormOverlay" class="form-overlay" onclick="if(event.target === this) closeFaqDepth2Form()">
            <div class="form-modal">
                <div class="form-header">ğŸ“‚ FAQ ì¤‘ë¶„ë¥˜ ì¶”ê°€/ìˆ˜ì •</div>
                <form onsubmit="event.preventDefault(); saveFaqDepth2();">
                    <div class="form-group">
                        <label class="form-label">ìƒìœ„ ëŒ€ë¶„ë¥˜</label>
                        <input type="text" id="faqDepth2Parent" class="form-input" readonly style="background: #f8f9fa;">
                    </div>
                    <div class="form-group">
                        <label class="form-label">ì¤‘ë¶„ë¥˜ ì œëª©</label>
                        <input type="text" id="faqDepth2Title" class="form-input" placeholder="ì˜ˆ: ê³„ì • ê´€ë¦¬" required>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="form-btn form-btn-secondary" onclick="closeFaqDepth2Form()">ì·¨ì†Œ</button>
                        <button type="submit" class="form-btn form-btn-primary">ì €ì¥</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- FAQ Depth3 (ì†Œë¶„ë¥˜/ì§ˆë¬¸) ì¶”ê°€/ìˆ˜ì • Modal -->
        <div id="faqDepth3FormOverlay" class="form-overlay" onclick="if(event.target === this) closeFaqDepth3Form()">
            <div class="form-modal" style="max-width: 700px;">
                <div class="form-header">ğŸ“„ FAQ ì†Œë¶„ë¥˜ (ì§ˆë¬¸/ë‹µë³€) ì¶”ê°€/ìˆ˜ì •</div>
                <form onsubmit="event.preventDefault(); saveFaqDepth3();">
                    <div class="form-group">
                        <label class="form-label">ìƒìœ„ ëŒ€ë¶„ë¥˜</label>
                        <input type="text" id="faqDepth3Depth1" class="form-input" readonly style="background: #f8f9fa;">
                    </div>
                    <div class="form-group">
                        <label class="form-label">ìƒìœ„ ì¤‘ë¶„ë¥˜</label>
                        <input type="text" id="faqDepth3Depth2" class="form-input" readonly style="background: #f8f9fa;">
                    </div>
                    <div class="form-group">
                        <label class="form-label">ì†Œë¶„ë¥˜ ì œëª© (ì§ˆë¬¸)</label>
                        <input type="text" id="faqDepth3Title" class="form-input" placeholder="ì˜ˆ: ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •" required>
                        <p style="font-size: 11px; color: #6c757d; margin-top: 6px;">
                            ğŸ’¡ ì‚¬ìš©ìê°€ ë³¼ ì§ˆë¬¸ì„ ê°„ê²°í•˜ê²Œ ì…ë ¥í•˜ì„¸ìš”
                        </p>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ë‹µë³€ ë‚´ìš©</label>
                        <textarea id="faqAnswer" class="form-textarea" placeholder="ë‹µë³€ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”. HTML íƒœê·¸ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.&#10;&#10;ì˜ˆì‹œ:&#10;<p>ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ë°©ë²•:</p>&#10;<ol>&#10;<li>ë¡œê·¸ì¸ í˜ì´ì§€ì—ì„œ 'ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°' í´ë¦­</li>&#10;<li>ê°€ì…í•œ ì´ë©”ì¼ ì£¼ì†Œ ì…ë ¥</li>&#10;<li>ì´ë©”ì¼ë¡œ ë°›ì€ ë§í¬ í´ë¦­</li>&#10;</ol>" rows="10" required></textarea>
                        <p style="font-size: 11px; color: #6c757d; margin-top: 6px;">
                            ğŸ’¡ HTML íƒœê·¸ ì‚¬ìš© ê°€ëŠ¥: &lt;p&gt;, &lt;ul&gt;, &lt;ol&gt;, &lt;li&gt;, &lt;strong&gt; ë“±<br>
                            âš ï¸ XSS ë°©ì§€ë¥¼ ìœ„í•´ DOMPurifyë¡œ ìë™ ì •í™”ë©ë‹ˆë‹¤
                        </p>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ì„¤ëª… (ì„ íƒ)</label>
                        <input type="text" id="faqDescription" class="form-input" placeholder="ì˜ˆ: ë¹„ë°€ë²ˆí˜¸ë¥¼ ìŠì–´ë²„ë ¸ì„ ë•Œ ì¬ì„¤ì •í•˜ëŠ” ë°©ë²•">
                    </div>
                    <div class="form-actions">
                        <button type="button" class="form-btn form-btn-secondary" onclick="closeFaqDepth3Form()">ì·¨ì†Œ</button>
                        <button type="submit" class="form-btn form-btn-primary">ì €ì¥</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Inquiry Answer Form Modal -->
        <div id="inquiryFormOverlay" class="form-overlay" onclick="if(event.target === this) closeInquiryForm()">
            <div class="form-modal">
                <div class="form-header">ğŸ’¬ ë¬¸ì˜ ë‹µë³€ ì‘ì„±</div>
                <div style="margin-bottom: 24px; padding: 16px; background: #f8f9fa; border-radius: 8px;">
                    <div style="font-size: 13px; font-weight: 600; color: #495057; margin-bottom: 8px;">ì§ˆë¬¸ ë‚´ìš©:</div>
                    <div style="font-size: 14px; color: #212529;">API ì‚¬ìš© ë°©ë²•ì´ ê¶ê¸ˆí•©ë‹ˆë‹¤</div>
                    <div style="margin-top: 12px; font-size: 12px; color: #6c757d;">
                        <span>ì‚¬ìš©ì: user@example.com</span> |
                        <span>ì ‘ìˆ˜ì¼: 2025-11-24 14:30</span>
                    </div>
                </div>
                <form onsubmit="event.preventDefault(); saveInquiryAnswer();">
                    <div class="form-group">
                        <label class="form-label">ë‹µë³€ ë‚´ìš©</label>
                        <textarea class="form-textarea" style="min-height: 200px;" placeholder="ë‹µë³€ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..." required></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="form-btn form-btn-secondary" onclick="closeInquiryForm()">ì·¨ì†Œ</button>
                        <button type="submit" class="form-btn form-btn-primary">ë‹µë³€ ë³´ë‚´ê¸°</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Credit Form Modal -->
        <div id="creditFormOverlay" class="form-overlay" onclick="if(event.target === this) closeCreditForm()">
            <div class="form-modal">
                <div class="form-header">ğŸª™ í¬ë ˆë”§ ì¶©ì „/ì°¨ê°</div>
                <form onsubmit="event.preventDefault(); saveCredit();">
                    <div class="form-group">
                        <label class="form-label">ì‚¬ìš©ì ì´ë©”ì¼</label>
                        <input type="email" class="form-input" placeholder="user@example.com" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ì‘ì—… ìœ í˜•</label>
                        <select class="form-select" required>
                            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                            <option value="charge">ì¶©ì „ (+)</option>
                            <option value="deduct">ì°¨ê° (-)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ê¸ˆì•¡</label>
                        <input type="number" class="form-input" placeholder="10000" min="1" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ì‚¬ìœ </label>
                        <textarea class="form-textarea" style="min-height: 80px;" placeholder="ì¶©ì „/ì°¨ê° ì‚¬ìœ ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." required></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="form-btn form-btn-secondary" onclick="closeCreditForm()">ì·¨ì†Œ</button>
                        <button type="submit" class="form-btn form-btn-primary">ì ìš©</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- User Detail Modal -->
        <div id="userDetailOverlay" class="form-overlay" onclick="if(event.target === this) closeUserDetail()">
            <div class="form-modal" style="max-width: 500px;">
                <div class="form-header" id="userDetailHeader">ğŸ‘¤ íšŒì› ìƒì„¸ ì •ë³´</div>
                <div style="margin-bottom: 24px;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px;">
                        <div>
                            <div style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">íšŒì› ID</div>
                            <div style="font-size: 14px; font-weight: 600;" id="userDetailUserId">-</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">ì´ë©”ì¼</div>
                            <div style="font-size: 14px; font-weight: 600;" id="userDetailEmail">-</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">ë‹‰ë„¤ì„</div>
                            <div style="font-size: 14px; font-weight: 600;" id="userDetailNickname">-</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">ì‹¤ëª…</div>
                            <div style="font-size: 14px;" id="userDetailRealName">-</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">ê°€ì…ì¼</div>
                            <div style="font-size: 14px;" id="userDetailCreatedAt">-</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">í”Œëœ</div>
                            <div id="userDetailPlan">-</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">ì„¤ì¹˜ë¹„ ë‚©ë¶€</div>
                            <div id="userDetailInstallationFee">-</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">í¬ë ˆë”§ ì”ì•¡</div>
                            <div style="font-size: 14px; font-weight: 600; color: var(--success);" id="userDetailCredit">-</div>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">íšŒì› ìƒíƒœ</label>
                    <select class="form-select" id="userDetailStatusSelect">
                        <option value="active">í™œì„±</option>
                        <option value="inactive">ë¹„í™œì„±</option>
                        <option value="suspended">ì •ì§€</option>
                        <option value="pending">ëŒ€ê¸°</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="form-btn form-btn-secondary" onclick="closeUserDetail()">ë‹«ê¸°</button>
                    <button type="button" class="form-btn form-btn-primary" onclick="saveUserStatus()">ìƒíƒœ ì €ì¥</button>
                </div>
            </div>
        </div>

        <!-- Payment Detail Modal -->
        <div id="paymentDetailOverlay" class="form-overlay" onclick="if(event.target === this) closePaymentDetail()">
            <div class="form-modal">
                <div class="form-header">ğŸ’³ ê²°ì œ ìƒì„¸</div>
                <div style="margin-bottom: 24px;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                        <div>
                            <div style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">ê²°ì œ ID</div>
                            <div style="font-size: 14px; font-weight: 600;">PAY-2025-001</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">ì‚¬ìš©ì</div>
                            <div style="font-size: 14px;">user@example.com</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">ê¸ˆì•¡</div>
                            <div style="font-size: 18px; font-weight: 700; color: var(--success);">â‚©50,000</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">ê²°ì œ ìˆ˜ë‹¨</div>
                            <div style="font-size: 14px;">ì‹ ìš©ì¹´ë“œ</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">ê²°ì œì¼</div>
                            <div style="font-size: 14px;">2025-11-24 15:30</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">ìƒíƒœ</div>
                            <div><span class="status-badge answered">ì™„ë£Œ</span></div>
                        </div>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="form-btn" style="background: var(--danger); color: white;" onclick="processRefund()">í™˜ë¶ˆ ì²˜ë¦¬</button>
                    <button type="button" class="form-btn form-btn-secondary" onclick="closePaymentDetail()">ë‹«ê¸°</button>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-links">
                <a href="pages/legal/terms.html" class="footer-link">ì´ìš©ì•½ê´€</a>
                <a href="pages/legal/privacy.html" class="footer-link">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a>
            </div>
            <div class="footer-copyright">
                <span>Â© 2025 SSAL Works, All Rights Reserved</span>
            </div>
            <a href="index.html" class="home-link">Home</a>
        </footer>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="spinner"></div>
        <div class="loading-text">ë¡œë”© ì¤‘...</div>
    </div>

    <script>
        // ========== Toast Notification System ==========
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;

            const icon = document.createElement('div');
            icon.className = 'toast-icon';
            icon.textContent = type === 'success' ? 'âœ…' : type === 'error' ? 'âŒ' : type === 'warning' ? 'âš ï¸' : 'â„¹ï¸';

            const messageDiv = document.createElement('div');
            messageDiv.className = 'toast-message';
            messageDiv.textContent = message;

            toast.appendChild(icon);
            toast.appendChild(messageDiv);
            document.body.appendChild(toast);

            setTimeout(() => toast.classList.add('show'), 10);
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // ========== Loading Overlay ==========
        function showLoading() {
            document.getElementById('loadingOverlay').classList.add('show');
        }

        function hideLoading() {
            document.getElementById('loadingOverlay').classList.remove('show');
        }

        // ========== XSS Protection - Sanitization ==========
        /**
         * Sanitize user input to prevent XSS attacks
         * Uses DOMPurify library to clean potentially malicious content
         * @param {string} input - User input to sanitize
         * @returns {string} - Sanitized safe HTML
         */
        function sanitizeInput(input) {
            if (!input) return '';
            // DOMPurify configuration for strict cleaning
            const config = {
                ALLOWED_TAGS: ['b', 'i', 'em', 'strong', 'u', 'br', 'p', 'ul', 'ol', 'li'],
                ALLOWED_ATTR: [],
                KEEP_CONTENT: true
            };
            return DOMPurify.sanitize(input, config);
        }

        /**
         * Sanitize plain text (removes all HTML tags)
         * @param {string} input - User input
         * @returns {string} - Plain text only
         */
        function sanitizePlainText(input) {
            if (!input) return '';
            return DOMPurify.sanitize(input, { ALLOWED_TAGS: [], KEEP_CONTENT: true });
        }

        // ========== Form Validation ==========
        function validateEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }

        function validateAmount(amount) {
            const num = parseInt(amount);
            return num >= 1000 && num <= 1000000;
        }

        function validateText(text, minLength = 3, maxLength = 200) {
            return text.length >= minLength && text.length <= maxLength;
        }

        // Show Section
        function showSection(section, event) {
            // Hide all sections
            document.querySelectorAll('.content-view').forEach(view => {
                view.style.display = 'none';
            });

            // Remove active from all menu items
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });

            // Show selected section
            const sectionElement = document.getElementById(section + '-section');
            if (sectionElement) {
                sectionElement.style.display = 'block';
            }

            // Add active to clicked menu item (if event is provided)
            if (event && event.currentTarget) {
                event.currentTarget.classList.add('active');
            }

            // ê³µì§€ì‚¬í•­ ì„¹ì…˜ì¼ ë•Œ ë°ì´í„° ë¡œë“œ
            if (section === 'notice') {
                loadNotices();
            }

            // í•™ìŠµ ì½˜í…ì¸  ì„¹ì…˜ì¼ ë•Œ ë°ì´í„° ë¡œë“œ
            if (section === 'learning') {
                loadLearningContents();
            }

            // ë§¤ë‰´ì–¼ ì„¹ì…˜ì¼ ë•Œ ë°ì´í„° ë¡œë“œ
            if (section === 'manual') {
                loadManuals();
            }

            // FAQ ì„¹ì…˜ì¼ ë•Œ ë°ì´í„° ë¡œë“œ
            if (section === 'faq') {
                loadFaqContents();
            }

            // íšŒì› ê´€ë¦¬ ì„¹ì…˜ì¼ ë•Œ ë°ì´í„° ë¡œë“œ
            if (section === 'users') {
                loadUsers();
            }

            // ì„¤ì¹˜ë¹„ ê´€ë¦¬ ì„¹ì…˜ì¼ ë•Œ ë°ì´í„° ë¡œë“œ
            if (section === 'installation') {
                loadInstallationRequests();
            }

            // í”„ë¡œì íŠ¸ ê´€ë¦¬ ì„¹ì…˜ì¼ ë•Œ ë°ì´í„° ë¡œë“œ
            if (section === 'projects') {
                loadProjects();
            }

            // ê²°ì œ ê´€ë¦¬ ì„¹ì…˜ì¼ ë•Œ ë°ì´í„° ë¡œë“œ
            if (section === 'payment') {
                loadBillingHistory();
            }

            // í¬ë ˆë”§ ê´€ë¦¬ ì„¹ì…˜ì¼ ë•Œ ë°ì´í„° ë¡œë“œ
            if (section === 'credit') {
                loadCreditData();
            }

            // ë¬¸ì˜ ê´€ë¦¬ ì„¹ì…˜ì¼ ë•Œ ë°ì´í„° ë¡œë“œ
            if (section === 'inquiries') {
                loadInquiriesData();
            }
        }

        // Logout
        function logout() {
            if (confirm('ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                window.location.href = 'index.html';
            }
        }

        // ========== Learning Content Tree Functions ==========
        function toggleTreeItem(element) {
            const parent = element.parentElement;
            const children = parent.querySelector('.tree-children');
            const arrow = element.querySelector('.tree-arrow');

            if (children) {
                if (children.style.display === 'none') {
                    children.style.display = 'block';
                    arrow.classList.add('open');
                } else {
                    children.style.display = 'none';
                    arrow.classList.remove('open');
                }
            }
        }

        // ================================================
        // í•™ìŠµì½˜í…ì¸  ëª¨ë‹¬ ê´€ë ¨ í•¨ìˆ˜ë“¤ ì œê±°ë¨ (ìë™í™” ì‹œìŠ¤í…œìœ¼ë¡œ ì „í™˜)
        // - showAddDepth1Form, closeDepth1Form, saveDepth1
        // - closeDepth2Form, saveDepth2
        // - closeDepth3Form, saveDepth3
        // - editLink, closeLinkForm, saveLink, removeLink
        // ================================================


        // í•­ëª© ìˆœì„œ ë³€ê²½
        function moveItem(direction) {
            showToast(`í•­ëª©ì´ ${direction === 'up' ? 'ìœ„ë¡œ' : 'ì•„ë˜ë¡œ'} ì´ë™ë˜ì—ˆìŠµë‹ˆë‹¤.`, 'info');
        }

        // FAQ Form Functions
        function showFaqForm() {
            document.getElementById('faqFormOverlay').style.display = 'flex';
        }

        function closeFaqForm() {
            document.getElementById('faqFormOverlay').style.display = 'none';
        }

        function saveFaq() {
            const title = document.querySelector('#faqFormOverlay .form-input').value;
            const content = document.querySelector('#faqFormOverlay .form-textarea').value;

            // ìœ íš¨ì„± ê²€ì‚¬
            if (!validateText(title, 3, 200)) {
                showToast('ì œëª©ì€ 3~200ìë¡œ ì…ë ¥í•˜ì„¸ìš”.', 'error');
                return;
            }

            if (!validateText(content, 10, 2000)) {
                showToast('ë‹µë³€ì€ 10~2000ìë¡œ ì…ë ¥í•˜ì„¸ìš”.', 'error');
                return;
            }

            // ğŸ”’ XSS Protection: Sanitize FAQ content (allow basic formatting)
            const safeTitle = sanitizePlainText(title);
            const safeContent = sanitizeInput(content); // Allow basic HTML tags

            showLoading();
            setTimeout(() => {
                hideLoading();
                showToast('FAQê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
                closeFaqForm();
                // TODO: Send safeTitle and safeContent to backend API
                console.log('Sanitized FAQ:', { title: safeTitle, content: safeContent });
            }, 800);
        }

        // Inquiry Form Functions
        function showInquiryForm() {
            document.getElementById('inquiryFormOverlay').style.display = 'flex';
        }

        function closeInquiryForm() {
            document.getElementById('inquiryFormOverlay').style.display = 'none';
        }

        function saveInquiryAnswer() {
            const answer = document.querySelector('#inquiryFormOverlay .form-textarea').value;

            // ìœ íš¨ì„± ê²€ì‚¬
            if (!validateText(answer, 10, 2000)) {
                showToast('ë‹µë³€ì€ 10~2000ìë¡œ ì…ë ¥í•˜ì„¸ìš”.', 'error');
                return;
            }

            // ğŸ”’ XSS Protection: Sanitize inquiry answer (allow basic formatting)
            const safeAnswer = sanitizeInput(answer);

            showLoading();
            setTimeout(() => {
                hideLoading();
                showToast('ë‹µë³€ì´ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
                closeInquiryForm();
                // TODO: Send safeAnswer to backend API
                console.log('Sanitized answer:', safeAnswer);
            }, 800);
        }

        // Credit Form Functions
        function showCreditForm() {
            document.getElementById('creditFormOverlay').style.display = 'flex';
        }

        function closeCreditForm() {
            document.getElementById('creditFormOverlay').style.display = 'none';
        }

        function saveCredit() {
            const email = document.querySelector('#creditFormOverlay input[type="email"]').value;
            const amount = document.querySelector('#creditFormOverlay input[type="number"]').value;
            const reason = document.querySelector('#creditFormOverlay .form-textarea').value;

            // ìœ íš¨ì„± ê²€ì‚¬
            if (!validateEmail(email)) {
                showToast('ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.', 'error');
                return;
            }

            if (!validateAmount(amount)) {
                showToast('ê¸ˆì•¡ì€ 1,000 ~ 1,000,000 ì‚¬ì´ì—¬ì•¼ í•©ë‹ˆë‹¤.', 'error');
                return;
            }

            if (!validateText(reason, 10, 500)) {
                showToast('ì‚¬ìœ ëŠ” 10~500ìë¡œ ì…ë ¥í•˜ì„¸ìš”.', 'error');
                return;
            }

            // ğŸ”’ XSS Protection: Sanitize credit transaction data
            const safeEmail = sanitizePlainText(email);
            const safeReason = sanitizePlainText(reason);

            showLoading();
            setTimeout(() => {
                hideLoading();
                showToast('í¬ë ˆë”§ì´ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
                closeCreditForm();
                // TODO: Send sanitized data to backend API
                console.log('Sanitized credit:', { email: safeEmail, amount, reason: safeReason });
            }, 800);
        }

        // User Detail Functions
        function showUserDetail() {
            document.getElementById('userDetailOverlay').style.display = 'flex';
        }

        function closeUserDetail() {
            document.getElementById('userDetailOverlay').style.display = 'none';
        }

        function saveUserStatus() {
            showLoading();
            setTimeout(() => {
                hideLoading();
                showToast('íšŒì› ìƒíƒœê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
                closeUserDetail();
            }, 800);
        }

        // Payment Detail Functions
        function showPaymentDetail() {
            document.getElementById('paymentDetailOverlay').style.display = 'flex';
        }

        function closePaymentDetail() {
            document.getElementById('paymentDetailOverlay').style.display = 'none';
        }

        function processRefund() {
            if (confirm('ì •ë§ë¡œ í™˜ë¶ˆ ì²˜ë¦¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                showLoading();
                setTimeout(() => {
                    hideLoading();
                    showToast('í™˜ë¶ˆ ì²˜ë¦¬ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
                    closePaymentDetail();
                }, 800);
            }
        }

        // ================================================================
        // Admin Home Dashboard - Chart Initialization
        // ================================================================

        // Chart.js ì°¨íŠ¸ ì´ˆê¸°í™”
        function initializeAdminHomeCharts() {
            // íšŒì› ê°€ì… ì¶”ì´ ì°¨íŠ¸ (ë¼ì¸ ì°¨íŠ¸)
            const memberSignupCtx = document.getElementById('memberSignupChart');
            if (memberSignupCtx) {
                new Chart(memberSignupCtx, {
                    type: 'line',
                    data: {
                        labels: ['11/22', '11/23', '11/24', '11/25', '11/26', '11/27', '11/28'],
                        datasets: [{
                            label: 'ì‹ ê·œ ê°€ì…',
                            data: [15, 18, 12, 22, 19, 25, 20],
                            borderColor: '#6B5CCC',
                            backgroundColor: 'rgba(107, 92, 204, 0.1)',
                            tension: 0.4,
                            fill: true,
                            pointRadius: 5,
                            pointBackgroundColor: '#6B5CCC',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2,
                            pointHoverRadius: 7
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                backgroundColor: 'rgba(0, 0, 0, 0.8)',
                                padding: 12,
                                titleFont: {
                                    size: 13,
                                    weight: 'bold'
                                },
                                bodyFont: {
                                    size: 12
                                },
                                callbacks: {
                                    label: function(context) {
                                        return 'ì‹ ê·œ ê°€ì…: ' + context.parsed.y + 'ëª…';
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    font: {
                                        size: 11
                                    },
                                    callback: function(value) {
                                        return value + 'ëª…';
                                    }
                                },
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.05)'
                                }
                            },
                            x: {
                                ticks: {
                                    font: {
                                        size: 11
                                    }
                                },
                                grid: {
                                    display: false
                                }
                            }
                        }
                    }
                });
            }

            // ë§¤ì¶œ ì¶”ì´ ì°¨íŠ¸ (ë§‰ëŒ€ ì°¨íŠ¸)
            const revenueCtx = document.getElementById('revenueChart');
            if (revenueCtx) {
                new Chart(revenueCtx, {
                    type: 'bar',
                    data: {
                        labels: ['11ì›” 1ì£¼', '11ì›” 2ì£¼', '11ì›” 3ì£¼', '11ì›” 4ì£¼'],
                        datasets: [{
                            label: 'ë§¤ì¶œ',
                            data: [1200000, 1450000, 1380000, 1650000],
                            backgroundColor: [
                                'rgba(107, 92, 204, 0.8)',
                                'rgba(107, 92, 204, 0.8)',
                                'rgba(107, 92, 204, 0.8)',
                                'rgba(204, 120, 92, 0.8)'
                            ],
                            borderColor: [
                                '#6B5CCC',
                                '#6B5CCC',
                                '#6B5CCC',
                                '#CC785C'
                            ],
                            borderWidth: 2,
                            borderRadius: 6
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                backgroundColor: 'rgba(0, 0, 0, 0.8)',
                                padding: 12,
                                titleFont: {
                                    size: 13,
                                    weight: 'bold'
                                },
                                bodyFont: {
                                    size: 12
                                },
                                callbacks: {
                                    label: function(context) {
                                        return 'ë§¤ì¶œ: â‚©' + context.parsed.y.toLocaleString();
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    font: {
                                        size: 11
                                    },
                                    callback: function(value) {
                                        return 'â‚©' + (value / 1000000).toFixed(1) + 'M';
                                    }
                                },
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.05)'
                                }
                            },
                            x: {
                                ticks: {
                                    font: {
                                        size: 11
                                    }
                                },
                                grid: {
                                    display: false
                                }
                            }
                        }
                    }
                });
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì°¨íŠ¸ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            initializeAdminHomeCharts();
        });

        // ========== Supabase ì—°ê²° ==========
        const SUPABASE_URL = 'https://zwjmfewyshhwpgwdtrus.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inp3am1mZXd5c2hod3Bnd2R0cnVzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM1NzE1NTEsImV4cCI6MjA3OTE0NzU1MX0.AJy34h5VR8QS6WFEcUcBeJJu8I3bBQ6UCk1I84Wb7y4';

        // Supabase í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™”
        let supabaseClient;

        // í˜ì´ì§€ ë¡œë“œ í›„ ì´ˆê¸°í™”
        if (typeof supabase !== 'undefined') {
            supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
            console.log('âœ… Supabase í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™” ì™„ë£Œ');
        } else {
            console.error('âŒ Supabase ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
        }

        // ========== ê³µì§€ì‚¬í•­ CRUD í•¨ìˆ˜ ==========

        /**
         * ê³µì§€ì‚¬í•­ ëª©ë¡ ë¡œë“œ
         */
        async function loadNotices() {
            console.log('ğŸ“‹ loadNotices í˜¸ì¶œë¨');
            console.log('  - Supabase Client:', supabaseClient ? 'âœ… ì´ˆê¸°í™”ë¨' : 'âŒ ì—†ìŒ');

            try {
                showLoading();

                if (!supabaseClient) {
                    throw new Error('Supabase í´ë¼ì´ì–¸íŠ¸ê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                }

                console.log('ğŸ“¤ Supabase SELECT ìš”ì²­ ì „ì†¡ ì¤‘...');

                const { data, error } = await supabaseClient
                    .from('notices')
                    .select('*')
                    .order('created_at', { ascending: false });

                console.log('ğŸ“¥ Supabase ì‘ë‹µ:', { count: data?.length, error });

                if (error) throw error;

                console.log('âœ… ê³µì§€ì‚¬í•­ ë¡œë“œ ì„±ê³µ:', data.length, 'ê°œ');
                renderNoticeTable(data);
                updateNoticeStats(data);

                hideLoading();
            } catch (error) {
                console.error('âŒ ê³µì§€ì‚¬í•­ ë¡œë“œ ì˜¤ë¥˜:', error);
                showToast('ê³µì§€ì‚¬í•­ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message, 'error');
                hideLoading();
            }
        }

        /**
         * ê³µì§€ì‚¬í•­ í…Œì´ë¸” ë Œë”ë§
         */
        function renderNoticeTable(notices) {
            const tbody = document.getElementById('noticesTableBody');
            if (!tbody) {
                console.error('noticesTableBodyë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            if (!notices || notices.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align:center; padding: 40px;">ë“±ë¡ëœ ê³µì§€ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
                return;
            }

            tbody.innerHTML = notices.map(notice => {
                const importanceBadge = notice.important
                    ? '<span class="status-badge" style="background: #dc3545; color: white;">ì¤‘ìš”</span>'
                    : '<span class="status-badge" style="background: #6c757d; color: white;">ì¼ë°˜</span>';

                const createdDate = new Date(notice.created_at).toLocaleDateString('ko-KR');
                const safeTitle = sanitizePlainText(notice.title);
                const escapedTitle = safeTitle.replace(/'/g, "\\'");

                return `
                    <tr data-notice-id="${notice.id}">
                        <td>${importanceBadge}</td>
                        <td>${safeTitle}</td>
                        <td>${createdDate}</td>
                        <td><span class="status-badge active">ê²Œì‹œì¤‘</span></td>
                        <td>-</td>
                        <td>
                            <a href="#" class="action-link" onclick="event.preventDefault(); editNotice('${notice.id}')">ìˆ˜ì •</a>
                            <a href="#" class="action-link" style="color: var(--danger);" onclick="event.preventDefault(); deleteNotice('${notice.id}', '${escapedTitle}')">ì‚­ì œ</a>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        /**
         * ê³µì§€ì‚¬í•­ í†µê³„ ì—…ë°ì´íŠ¸
         */
        function updateNoticeStats(notices) {
            const totalCount = notices.length;
            const importantCount = notices.filter(n => n.important).length;

            const totalElem = document.getElementById('noticeCountTotal');
            const publishedElem = document.getElementById('noticeCountPublished');
            const importantElem = document.getElementById('noticeCountImportant');

            if (totalElem) totalElem.textContent = totalCount;
            if (publishedElem) publishedElem.textContent = totalCount; // ê²Œì‹œì¤‘ (ì „ì²´)
            if (importantElem) importantElem.textContent = importantCount;
        }

        // í˜„ì¬ ìˆ˜ì • ì¤‘ì¸ ê³µì§€ì‚¬í•­ ID
        let currentEditingNoticeId = null;

        /**
         * ìƒˆ ê³µì§€ì‚¬í•­ ì¶”ê°€ í¼ í‘œì‹œ
         */
        function showNoticeForm() {
            console.log('ğŸ“ showNoticeForm í˜¸ì¶œë¨');

            // ëª¨ë‹¬ ì´ˆê¸°í™”
            currentEditingNoticeId = null;
            document.getElementById('noticeModalTitle').textContent = 'ğŸ“ ê³µì§€ì‚¬í•­ ì‘ì„±';
            document.getElementById('noticeTitle').value = '';
            document.getElementById('noticeContent').value = '';
            document.querySelector('input[name="importance"][value="normal"]').checked = true;

            // ëª¨ë‹¬ í‘œì‹œ
            const modal = document.getElementById('noticeModal');
            modal.style.display = 'flex';
        }

        /**
         * ê³µì§€ì‚¬í•­ ëª¨ë‹¬ ë‹«ê¸°
         */
        function closeNoticeModal() {
            document.getElementById('noticeModal').style.display = 'none';
            currentEditingNoticeId = null;
        }

        /**
         * ê³µì§€ì‚¬í•­ í¼ ì œì¶œ ì²˜ë¦¬
         */
        function handleNoticeSubmit(event) {
            event.preventDefault();

            const title = document.getElementById('noticeTitle').value.trim();
            const content = document.getElementById('noticeContent').value.trim();
            const important = document.querySelector('input[name="importance"]:checked').value === 'important';

            console.log('í¼ ì œì¶œ:', { title, content, important, editingId: currentEditingNoticeId });

            if (currentEditingNoticeId) {
                // ìˆ˜ì • ëª¨ë“œ
                updateNotice(currentEditingNoticeId, title, content, important);
            } else {
                // ìƒì„± ëª¨ë“œ
                createNotice(title, content, important);
            }

            closeNoticeModal();
        }

        /**
         * ê³µì§€ì‚¬í•­ ìƒì„±
         */
        async function createNotice(title, content, important) {
            console.log('ğŸš€ createNotice í˜¸ì¶œë¨');
            console.log('  - ì œëª©:', title);
            console.log('  - ë‚´ìš©:', content);
            console.log('  - ì¤‘ìš”:', important);
            console.log('  - Supabase Client:', supabaseClient ? 'âœ… ì´ˆê¸°í™”ë¨' : 'âŒ ì—†ìŒ');

            try {
                showLoading();

                if (!supabaseClient) {
                    throw new Error('Supabase í´ë¼ì´ì–¸íŠ¸ê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                }

                console.log('ğŸ“¤ Supabase INSERT ìš”ì²­ ì „ì†¡ ì¤‘...');

                const { data, error } = await supabaseClient
                    .from('notices')
                    .insert([
                        {
                            title: title,
                            content: content,
                            important: important
                        }
                    ])
                    .select();

                console.log('ğŸ“¥ Supabase ì‘ë‹µ:', { data, error });

                if (error) throw error;

                console.log('âœ… ê³µì§€ì‚¬í•­ ìƒì„± ì„±ê³µ:', data);
                showToast('ê³µì§€ì‚¬í•­ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                loadNotices(); // ëª©ë¡ ìƒˆë¡œê³ ì¹¨

                hideLoading();
            } catch (error) {
                console.error('âŒ ê³µì§€ì‚¬í•­ ìƒì„± ì˜¤ë¥˜:', error);
                showToast('ê³µì§€ì‚¬í•­ ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message, 'error');
                hideLoading();
            }
        }

        /**
         * ê³µì§€ì‚¬í•­ ìˆ˜ì • í¼ í‘œì‹œ
         */
        async function editNotice(noticeId) {
            console.log('âœï¸  editNotice í˜¸ì¶œë¨, ID:', noticeId);

            try {
                showLoading();

                // ê¸°ì¡´ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                const { data: existingNotice, error: fetchError } = await supabaseClient
                    .from('notices')
                    .select('*')
                    .eq('id', noticeId)
                    .single();

                if (fetchError) throw fetchError;

                console.log('ê¸°ì¡´ ë°ì´í„°:', existingNotice);

                hideLoading();

                // ëª¨ë‹¬ì— ê¸°ì¡´ ë°ì´í„° ì±„ìš°ê¸°
                currentEditingNoticeId = noticeId;
                document.getElementById('noticeModalTitle').textContent = 'âœï¸ ê³µì§€ì‚¬í•­ ìˆ˜ì •';
                document.getElementById('noticeTitle').value = existingNotice.title;
                document.getElementById('noticeContent').value = existingNotice.content;

                if (existingNotice.important) {
                    document.querySelector('input[name="importance"][value="important"]').checked = true;
                } else {
                    document.querySelector('input[name="importance"][value="normal"]').checked = true;
                }

                // ëª¨ë‹¬ í‘œì‹œ
                document.getElementById('noticeModal').style.display = 'flex';

            } catch (error) {
                console.error('âŒ ê³µì§€ì‚¬í•­ ì¡°íšŒ ì˜¤ë¥˜:', error);
                showToast('ê³µì§€ì‚¬í•­ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
                hideLoading();
            }
        }

        /**
         * ê³µì§€ì‚¬í•­ ìˆ˜ì • (ì‹¤ì œ ì—…ë°ì´íŠ¸)
         */
        async function updateNotice(noticeId, title, content, important) {
            console.log('ğŸ”„ updateNotice í˜¸ì¶œë¨');
            console.log('  - ID:', noticeId);
            console.log('  - ì œëª©:', title);
            console.log('  - ë‚´ìš©:', content);
            console.log('  - ì¤‘ìš”:', important);

            try {
                showLoading();

                const { error } = await supabaseClient
                    .from('notices')
                    .update({
                        title: title,
                        content: content,
                        important: important,
                        updated_at: new Date().toISOString()
                    })
                    .eq('id', noticeId);

                if (error) throw error;

                console.log('âœ… ê³µì§€ì‚¬í•­ ìˆ˜ì • ì„±ê³µ');
                showToast('ê³µì§€ì‚¬í•­ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                loadNotices(); // ëª©ë¡ ìƒˆë¡œê³ ì¹¨

                hideLoading();
            } catch (error) {
                console.error('âŒ ê³µì§€ì‚¬í•­ ìˆ˜ì • ì˜¤ë¥˜:', error);
                showToast('ê³µì§€ì‚¬í•­ ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message, 'error');
                hideLoading();
            }
        }

        /**
         * ê³µì§€ì‚¬í•­ ì‚­ì œ
         */
        async function deleteNotice(noticeId, title) {
            if (!confirm(`"${title}" ê³µì§€ì‚¬í•­ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nì‚­ì œëœ ë°ì´í„°ëŠ” ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`)) {
                return;
            }

            try {
                showLoading();

                const { error } = await supabaseClient
                    .from('notices')
                    .delete()
                    .eq('id', noticeId);

                if (error) throw error;

                showToast('ê³µì§€ì‚¬í•­ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                loadNotices(); // ëª©ë¡ ìƒˆë¡œê³ ì¹¨

                hideLoading();
            } catch (error) {
                console.error('ê³µì§€ì‚¬í•­ ì‚­ì œ ì˜¤ë¥˜:', error);
                showToast('ê³µì§€ì‚¬í•­ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
                hideLoading();
            }
        }

        // ================================================
        // í•™ìŠµìš© ì½˜í…ì¸  ê´€ë¦¬ ê¸°ëŠ¥
        // ================================================

        /**
         * í•™ìŠµ ì½˜í…ì¸  ë¡œë“œ
         */
        async function loadLearningContents() {
            console.log('ğŸ“š í•™ìŠµ ì½˜í…ì¸  ë¡œë“œ ì‹œì‘');

            try {
                showLoading();

                if (!supabaseClient) {
                    throw new Error('Supabase í´ë¼ì´ì–¸íŠ¸ê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                }

                const { data, error } = await supabaseClient
                    .from('learning_contents')
                    .select('*')
                    .order('depth1')
                    .order('depth2')
                    .order('display_order');

                if (error) throw error;

                console.log('âœ… í•™ìŠµ ì½˜í…ì¸  ë¡œë“œ ì„±ê³µ:', data.length, 'ê°œ');
                renderLearningTree(data);
                updateLearningStats(data);

                hideLoading();
            } catch (error) {
                console.error('âŒ í•™ìŠµ ì½˜í…ì¸  ë¡œë“œ ì˜¤ë¥˜:', error);
                showToast('í•™ìŠµ ì½˜í…ì¸ ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
                hideLoading();
            }
        }

        /**
         * í•™ìŠµ ì½˜í…ì¸  í†µê³„ ì—…ë°ì´íŠ¸
         */
        function updateLearningStats(contents) {
            const depth1Set = new Set(contents.map(c => c.depth1));
            const depth2Set = new Set(contents.filter(c => c.depth2).map(c => `${c.depth1}::${c.depth2}`));
            const depth3Count = contents.filter(c => c.depth3).length;

            const depth1Elem = document.getElementById('depth1Count');
            const depth2Elem = document.getElementById('depth2Count');
            const depth3Elem = document.getElementById('depth3Count');

            if (depth1Elem) depth1Elem.textContent = depth1Set.size;
            if (depth2Elem) depth2Elem.textContent = depth2Set.size;
            if (depth3Elem) depth3Elem.textContent = depth3Count;
        }

        /**
         * íŠ¸ë¦¬ êµ¬ì¡°ë¡œ ë Œë”ë§ (CRUD ë²„íŠ¼ í¬í•¨)
         */
        function renderLearningTree(contents) {
            const treeContainer = document.getElementById('learningContentTree');
            if (!treeContainer) return;

            // HTML ì´ìŠ¤ì¼€ì´í”„ í•¨ìˆ˜
            const escapeHtml = (text) => {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            };

            // depth1ë³„ë¡œ ê·¸ë£¹í™”
            const depth1Groups = {};
            contents.forEach(item => {
                if (!depth1Groups[item.depth1]) {
                    depth1Groups[item.depth1] = [];
                }
                depth1Groups[item.depth1].push(item);
            });

            let html = '';

            Object.keys(depth1Groups).sort().forEach(depth1Name => {
                const escapedDepth1 = depth1Name.replace(/'/g, "\\'");
                const depth1Items = depth1Groups[depth1Name];

                // depth2ë³„ë¡œ ê·¸ë£¹í™”
                const depth2Groups = {};
                depth1Items.forEach(item => {
                    if (item.depth2) {
                        if (!depth2Groups[item.depth2]) {
                            depth2Groups[item.depth2] = [];
                        }
                        depth2Groups[item.depth2].push(item);
                    }
                });

                html += `
                    <div class="tree-depth1">
                        <div class="tree-item depth1-item">
                            <span class="tree-arrow" onclick="toggleTreeItem(this.parentElement)">â–¶</span>
                            <span class="tree-icon">ğŸ“</span>
                            <span class="tree-name" onclick="toggleTreeItem(this.parentElement)">${escapeHtml(depth1Name)}</span>
                            <div class="tree-actions">
                                <button class="tree-btn add" onclick="showAddLearningDepth2Form('${escapedDepth1}')" title="ì¤‘ë¶„ë¥˜ ì¶”ê°€">+</button>
                                <button class="tree-btn edit" onclick="editLearningDepth1('${escapedDepth1}')" title="ìˆ˜ì •">âœï¸</button>
                                <button class="tree-btn delete" onclick="deleteLearningDepth1('${escapedDepth1}')" title="ì‚­ì œ">ğŸ—‘ï¸</button>
                            </div>
                        </div>
                        <div class="tree-children" style="display: none;">
                `;

                // depth2 ë Œë”ë§
                Object.keys(depth2Groups).sort().forEach(depth2Name => {
                    const escapedDepth2 = depth2Name.replace(/'/g, "\\'");
                    const depth2Items = depth2Groups[depth2Name];

                    html += `
                        <div class="tree-depth2">
                            <div class="tree-item depth2-item">
                                <span class="tree-arrow" onclick="toggleTreeItem(this.parentElement)">â–¶</span>
                                <span class="tree-icon">ğŸ“‚</span>
                                <span class="tree-name" onclick="toggleTreeItem(this.parentElement)">${escapeHtml(depth2Name)}</span>
                                <div class="tree-actions">
                                    <button class="tree-btn add" onclick="showAddLearningDepth3Form('${escapedDepth1}', '${escapedDepth2}')" title="ì†Œë¶„ë¥˜ ì¶”ê°€">+</button>
                                    <button class="tree-btn edit" onclick="editLearningDepth2('${escapedDepth1}', '${escapedDepth2}')" title="ìˆ˜ì •">âœï¸</button>
                                    <button class="tree-btn delete" onclick="deleteLearningDepth2('${escapedDepth1}', '${escapedDepth2}')" title="ì‚­ì œ">ğŸ—‘ï¸</button>
                                </div>
                            </div>
                            <div class="tree-children" style="display: none;">
                    `;

                    // depth3 ë Œë”ë§ (CRUD ë²„íŠ¼ í¬í•¨)
                    depth2Items
                        .filter(item => item.depth3)
                        .sort((a, b) => (a.display_order || 0) - (b.display_order || 0))
                        .forEach(item => {
                            // titleì´ ìˆìœ¼ë©´ title í‘œì‹œ, ì—†ìœ¼ë©´ depth3 í‘œì‹œ
                            const displayName = item.title || item.depth3;
                            const urlStatus = item.url ? `<span style="color: #28a745; font-size: 11px; margin-left: 8px;">âœ“ ì—°ê²°ë¨</span>` : `<span style="color: #dc3545; font-size: 11px; margin-left: 8px;">ë¯¸ì—°ê²°</span>`;
                            html += `
                                <div class="tree-depth3">
                                    <div class="tree-item depth3-item">
                                        <span class="tree-icon">ğŸ“„</span>
                                        <span class="tree-name">${escapeHtml(displayName)}</span>
                                        ${urlStatus}
                                        <div class="tree-actions">
                                            <button class="tree-btn edit" onclick="editLearningDepth3('${item.id}')" title="ìˆ˜ì •">âœï¸</button>
                                            <button class="tree-btn delete" onclick="deleteLearningItem('${item.id}')" title="ì‚­ì œ">ğŸ—‘ï¸</button>
                                        </div>
                                    </div>
                                </div>
                            `;
                        });

                    html += `
                            </div>
                        </div>
                    `;
                });

                html += `
                        </div>
                    </div>
                `;
            });

            treeContainer.innerHTML = html;
        }

        /**
         * íŠ¸ë¦¬ í•­ëª© í¼ì¹˜ê¸°/ì ‘ê¸°
         */
        function toggleTreeItem(element) {
            const arrow = element.querySelector('.tree-arrow');
            const children = element.parentElement.querySelector('.tree-children');

            if (children) {
                if (children.style.display === 'none') {
                    children.style.display = 'block';
                    arrow.textContent = 'â–¼';
                } else {
                    children.style.display = 'none';
                    arrow.textContent = 'â–¶';
                }
            }
        }

        // ================================================
        // í•™ìŠµì½˜í…ì¸  CRUD í•¨ìˆ˜ë“¤ (DB ë©”íƒ€ë°ì´í„° ê´€ë¦¬ìš©)
        // ================================================

        /**
         * ëŒ€ë¶„ë¥˜(Depth1) ì¶”ê°€ í¼ í‘œì‹œ
         */
        function showAddLearningDepth1Form() {
            const depth1Name = prompt('ìƒˆ ëŒ€ë¶„ë¥˜ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”:');
            if (depth1Name && depth1Name.trim()) {
                createLearningDepth1(depth1Name.trim());
            }
        }

        /**
         * ëŒ€ë¶„ë¥˜ ìƒì„±
         */
        async function createLearningDepth1(depth1Name) {
            try {
                showLoading();
                const { error } = await supabaseClient
                    .from('learning_contents')
                    .insert({
                        depth1: depth1Name,
                        depth2: null,
                        depth3: null,
                        title: null,
                        url: null,
                        display_order: 0
                    });

                if (error) throw error;

                showToast('ëŒ€ë¶„ë¥˜ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                loadLearningContents();
            } catch (error) {
                console.error('ëŒ€ë¶„ë¥˜ ì¶”ê°€ ì˜¤ë¥˜:', error);
                showToast('ëŒ€ë¶„ë¥˜ ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
            } finally {
                hideLoading();
            }
        }

        /**
         * ì¤‘ë¶„ë¥˜(Depth2) ì¶”ê°€ í¼ í‘œì‹œ
         */
        function showAddLearningDepth2Form(depth1Name) {
            const depth2Name = prompt(`[${depth1Name}]ì— ì¶”ê°€í•  ì¤‘ë¶„ë¥˜ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”:`);
            if (depth2Name && depth2Name.trim()) {
                createLearningDepth2(depth1Name, depth2Name.trim());
            }
        }

        /**
         * ì¤‘ë¶„ë¥˜ ìƒì„±
         */
        async function createLearningDepth2(depth1Name, depth2Name) {
            try {
                showLoading();
                const { error } = await supabaseClient
                    .from('learning_contents')
                    .insert({
                        depth1: depth1Name,
                        depth2: depth2Name,
                        depth3: null,
                        title: null,
                        url: null,
                        display_order: 0
                    });

                if (error) throw error;

                showToast('ì¤‘ë¶„ë¥˜ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                loadLearningContents();
            } catch (error) {
                console.error('ì¤‘ë¶„ë¥˜ ì¶”ê°€ ì˜¤ë¥˜:', error);
                showToast('ì¤‘ë¶„ë¥˜ ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
            } finally {
                hideLoading();
            }
        }

        /**
         * ì†Œë¶„ë¥˜(Depth3) ì¶”ê°€ í¼ í‘œì‹œ
         */
        function showAddLearningDepth3Form(depth1Name, depth2Name) {
            const depth3Name = prompt(`[${depth1Name} > ${depth2Name}]ì— ì¶”ê°€í•  ì†Œë¶„ë¥˜(ì½˜í…ì¸ ) ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”:`);
            if (depth3Name && depth3Name.trim()) {
                const title = prompt('ì½˜í…ì¸  ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš” (ì„ íƒ):') || null;
                const url = prompt('GitHub Raw URLì„ ì…ë ¥í•˜ì„¸ìš” (HTML íŒŒì¼ URL):');
                createLearningDepth3(depth1Name, depth2Name, depth3Name.trim(), title, url);
            }
        }

        /**
         * ì†Œë¶„ë¥˜ ìƒì„±
         */
        async function createLearningDepth3(depth1Name, depth2Name, depth3Name, title, url) {
            try {
                showLoading();
                const { error } = await supabaseClient
                    .from('learning_contents')
                    .insert({
                        depth1: depth1Name,
                        depth2: depth2Name,
                        depth3: depth3Name,
                        title: title,
                        url: url || null,
                        display_order: 0
                    });

                if (error) throw error;

                showToast('ì½˜í…ì¸ ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                loadLearningContents();
            } catch (error) {
                console.error('ì½˜í…ì¸  ì¶”ê°€ ì˜¤ë¥˜:', error);
                showToast('ì½˜í…ì¸  ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
            } finally {
                hideLoading();
            }
        }

        /**
         * ëŒ€ë¶„ë¥˜ ìˆ˜ì •
         */
        async function editLearningDepth1(oldDepth1Name) {
            const newDepth1Name = prompt('ìƒˆ ëŒ€ë¶„ë¥˜ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”:', oldDepth1Name);
            if (newDepth1Name && newDepth1Name.trim() && newDepth1Name !== oldDepth1Name) {
                try {
                    showLoading();
                    const { error } = await supabaseClient
                        .from('learning_contents')
                        .update({ depth1: newDepth1Name.trim() })
                        .eq('depth1', oldDepth1Name);

                    if (error) throw error;

                    showToast('ëŒ€ë¶„ë¥˜ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                    loadLearningContents();
                } catch (error) {
                    console.error('ëŒ€ë¶„ë¥˜ ìˆ˜ì • ì˜¤ë¥˜:', error);
                    showToast('ëŒ€ë¶„ë¥˜ ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
                } finally {
                    hideLoading();
                }
            }
        }

        /**
         * ì¤‘ë¶„ë¥˜ ìˆ˜ì •
         */
        async function editLearningDepth2(depth1Name, oldDepth2Name) {
            const newDepth2Name = prompt('ìƒˆ ì¤‘ë¶„ë¥˜ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”:', oldDepth2Name);
            if (newDepth2Name && newDepth2Name.trim() && newDepth2Name !== oldDepth2Name) {
                try {
                    showLoading();
                    const { error } = await supabaseClient
                        .from('learning_contents')
                        .update({ depth2: newDepth2Name.trim() })
                        .eq('depth1', depth1Name)
                        .eq('depth2', oldDepth2Name);

                    if (error) throw error;

                    showToast('ì¤‘ë¶„ë¥˜ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                    loadLearningContents();
                } catch (error) {
                    console.error('ì¤‘ë¶„ë¥˜ ìˆ˜ì • ì˜¤ë¥˜:', error);
                    showToast('ì¤‘ë¶„ë¥˜ ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
                } finally {
                    hideLoading();
                }
            }
        }

        /**
         * ì†Œë¶„ë¥˜(ì½˜í…ì¸ ) ìˆ˜ì •
         */
        async function editLearningDepth3(id) {
            try {
                // í˜„ì¬ ë°ì´í„° ì¡°íšŒ
                const { data, error: fetchError } = await supabaseClient
                    .from('learning_contents')
                    .select('*')
                    .eq('id', id)
                    .single();

                if (fetchError) throw fetchError;

                const newDepth3 = prompt('ì†Œë¶„ë¥˜ ì´ë¦„:', data.depth3);
                if (!newDepth3) return;

                const newTitle = prompt('ì œëª© (ì„ íƒ):', data.title || '');
                const newUrl = prompt('GitHub Raw URL:', data.url || '');
                const newOrder = prompt('í‘œì‹œ ìˆœì„œ:', data.display_order || '0');

                showLoading();
                const { error } = await supabaseClient
                    .from('learning_contents')
                    .update({
                        depth3: newDepth3.trim(),
                        title: newTitle || null,
                        url: newUrl || null,
                        display_order: parseInt(newOrder) || 0
                    })
                    .eq('id', id);

                if (error) throw error;

                showToast('ì½˜í…ì¸ ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                loadLearningContents();
            } catch (error) {
                console.error('ì½˜í…ì¸  ìˆ˜ì • ì˜¤ë¥˜:', error);
                showToast('ì½˜í…ì¸  ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
            } finally {
                hideLoading();
            }
        }

        /**
         * ëŒ€ë¶„ë¥˜ ì‚­ì œ (í•´ë‹¹ ëŒ€ë¶„ë¥˜ì˜ ëª¨ë“  í•­ëª© ì‚­ì œ)
         */
        async function deleteLearningDepth1(depth1Name) {
            if (!confirm(`"${depth1Name}" ëŒ€ë¶„ë¥˜ì™€ í•˜ìœ„ ëª¨ë“  í•­ëª©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`)) return;

            try {
                showLoading();
                const { error } = await supabaseClient
                    .from('learning_contents')
                    .delete()
                    .eq('depth1', depth1Name);

                if (error) throw error;

                showToast('ëŒ€ë¶„ë¥˜ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                loadLearningContents();
            } catch (error) {
                console.error('ëŒ€ë¶„ë¥˜ ì‚­ì œ ì˜¤ë¥˜:', error);
                showToast('ëŒ€ë¶„ë¥˜ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
            } finally {
                hideLoading();
            }
        }

        /**
         * ì¤‘ë¶„ë¥˜ ì‚­ì œ (í•´ë‹¹ ì¤‘ë¶„ë¥˜ì˜ ëª¨ë“  í•­ëª© ì‚­ì œ)
         */
        async function deleteLearningDepth2(depth1Name, depth2Name) {
            if (!confirm(`"${depth2Name}" ì¤‘ë¶„ë¥˜ì™€ í•˜ìœ„ ëª¨ë“  í•­ëª©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`)) return;

            try {
                showLoading();
                const { error } = await supabaseClient
                    .from('learning_contents')
                    .delete()
                    .eq('depth1', depth1Name)
                    .eq('depth2', depth2Name);

                if (error) throw error;

                showToast('ì¤‘ë¶„ë¥˜ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                loadLearningContents();
            } catch (error) {
                console.error('ì¤‘ë¶„ë¥˜ ì‚­ì œ ì˜¤ë¥˜:', error);
                showToast('ì¤‘ë¶„ë¥˜ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
            } finally {
                hideLoading();
            }
        }

        /**
         * ê°œë³„ í•­ëª© ì‚­ì œ
         */
        async function deleteLearningItem(id) {
            if (!confirm('ì´ í•­ëª©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

            try {
                showLoading();
                const { error } = await supabaseClient
                    .from('learning_contents')
                    .delete()
                    .eq('id', id);

                if (error) throw error;

                showToast('í•­ëª©ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                loadLearningContents();
            } catch (error) {
                console.error('í•­ëª© ì‚­ì œ ì˜¤ë¥˜:', error);
                showToast('í•­ëª© ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
            } finally {
                hideLoading();
            }
        }

        // ================================================
        // ë§¤ë‰´ì–¼ ê´€ë¦¬ í•¨ìˆ˜ë“¤
        // ================================================

        /**
         * ë§¤ë‰´ì–¼ ë°ì´í„° ë¡œë“œ
         */
        async function loadManuals() {
            console.log('ğŸ“– ë§¤ë‰´ì–¼ ë¡œë“œ ì‹œì‘');

            try {
                showLoading();

                if (!supabaseClient) {
                    throw new Error('Supabase í´ë¼ì´ì–¸íŠ¸ê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                }

                const { data, error } = await supabaseClient
                    .from('manuals')
                    .select('*')
                    .order('category')
                    .order('display_order');

                if (error) throw error;

                console.log('âœ… ë§¤ë‰´ì–¼ ë¡œë“œ ì„±ê³µ:', data.length, 'ê°œ');
                renderManualsTable(data);
                updateManualStats(data);

                hideLoading();
            } catch (error) {
                console.error('âŒ ë§¤ë‰´ì–¼ ë¡œë“œ ì˜¤ë¥˜:', error);
                // í…Œì´ë¸”ì´ ì—†ì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë¹ˆ í…Œì´ë¸” í‘œì‹œ
                renderManualsTable([]);
                updateManualStats([]);
                showToast('ë§¤ë‰´ì–¼ í…Œì´ë¸”ì´ ì•„ì§ ìƒì„±ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.', 'warning');
                hideLoading();
            }
        }

        /**
         * ë§¤ë‰´ì–¼ í†µê³„ ì—…ë°ì´íŠ¸
         */
        function updateManualStats(manuals) {
            const categories = new Set(manuals.map(m => m.category));
            const activeCount = manuals.filter(m => m.is_active !== false).length;

            const categoryElem = document.getElementById('manualCategoryCount');
            const totalElem = document.getElementById('manualTotalCount');
            const activeElem = document.getElementById('manualActiveCount');

            if (categoryElem) categoryElem.textContent = categories.size;
            if (totalElem) totalElem.textContent = manuals.length;
            if (activeElem) activeElem.textContent = activeCount;
        }

        /**
         * ë§¤ë‰´ì–¼ í…Œì´ë¸” ë Œë”ë§
         */
        function renderManualsTable(manuals) {
            const tbody = document.getElementById('manualTableBody');
            if (!tbody) return;

            if (manuals.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="6" style="text-align:center; padding: 40px; color: #999;">
                            ë“±ë¡ëœ ë§¤ë‰´ì–¼ì´ ì—†ìŠµë‹ˆë‹¤. '+ ë§¤ë‰´ì–¼ ì¶”ê°€' ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ì¶”ê°€í•˜ì„¸ìš”.
                        </td>
                    </tr>
                `;
                return;
            }

            const escapeHtml = (text) => {
                if (!text) return '';
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            };

            let html = '';
            manuals.forEach(manual => {
                const statusBadge = manual.is_active !== false
                    ? '<span style="background: #28a745; color: white; padding: 2px 8px; border-radius: 12px; font-size: 11px;">í™œì„±</span>'
                    : '<span style="background: #6c757d; color: white; padding: 2px 8px; border-radius: 12px; font-size: 11px;">ë¹„í™œì„±</span>';

                html += `
                    <tr>
                        <td style="text-align: center;">${manual.display_order || 0}</td>
                        <td>${escapeHtml(manual.category)}</td>
                        <td>${escapeHtml(manual.subcategory) || '-'}</td>
                        <td>
                            <div style="font-weight: 500;">${escapeHtml(manual.title)}</div>
                            ${manual.description ? `<div style="font-size: 12px; color: #666; margin-top: 4px;">${escapeHtml(manual.description)}</div>` : ''}
                            ${manual.url ? `<div style="font-size: 11px; color: #28a745; margin-top: 4px;">âœ“ URL ì—°ê²°ë¨</div>` : '<div style="font-size: 11px; color: #dc3545; margin-top: 4px;">URL ë¯¸ì—°ê²°</div>'}
                        </td>
                        <td style="text-align: center;">${statusBadge}</td>
                        <td style="text-align: center;">
                            <button onclick="editManual('${manual.id}')" style="background: #007bff; color: white; border: none; padding: 4px 8px; border-radius: 4px; cursor: pointer; margin-right: 4px;" title="ìˆ˜ì •">âœï¸</button>
                            <button onclick="toggleManualStatus('${manual.id}', ${manual.is_active !== false})" style="background: #6c757d; color: white; border: none; padding: 4px 8px; border-radius: 4px; cursor: pointer; margin-right: 4px;" title="í™œì„±/ë¹„í™œì„± ì „í™˜">ğŸ”„</button>
                            <button onclick="deleteManual('${manual.id}')" style="background: #dc3545; color: white; border: none; padding: 4px 8px; border-radius: 4px; cursor: pointer;" title="ì‚­ì œ">ğŸ—‘ï¸</button>
                        </td>
                    </tr>
                `;
            });

            tbody.innerHTML = html;
        }

        /**
         * ë§¤ë‰´ì–¼ ì¶”ê°€ í¼ í‘œì‹œ
         */
        function showAddManualForm() {
            const category = prompt('ì¹´í…Œê³ ë¦¬ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: ì‹œì‘í•˜ê¸°, í”„ë¡œì íŠ¸ ê´€ë¦¬):');
            if (!category || !category.trim()) return;

            const subcategory = prompt('í•˜ìœ„ ì¹´í…Œê³ ë¦¬ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì„ íƒ, ì—†ìœ¼ë©´ ë¹ˆì¹¸):');
            const title = prompt('ë§¤ë‰´ì–¼ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”:');
            if (!title || !title.trim()) {
                showToast('ì œëª©ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.', 'error');
                return;
            }

            const description = prompt('ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš” (ì„ íƒ):');
            const url = prompt('GitHub Raw URLì„ ì…ë ¥í•˜ì„¸ìš” (HTML íŒŒì¼ URL):');
            const displayOrder = prompt('í‘œì‹œ ìˆœì„œë¥¼ ì…ë ¥í•˜ì„¸ìš” (ê¸°ë³¸ê°’: 0):', '0');

            createManual({
                category: category.trim(),
                subcategory: subcategory ? subcategory.trim() : null,
                title: title.trim(),
                description: description ? description.trim() : null,
                url: url ? url.trim() : null,
                display_order: parseInt(displayOrder) || 0,
                is_active: true
            });
        }

        /**
         * ë§¤ë‰´ì–¼ ìƒì„±
         */
        async function createManual(manualData) {
            try {
                showLoading();
                const { error } = await supabaseClient
                    .from('manuals')
                    .insert(manualData);

                if (error) throw error;

                showToast('ë§¤ë‰´ì–¼ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                loadManuals();
            } catch (error) {
                console.error('ë§¤ë‰´ì–¼ ì¶”ê°€ ì˜¤ë¥˜:', error);
                showToast('ë§¤ë‰´ì–¼ ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. í…Œì´ë¸”ì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.', 'error');
            } finally {
                hideLoading();
            }
        }

        /**
         * ë§¤ë‰´ì–¼ ìˆ˜ì •
         */
        async function editManual(id) {
            try {
                // í˜„ì¬ ë°ì´í„° ì¡°íšŒ
                const { data, error: fetchError } = await supabaseClient
                    .from('manuals')
                    .select('*')
                    .eq('id', id)
                    .single();

                if (fetchError) throw fetchError;

                const category = prompt('ì¹´í…Œê³ ë¦¬:', data.category);
                if (!category) return;

                const subcategory = prompt('í•˜ìœ„ ì¹´í…Œê³ ë¦¬ (ì—†ìœ¼ë©´ ë¹ˆì¹¸):', data.subcategory || '');
                const title = prompt('ì œëª©:', data.title);
                if (!title) {
                    showToast('ì œëª©ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.', 'error');
                    return;
                }

                const description = prompt('ì„¤ëª…:', data.description || '');
                const url = prompt('GitHub Raw URL:', data.url || '');
                const displayOrder = prompt('í‘œì‹œ ìˆœì„œ:', data.display_order || '0');

                showLoading();
                const { error } = await supabaseClient
                    .from('manuals')
                    .update({
                        category: category.trim(),
                        subcategory: subcategory ? subcategory.trim() : null,
                        title: title.trim(),
                        description: description ? description.trim() : null,
                        url: url ? url.trim() : null,
                        display_order: parseInt(displayOrder) || 0
                    })
                    .eq('id', id);

                if (error) throw error;

                showToast('ë§¤ë‰´ì–¼ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                loadManuals();
            } catch (error) {
                console.error('ë§¤ë‰´ì–¼ ìˆ˜ì • ì˜¤ë¥˜:', error);
                showToast('ë§¤ë‰´ì–¼ ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
            } finally {
                hideLoading();
            }
        }

        /**
         * ë§¤ë‰´ì–¼ í™œì„±/ë¹„í™œì„± ì „í™˜
         */
        async function toggleManualStatus(id, currentStatus) {
            try {
                showLoading();
                const { error } = await supabaseClient
                    .from('manuals')
                    .update({ is_active: !currentStatus })
                    .eq('id', id);

                if (error) throw error;

                showToast(`ë§¤ë‰´ì–¼ì´ ${!currentStatus ? 'í™œì„±í™”' : 'ë¹„í™œì„±í™”'}ë˜ì—ˆìŠµë‹ˆë‹¤.`, 'success');
                loadManuals();
            } catch (error) {
                console.error('ë§¤ë‰´ì–¼ ìƒíƒœ ë³€ê²½ ì˜¤ë¥˜:', error);
                showToast('ë§¤ë‰´ì–¼ ìƒíƒœ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
            } finally {
                hideLoading();
            }
        }

        /**
         * ë§¤ë‰´ì–¼ ì‚­ì œ
         */
        async function deleteManual(id) {
            if (!confirm('ì´ ë§¤ë‰´ì–¼ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) return;

            try {
                showLoading();
                const { error } = await supabaseClient
                    .from('manuals')
                    .delete()
                    .eq('id', id);

                if (error) throw error;

                showToast('ë§¤ë‰´ì–¼ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                loadManuals();
            } catch (error) {
                console.error('ë§¤ë‰´ì–¼ ì‚­ì œ ì˜¤ë¥˜:', error);
                showToast('ë§¤ë‰´ì–¼ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
            } finally {
                hideLoading();
            }
        }

        // ==========================================================================
        // FAQ ê´€ë¦¬ í•¨ìˆ˜ë“¤ (Agenda #3) - í•™ìŠµìš© ì½˜í…ì¸ ì™€ ë™ì¼í•œ 3ë‹¨ê³„ êµ¬ì¡°
        // ==========================================================================

        /**
         * FAQ ë°ì´í„° ë¡œë“œ ë° íŠ¸ë¦¬ ë Œë”ë§
         */
        async function loadFaqContents() {
            console.log('ğŸ“‹ FAQ ì½˜í…ì¸  ë¡œë“œ ì‹œì‘');

            try {
                const { data, error } = await supabaseClient
                    .from('faqs')
                    .select('*')
                    .order('depth1', { ascending: true })
                    .order('depth2', { ascending: true })
                    .order('depth3', { ascending: true });

                if (error) throw error;

                console.log(`âœ… FAQ ë¡œë“œ ì„±ê³µ: ${data.length}ê°œ`);

                // í†µê³„ ì—…ë°ì´íŠ¸
                const depth1Set = new Set(data.map(item => item.depth1));
                const depth2Set = new Set(data.map(item => item.depth1 + '|' + item.depth2));

                document.getElementById('faqDepth1Count').textContent = depth1Set.size;
                document.getElementById('faqDepth2Count').textContent = depth2Set.size;
                document.getElementById('faqDepth3Count').textContent = data.length;

                // íŠ¸ë¦¬ ë Œë”ë§
                renderFaqTree(data);

            } catch (error) {
                console.error('âŒ FAQ ë¡œë“œ ì˜¤ë¥˜:', error);
                showToast('FAQ ë¡œë“œ ì‹¤íŒ¨: ' + error.message, 'error');
                document.getElementById('faqTree').innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #dc3545;">
                        âŒ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨: ${error.message}
                    </div>
                `;
            }
        }

        /**
         * FAQ íŠ¸ë¦¬ ë Œë”ë§ (í•™ìŠµìš© ì½˜í…ì¸ ì™€ ë™ì¼)
         */
        function renderFaqTree(data) {
            const tree = {};

            // HTML ì´ìŠ¤ì¼€ì´í”„ í•¨ìˆ˜
            const escapeHtml = (text) => {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            };

            // ë°ì´í„°ë¥¼ íŠ¸ë¦¬ êµ¬ì¡°ë¡œ ë³€í™˜
            data.forEach(item => {
                if (!tree[item.depth1]) tree[item.depth1] = {};
                if (!tree[item.depth1][item.depth2]) tree[item.depth1][item.depth2] = [];
                tree[item.depth1][item.depth2].push(item);
            });

            let html = '';

            Object.keys(tree).forEach(depth1 => {
                const escapedD1 = depth1.replace(/'/g, "\\'");
                html += `
                    <div class="tree-depth1">
                        <div class="tree-item depth1-item" onclick="toggleTreeItem(this)">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon">ğŸ“</span>
                            <span class="tree-name">${escapeHtml(depth1)}</span>
                            <div class="tree-actions">
                                <button class="tree-btn edit" onclick="event.stopPropagation(); editFaqDepth1('${escapedD1}')">ìˆ˜ì •</button>
                                <button class="tree-btn delete" onclick="event.stopPropagation(); deleteFaqDepth1('${escapedD1}')">ì‚­ì œ</button>
                                <button class="tree-btn add" onclick="event.stopPropagation(); showAddFaqDepth2Form('${escapedD1}')">ì¤‘ë¶„ë¥˜ ì¶”ê°€</button>
                            </div>
                        </div>
                        <div class="tree-children" style="display: none;">
                `;

                Object.keys(tree[depth1]).forEach(depth2 => {
                    const escapedD2 = depth2.replace(/'/g, "\\'");
                    html += `
                        <div class="tree-depth2">
                            <div class="tree-item depth2-item" onclick="toggleTreeItem(this)">
                                <span class="tree-arrow">â–¶</span>
                                <span class="tree-icon">ğŸ“‚</span>
                                <span class="tree-name">${escapeHtml(depth2)}</span>
                                <div class="tree-actions">
                                    <button class="tree-btn edit" onclick="event.stopPropagation(); editFaqDepth2('${escapedD1}', '${escapedD2}')">ìˆ˜ì •</button>
                                    <button class="tree-btn delete" onclick="event.stopPropagation(); deleteFaqDepth2('${escapedD1}', '${escapedD2}')">ì‚­ì œ</button>
                                    <button class="tree-btn add" onclick="event.stopPropagation(); showAddFaqDepth3Form('${escapedD1}', '${escapedD2}')">ì†Œë¶„ë¥˜ ì¶”ê°€</button>
                                </div>
                            </div>
                            <div class="tree-children" style="display: none;">
                    `;

                    tree[depth1][depth2].forEach(item => {
                        const escapedD3 = item.depth3.replace(/'/g, "\\'");
                        html += `
                            <div class="tree-depth3">
                                <div class="tree-item depth3-item">
                                    <span class="tree-icon">ğŸ“„</span>
                                    <span class="tree-name">${escapeHtml(item.depth3)}</span>
                                    <span class="tree-link-status linked">ğŸ’¬ ë‹µë³€</span>
                                    <div class="tree-actions">
                                        <button class="tree-btn edit" onclick="editFaqDepth3('${item.id}')">ìˆ˜ì •</button>
                                        <button class="tree-btn delete" onclick="deleteFaqDepth3('${item.id}', '${escapedD3}')">ì‚­ì œ</button>
                                    </div>
                                </div>
                            </div>
                        `;
                    });

                    html += `
                            </div>
                        </div>
                    `;
                });

                html += `
                        </div>
                    </div>
                `;
            });

            document.getElementById('faqTree').innerHTML = html;
        }

        // FAQ Depth1 ê´€ë¦¬ í•¨ìˆ˜ë“¤
        function showAddFaqDepth1Form() {
            document.getElementById('faqDepth1Title').value = '';
            document.getElementById('faqDepth1FormOverlay').style.display = 'flex';
        }

        function closeFaqDepth1Form() {
            document.getElementById('faqDepth1FormOverlay').style.display = 'none';
        }

        async function saveFaqDepth1() {
            const title = document.getElementById('faqDepth1Title').value.trim();
            if (!title) return;

            try {
                showLoading();
                // ì²« ë²ˆì§¸ í•­ëª©ìœ¼ë¡œ ì„ì‹œ depth2, depth3 ìƒì„±
                const { error } = await supabaseClient
                    .from('faqs')
                    .insert({
                        depth1: title,
                        depth2: 'ì„ì‹œ ì¤‘ë¶„ë¥˜',
                        depth3: 'ì„ì‹œ ì†Œë¶„ë¥˜',
                        answer: 'ì„ì‹œ ë‹µë³€ì…ë‹ˆë‹¤. ìˆ˜ì •í•´ì£¼ì„¸ìš”.'
                    });

                if (error) throw error;

                showToast('ëŒ€ë¶„ë¥˜ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                closeFaqDepth1Form();
                loadFaqContents();
                hideLoading();
            } catch (error) {
                console.error('âŒ ì¶”ê°€ ì˜¤ë¥˜:', error);
                showToast('ì¶”ê°€ ì‹¤íŒ¨: ' + error.message, 'error');
                hideLoading();
            }
        }

        // FAQ Depth2 ê´€ë¦¬ í•¨ìˆ˜ë“¤
        function showAddFaqDepth2Form(depth1) {
            document.getElementById('faqDepth2Parent').value = depth1;
            document.getElementById('faqDepth2Title').value = '';
            document.getElementById('faqDepth2FormOverlay').style.display = 'flex';
        }

        function closeFaqDepth2Form() {
            document.getElementById('faqDepth2FormOverlay').style.display = 'none';
        }

        async function saveFaqDepth2() {
            const depth1 = document.getElementById('faqDepth2Parent').value;
            const depth2 = document.getElementById('faqDepth2Title').value.trim();
            if (!depth2) return;

            try {
                showLoading();
                const { error } = await supabaseClient
                    .from('faqs')
                    .insert({
                        depth1: depth1,
                        depth2: depth2,
                        depth3: 'ì„ì‹œ ì†Œë¶„ë¥˜',
                        answer: 'ì„ì‹œ ë‹µë³€ì…ë‹ˆë‹¤. ìˆ˜ì •í•´ì£¼ì„¸ìš”.'
                    });

                if (error) throw error;

                showToast('ì¤‘ë¶„ë¥˜ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                closeFaqDepth2Form();
                loadFaqContents();
                hideLoading();
            } catch (error) {
                console.error('âŒ ì¶”ê°€ ì˜¤ë¥˜:', error);
                showToast('ì¶”ê°€ ì‹¤íŒ¨: ' + error.message, 'error');
                hideLoading();
            }
        }

        // FAQ Depth3 ê´€ë¦¬ í•¨ìˆ˜ë“¤
        function showAddFaqDepth3Form(depth1, depth2) {
            document.getElementById('faqDepth3Depth1').value = depth1;
            document.getElementById('faqDepth3Depth2').value = depth2;
            document.getElementById('faqDepth3Title').value = '';
            document.getElementById('faqAnswer').value = '';
            document.getElementById('faqDescription').value = '';
            document.getElementById('faqDepth3FormOverlay').style.display = 'flex';
        }

        function closeFaqDepth3Form() {
            document.getElementById('faqDepth3FormOverlay').style.display = 'none';
        }

        async function saveFaqDepth3() {
            const depth1 = document.getElementById('faqDepth3Depth1').value;
            const depth2 = document.getElementById('faqDepth3Depth2').value;
            const depth3 = document.getElementById('faqDepth3Title').value.trim();
            const answer = document.getElementById('faqAnswer').value.trim();
            const description = document.getElementById('faqDescription').value.trim();

            if (!depth3 || !answer) {
                showToast('ì§ˆë¬¸ê³¼ ë‹µë³€ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
                return;
            }

            try {
                showLoading();
                const sanitizedAnswer = DOMPurify.sanitize(answer);

                const { error } = await supabaseClient
                    .from('faqs')
                    .insert({
                        depth1: depth1,
                        depth2: depth2,
                        depth3: depth3,
                        answer: sanitizedAnswer,
                        description: description || null
                    });

                if (error) throw error;

                showToast('FAQê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                closeFaqDepth3Form();
                loadFaqContents();
                hideLoading();
            } catch (error) {
                console.error('âŒ ì¶”ê°€ ì˜¤ë¥˜:', error);
                showToast('ì¶”ê°€ ì‹¤íŒ¨: ' + error.message, 'error');
                hideLoading();
            }
        }

        async function editFaqDepth3(itemId) {
            try {
                showLoading();
                const { data, error } = await supabaseClient
                    .from('faqs')
                    .select('*')
                    .eq('id', itemId)
                    .single();

                if (error) throw error;
                hideLoading();

                document.getElementById('faqDepth3Depth1').value = data.depth1;
                document.getElementById('faqDepth3Depth2').value = data.depth2;
                document.getElementById('faqDepth3Title').value = data.depth3;
                document.getElementById('faqAnswer').value = data.answer;
                document.getElementById('faqDescription').value = data.description || '';

                // ìˆ˜ì • ëª¨ë“œë¡œ ì €ì¥
                window.currentFaqEditId = itemId;
                document.getElementById('faqDepth3FormOverlay').style.display = 'flex';

            } catch (error) {
                console.error('âŒ ì¡°íšŒ ì˜¤ë¥˜:', error);
                showToast('ì¡°íšŒ ì‹¤íŒ¨: ' + error.message, 'error');
                hideLoading();
            }
        }

        async function deleteFaqDepth3(itemId, title) {
            if (!confirm(`"${title}"ì„(ë¥¼) ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) return;

            try {
                showLoading();
                const { error } = await supabaseClient
                    .from('faqs')
                    .delete()
                    .eq('id', itemId);

                if (error) throw error;

                showToast('FAQê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                loadFaqContents();
                hideLoading();
            } catch (error) {
                console.error('âŒ ì‚­ì œ ì˜¤ë¥˜:', error);
                showToast('ì‚­ì œ ì‹¤íŒ¨: ' + error.message, 'error');
                hideLoading();
            }
        }

        /**
         * FAQ depth1 ìˆ˜ì •
         */
        async function editFaqDepth1(oldName) {
            const newName = prompt(`ëŒ€ë¶„ë¥˜ ì´ë¦„ì„ ìˆ˜ì •í•˜ì„¸ìš”:`, oldName);
            if (!newName || !newName.trim() || newName === oldName) return;

            try {
                showLoading();

                // í•´ë‹¹ depth1ì„ ê°€ì§„ ëª¨ë“  FAQ ì—…ë°ì´íŠ¸
                const { error } = await supabaseClient
                    .from('faqs')
                    .update({ depth1: newName.trim() })
                    .eq('depth1', oldName);

                if (error) throw error;

                showToast('ëŒ€ë¶„ë¥˜ ì´ë¦„ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                loadFaqContents();

                hideLoading();
            } catch (error) {
                console.error('âŒ ìˆ˜ì • ì˜¤ë¥˜:', error);
                showToast('ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message, 'error');
                hideLoading();
            }
        }

        /**
         * FAQ depth2 ìˆ˜ì •
         */
        async function editFaqDepth2(depth1, oldName) {
            const newName = prompt(`ì¤‘ë¶„ë¥˜ ì´ë¦„ì„ ìˆ˜ì •í•˜ì„¸ìš”:`, oldName);
            if (!newName || !newName.trim() || newName === oldName) return;

            try {
                showLoading();

                const { error } = await supabaseClient
                    .from('faqs')
                    .update({ depth2: newName.trim() })
                    .eq('depth1', depth1)
                    .eq('depth2', oldName);

                if (error) throw error;

                showToast('ì¤‘ë¶„ë¥˜ ì´ë¦„ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                loadFaqContents();

                hideLoading();
            } catch (error) {
                console.error('âŒ ìˆ˜ì • ì˜¤ë¥˜:', error);
                showToast('ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message, 'error');
                hideLoading();
            }
        }

        /**
         * FAQ depth1 ì‚­ì œ (ëª¨ë“  í•˜ìœ„ í•­ëª© í¬í•¨)
         */
        async function deleteFaqDepth1(depth1) {
            const confirmMessage = `"${depth1}"ì„(ë¥¼) ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nâš ï¸ ê²½ê³ : ëª¨ë“  í•˜ìœ„ ì¤‘ë¶„ë¥˜ ë° ì†Œë¶„ë¥˜(FAQ)ë„ í•¨ê»˜ ì‚­ì œë©ë‹ˆë‹¤!\n\nì‚­ì œëœ ë°ì´í„°ëŠ” ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`;

            if (!confirm(confirmMessage)) return;

            try {
                showLoading();

                const { error } = await supabaseClient
                    .from('faqs')
                    .delete()
                    .eq('depth1', depth1);

                if (error) throw error;

                showToast('ëŒ€ë¶„ë¥˜ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                loadFaqContents();

                hideLoading();
            } catch (error) {
                console.error('âŒ ì‚­ì œ ì˜¤ë¥˜:', error);
                showToast('ì‚­ì œ ì‹¤íŒ¨: ' + error.message, 'error');
                hideLoading();
            }
        }

        /**
         * FAQ depth2 ì‚­ì œ (ëª¨ë“  í•˜ìœ„ FAQ í¬í•¨)
         */
        async function deleteFaqDepth2(depth1, depth2) {
            const confirmMessage = `"${depth1} > ${depth2}"ì„(ë¥¼) ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nâš ï¸ ê²½ê³ : ëª¨ë“  í•˜ìœ„ ì†Œë¶„ë¥˜(FAQ)ë„ í•¨ê»˜ ì‚­ì œë©ë‹ˆë‹¤!\n\nì‚­ì œëœ ë°ì´í„°ëŠ” ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`;

            if (!confirm(confirmMessage)) return;

            try {
                showLoading();

                const { error } = await supabaseClient
                    .from('faqs')
                    .delete()
                    .eq('depth1', depth1)
                    .eq('depth2', depth2);

                if (error) throw error;

                showToast('ì¤‘ë¶„ë¥˜ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                loadFaqContents();

                hideLoading();
            } catch (error) {
                console.error('âŒ ì‚­ì œ ì˜¤ë¥˜:', error);
                showToast('ì‚­ì œ ì‹¤íŒ¨: ' + error.message, 'error');
                hideLoading();
            }
        }

        // ==========================================================================
        // íšŒì› ê´€ë¦¬ CRUD í•¨ìˆ˜ (Agenda #4)
        // ==========================================================================

        // ì „ì²´ íšŒì› ë°ì´í„° ìºì‹œ
        let allUsersData = [];

        /**
         * íšŒì› ëª©ë¡ ë¡œë“œ
         */
        async function loadUsers() {
            console.log('ğŸ“‹ loadUsers í˜¸ì¶œë¨');

            try {
                showLoading();

                if (!supabaseClient) {
                    throw new Error('Supabase í´ë¼ì´ì–¸íŠ¸ê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                }

                console.log('ğŸ“¤ Supabase SELECT ìš”ì²­ ì „ì†¡ ì¤‘ (users í…Œì´ë¸”)...');

                const { data, error } = await supabaseClient
                    .from('users')
                    .select('*')
                    .order('created_at', { ascending: false });

                console.log('ğŸ“¥ Supabase ì‘ë‹µ:', { count: data?.length, error });

                if (error) throw error;

                console.log('âœ… íšŒì› ëª©ë¡ ë¡œë“œ ì„±ê³µ:', data.length, 'ëª…');
                allUsersData = data;
                renderUsersTable(data);
                updateUserStats(data);

                hideLoading();
            } catch (error) {
                console.error('âŒ íšŒì› ëª©ë¡ ë¡œë“œ ì˜¤ë¥˜:', error);
                showToast('íšŒì› ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message, 'error');

                const tbody = document.getElementById('usersTableBody');
                if (tbody) {
                    tbody.innerHTML = `<tr><td colspan="8" style="text-align:center; padding: 40px; color: #dc3545;">âŒ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨: ${error.message}</td></tr>`;
                }

                hideLoading();
            }
        }

        /**
         * íšŒì› í…Œì´ë¸” ë Œë”ë§
         */
        function renderUsersTable(users) {
            const tbody = document.getElementById('usersTableBody');
            if (!tbody) {
                console.error('usersTableBodyë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            if (!users || users.length === 0) {
                tbody.innerHTML = '<tr><td colspan="8" style="text-align:center; padding: 40px;">ë“±ë¡ëœ íšŒì›ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
                return;
            }

            tbody.innerHTML = users.map(user => {
                // í”Œëœ ë±ƒì§€
                const planBadge = getPlanBadge(user.subscription_plan);

                // ìƒíƒœ ë±ƒì§€
                const statusBadge = getStatusBadge(user.subscription_status);

                // ê°€ì…ì¼ í¬ë§·
                const createdDate = user.created_at
                    ? new Date(user.created_at).toLocaleDateString('ko-KR')
                    : '-';

                // í¬ë ˆë”§ í¬ë§·
                const creditDisplay = user.credit_balance
                    ? user.credit_balance.toLocaleString()
                    : '0';

                // ë‹‰ë„¤ì„ (ì—†ìœ¼ë©´ ì´ë©”ì¼ ì•ë¶€ë¶„)
                const displayName = user.nickname || user.real_name || (user.email ? user.email.split('@')[0] : '-');
                const safeDisplayName = sanitizePlainText(displayName);

                // íšŒì› ID
                const userId = user.user_id || '-';

                return `
                    <tr data-user-id="${user.id}">
                        <td><code style="background: #f8f9fa; padding: 2px 6px; border-radius: 4px;">${userId}</code></td>
                        <td>${sanitizePlainText(user.email || '-')}</td>
                        <td>${safeDisplayName}</td>
                        <td>${planBadge}</td>
                        <td>${statusBadge}</td>
                        <td style="text-align: right; font-weight: 500;">${creditDisplay}</td>
                        <td>${createdDate}</td>
                        <td>
                            <a href="#" class="action-link" onclick="event.preventDefault(); showUserDetailById('${user.id}')">ìƒì„¸</a>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        /**
         * í”Œëœ ë±ƒì§€ ìƒì„±
         */
        function getPlanBadge(plan) {
            const planStyles = {
                'premium': { bg: '#ffd700', color: '#000', text: 'Premium' },
                'pro': { bg: '#6B5CCC', color: '#fff', text: 'Pro' },
                'basic': { bg: '#d4edda', color: '#155724', text: 'Basic' },
                'free': { bg: '#e0e0e0', color: '#555', text: 'Free' }
            };

            const style = planStyles[plan?.toLowerCase()] || planStyles['free'];
            return `<span class="status-badge" style="background: ${style.bg}; color: ${style.color};">${style.text}</span>`;
        }

        /**
         * ìƒíƒœ ë±ƒì§€ ìƒì„±
         */
        function getStatusBadge(status) {
            const statusStyles = {
                'active': { class: 'active', text: 'í™œì„±' },
                'inactive': { class: '', style: 'background: #6c757d; color: white;', text: 'ë¹„í™œì„±' },
                'suspended': { class: 'pending', text: 'ì •ì§€' },
                'pending': { class: '', style: 'background: #ffc107; color: #000;', text: 'ëŒ€ê¸°' }
            };

            const style = statusStyles[status?.toLowerCase()] || statusStyles['inactive'];

            if (style.class) {
                return `<span class="status-badge ${style.class}">${style.text}</span>`;
            } else {
                return `<span class="status-badge" style="${style.style}">${style.text}</span>`;
            }
        }

        /**
         * íšŒì› í†µê³„ ì—…ë°ì´íŠ¸
         */
        function updateUserStats(users) {
            const totalCount = users.length;
            const activeCount = users.filter(u => u.subscription_status === 'active').length;
            const paidCount = users.filter(u => u.installation_fee_paid === true).length;
            const totalCredits = users.reduce((sum, u) => sum + (u.credit_balance || 0), 0);

            const totalElem = document.getElementById('totalUsersCount');
            const activeElem = document.getElementById('activeUsersCount');
            const paidElem = document.getElementById('paidUsersCount');
            const creditsElem = document.getElementById('totalCreditsCount');

            if (totalElem) totalElem.textContent = totalCount;
            if (activeElem) activeElem.textContent = activeCount;
            if (paidElem) paidElem.textContent = paidCount;
            if (creditsElem) creditsElem.textContent = totalCredits.toLocaleString();
        }

        /**
         * íšŒì› ê²€ìƒ‰
         */
        function searchUsers() {
            const searchInput = document.getElementById('userSearchInput');
            const searchTerm = searchInput ? searchInput.value.trim().toLowerCase() : '';

            if (!searchTerm) {
                // ê²€ìƒ‰ì–´ê°€ ì—†ìœ¼ë©´ ì „ì²´ ëª©ë¡ í‘œì‹œ
                renderUsersTable(allUsersData);
                return;
            }

            // ì´ë©”ì¼ ë˜ëŠ” ë‹‰ë„¤ì„ìœ¼ë¡œ í•„í„°ë§
            const filtered = allUsersData.filter(user => {
                const email = (user.email || '').toLowerCase();
                const nickname = (user.nickname || '').toLowerCase();
                const realName = (user.real_name || '').toLowerCase();
                const userId = (user.user_id || '').toLowerCase();

                return email.includes(searchTerm) ||
                       nickname.includes(searchTerm) ||
                       realName.includes(searchTerm) ||
                       userId.includes(searchTerm);
            });

            console.log(`ğŸ” ê²€ìƒ‰ ê²°ê³¼: "${searchTerm}" â†’ ${filtered.length}ëª…`);
            renderUsersTable(filtered);

            if (filtered.length === 0) {
                showToast(`"${searchTerm}" ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.`, 'info');
            }
        }

        // í˜„ì¬ ìƒì„¸ë³´ê¸° ì¤‘ì¸ íšŒì› ë°ì´í„°
        let currentDetailUser = null;

        /**
         * íšŒì› ìƒì„¸ ì •ë³´ í‘œì‹œ (IDë¡œ ì¡°íšŒ)
         */
        async function showUserDetailById(userId) {
            console.log('ğŸ‘¤ íšŒì› ìƒì„¸ ì¡°íšŒ:', userId);

            try {
                showLoading();

                const { data, error } = await supabaseClient
                    .from('users')
                    .select('*')
                    .eq('id', userId)
                    .single();

                if (error) throw error;

                currentDetailUser = data;
                renderUserDetailModal(data);
                document.getElementById('userDetailOverlay').style.display = 'flex';

                hideLoading();
            } catch (error) {
                console.error('âŒ íšŒì› ìƒì„¸ ì¡°íšŒ ì˜¤ë¥˜:', error);
                showToast('íšŒì› ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message, 'error');
                hideLoading();
            }
        }

        /**
         * íšŒì› ìƒì„¸ ëª¨ë‹¬ ë Œë”ë§
         */
        function renderUserDetailModal(user) {
            // ëª¨ë‹¬ ì œëª© ì—…ë°ì´íŠ¸
            const headerElem = document.getElementById('userDetailHeader');
            if (headerElem) {
                headerElem.textContent = `ğŸ‘¤ íšŒì› ìƒì„¸ - ${user.user_id || user.email}`;
            }

            // íšŒì› ID
            const userIdElem = document.getElementById('userDetailUserId');
            if (userIdElem) {
                userIdElem.innerHTML = user.user_id
                    ? `<code style="background: #f8f9fa; padding: 2px 6px; border-radius: 4px;">${user.user_id}</code>`
                    : '-';
            }

            // ì´ë©”ì¼
            const emailElem = document.getElementById('userDetailEmail');
            if (emailElem) {
                emailElem.textContent = user.email || '-';
            }

            // ë‹‰ë„¤ì„
            const nicknameElem = document.getElementById('userDetailNickname');
            if (nicknameElem) {
                nicknameElem.textContent = user.nickname || '-';
            }

            // ì‹¤ëª…
            const realNameElem = document.getElementById('userDetailRealName');
            if (realNameElem) {
                realNameElem.textContent = user.real_name || '-';
            }

            // ê°€ì…ì¼
            const createdAtElem = document.getElementById('userDetailCreatedAt');
            if (createdAtElem) {
                createdAtElem.textContent = user.created_at
                    ? new Date(user.created_at).toLocaleDateString('ko-KR')
                    : '-';
            }

            // í”Œëœ
            const planElem = document.getElementById('userDetailPlan');
            if (planElem) {
                planElem.innerHTML = getPlanBadge(user.subscription_plan);
            }

            // ì„¤ì¹˜ë¹„ ë‚©ë¶€
            const installFeeElem = document.getElementById('userDetailInstallationFee');
            if (installFeeElem) {
                installFeeElem.innerHTML = user.installation_fee_paid
                    ? '<span class="status-badge active">ë‚©ë¶€</span>'
                    : '<span class="status-badge" style="background: #6c757d; color: white;">ë¯¸ë‚©</span>';
            }

            // í¬ë ˆë”§
            const creditElem = document.getElementById('userDetailCredit');
            if (creditElem) {
                const credit = user.credit_balance || 0;
                creditElem.textContent = credit.toLocaleString() + ' C';
            }

            // ìƒíƒœ ì…€ë ‰íŠ¸ ì—…ë°ì´íŠ¸
            const statusSelect = document.getElementById('userDetailStatusSelect');
            if (statusSelect) {
                const status = user.subscription_status || 'inactive';
                statusSelect.value = status;
            }

            console.log('âœ… íšŒì› ìƒì„¸ ëª¨ë‹¬ ë Œë”ë§ ì™„ë£Œ:', user.email);
        }

        /**
         * íšŒì› ìƒíƒœ ì €ì¥ (ê¸°ì¡´ í•¨ìˆ˜ ì˜¤ë²„ë¼ì´ë“œ)
         */
        async function saveUserStatus() {
            if (!currentDetailUser) {
                showToast('íšŒì› ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.', 'error');
                return;
            }

            const statusSelect = document.getElementById('userDetailStatusSelect');
            const newStatus = statusSelect ? statusSelect.value : null;

            if (!newStatus) {
                showToast('ìƒíƒœë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.', 'error');
                return;
            }

            try {
                showLoading();

                const { error } = await supabaseClient
                    .from('users')
                    .update({ subscription_status: newStatus })
                    .eq('id', currentDetailUser.id);

                if (error) throw error;

                showToast('íšŒì› ìƒíƒœê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
                closeUserDetail();
                loadUsers(); // ëª©ë¡ ìƒˆë¡œê³ ì¹¨

                hideLoading();
            } catch (error) {
                console.error('âŒ ìƒíƒœ ì €ì¥ ì˜¤ë¥˜:', error);
                showToast('ì €ì¥ ì‹¤íŒ¨: ' + error.message, 'error');
                hideLoading();
            }
        }

        // ========================================
        // ì„¤ì¹˜ë¹„ ê´€ë¦¬ ê¸°ëŠ¥ (Agenda #5)
        // ========================================

        let installationRequests = [];

        async function loadInstallationRequests() {
            console.log('ğŸ“‹ ì„¤ì¹˜ë¹„ ìš”ì²­ ëª©ë¡ ë¡œë“œ ì‹œì‘');

            try {
                if (!supabaseClient) {
                    throw new Error('Supabase í´ë¼ì´ì–¸íŠ¸ê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                }

                // ì„¤ì¹˜ë¹„ ìš”ì²­ ëª©ë¡ ì¡°íšŒ
                const { data, error } = await supabaseClient
                    .from('installation_payment_requests')
                    .select('*')
                    .order('requested_at', { ascending: false });

                if (error) throw error;

                installationRequests = data || [];
                console.log('âœ… ì„¤ì¹˜ë¹„ ìš”ì²­ ë¡œë“œ ì„±ê³µ:', installationRequests.length, 'ê°œ');

                renderInstallationTables();
                updateInstallationStats();

            } catch (error) {
                console.error('âŒ ì„¤ì¹˜ë¹„ ìš”ì²­ ë¡œë“œ ì˜¤ë¥˜:', error);
                document.getElementById('installationPendingTableBody').innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; color: #dc3545; padding: 40px;">
                            ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. (${error.message})
                        </td>
                    </tr>
                `;
            }
        }

        function renderInstallationTables() {
            const pendingTableBody = document.getElementById('installationPendingTableBody');
            const processedTableBody = document.getElementById('installationProcessedTableBody');

            const pendingRequests = installationRequests.filter(r => r.status === 'pending');
            const processedRequests = installationRequests.filter(r => r.status !== 'pending');

            // ëŒ€ê¸° ì¤‘ ëª©ë¡
            if (pendingRequests.length === 0) {
                pendingTableBody.innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; color: #6c757d; padding: 40px;">
                            ëŒ€ê¸° ì¤‘ì¸ ì…ê¸ˆ ìš”ì²­ì´ ì—†ìŠµë‹ˆë‹¤.
                        </td>
                    </tr>
                `;
            } else {
                pendingTableBody.innerHTML = pendingRequests.map(req => `
                    <tr>
                        <td>${req.user_id || '-'}</td>
                        <td>-</td>
                        <td>-</td>
                        <td>${req.depositor_name || '-'}</td>
                        <td>â‚©${(req.amount || 0).toLocaleString()}</td>
                        <td>${formatDateTime(req.requested_at)}</td>
                        <td>
                            <a href="#" class="action-link" style="color: var(--success);" onclick="event.preventDefault(); approveInstallation('${req.id}')">âœ… ìŠ¹ì¸</a>
                            <a href="#" class="action-link" style="color: var(--danger); margin-left: 8px;" onclick="event.preventDefault(); rejectInstallation('${req.id}')">âŒ ê±°ë¶€</a>
                        </td>
                    </tr>
                `).join('');
            }

            // ì²˜ë¦¬ ì™„ë£Œ ëª©ë¡
            if (processedRequests.length === 0) {
                processedTableBody.innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; color: #6c757d; padding: 40px;">
                            ì²˜ë¦¬ëœ ìš”ì²­ì´ ì—†ìŠµë‹ˆë‹¤.
                        </td>
                    </tr>
                `;
            } else {
                processedTableBody.innerHTML = processedRequests.map(req => `
                    <tr>
                        <td>${req.user_id || '-'}</td>
                        <td>-</td>
                        <td>${req.depositor_name || '-'}</td>
                        <td>â‚©${(req.amount || 0).toLocaleString()}</td>
                        <td>${formatDateTime(req.requested_at)}</td>
                        <td>${formatDateTime(req.processed_at)}</td>
                        <td>${getInstallationStatusBadge(req.status)}</td>
                    </tr>
                `).join('');
            }
        }

        function updateInstallationStats() {
            const pendingCount = installationRequests.filter(r => r.status === 'pending').length;
            const approvedCount = installationRequests.filter(r => r.status === 'approved').length;
            const rejectedCount = installationRequests.filter(r => r.status === 'rejected').length;
            const totalAmount = installationRequests
                .filter(r => r.status === 'approved')
                .reduce((sum, r) => sum + (r.amount || 0), 0);

            document.getElementById('installationPendingCount').textContent = pendingCount;
            document.getElementById('installationApprovedCount').textContent = approvedCount;
            document.getElementById('installationRejectedCount').textContent = rejectedCount;
            document.getElementById('installationTotalAmount').textContent = 'â‚©' + totalAmount.toLocaleString();

            // ë©”ë‰´ ë±ƒì§€ ì—…ë°ì´íŠ¸
            const badge = document.getElementById('installationPendingBadge');
            if (badge) {
                if (pendingCount > 0) {
                    badge.textContent = pendingCount;
                    badge.style.display = 'inline-block';
                } else {
                    badge.style.display = 'none';
                }
            }
        }

        function getInstallationStatusBadge(status) {
            switch (status) {
                case 'approved':
                    return '<span class="status-badge active">ìŠ¹ì¸</span>';
                case 'rejected':
                    return '<span class="status-badge inactive">ê±°ë¶€</span>';
                default:
                    return '<span class="status-badge pending">ëŒ€ê¸°</span>';
            }
        }

        async function approveInstallation(requestId) {
            if (!confirm('ì´ ì…ê¸ˆ ìš”ì²­ì„ ìŠ¹ì¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nìŠ¹ì¸ ì‹œ:\n- ì„¤ì¹˜ë¹„ ë‚©ë¶€ ì™„ë£Œ ì²˜ë¦¬\n- ë¬´ë£Œ í¬ë ˆë”§ â‚©5,000 ì§€ê¸‰')) {
                return;
            }

            try {
                showLoading();

                // ìš”ì²­ ìƒíƒœ ì—…ë°ì´íŠ¸
                const { error } = await supabaseClient
                    .from('installation_payment_requests')
                    .update({
                        status: 'approved',
                        processed_at: new Date().toISOString()
                    })
                    .eq('id', requestId);

                if (error) throw error;

                showToast('ì„¤ì¹˜ë¹„ ì…ê¸ˆì´ ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
                loadInstallationRequests();

                hideLoading();
            } catch (error) {
                console.error('âŒ ìŠ¹ì¸ ì˜¤ë¥˜:', error);
                showToast('ìŠ¹ì¸ ì‹¤íŒ¨: ' + error.message, 'error');
                hideLoading();
            }
        }

        async function rejectInstallation(requestId) {
            const reason = prompt('ê±°ë¶€ ì‚¬ìœ ë¥¼ ì…ë ¥í•˜ì„¸ìš”:');
            if (!reason) {
                return;
            }

            try {
                showLoading();

                const { error } = await supabaseClient
                    .from('installation_payment_requests')
                    .update({
                        status: 'rejected',
                        reject_reason: reason,
                        processed_at: new Date().toISOString()
                    })
                    .eq('id', requestId);

                if (error) throw error;

                showToast('ì…ê¸ˆ ìš”ì²­ì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                loadInstallationRequests();

                hideLoading();
            } catch (error) {
                console.error('âŒ ê±°ë¶€ ì˜¤ë¥˜:', error);
                showToast('ê±°ë¶€ ì‹¤íŒ¨: ' + error.message, 'error');
                hideLoading();
            }
        }

        // ========================================
        // í”„ë¡œì íŠ¸ ê´€ë¦¬ ê¸°ëŠ¥ (Agenda #5)
        // ========================================

        let projects = [];

        async function loadProjects() {
            console.log('ğŸ“ í”„ë¡œì íŠ¸ ëª©ë¡ ë¡œë“œ ì‹œì‘');

            try {
                if (!supabaseClient) {
                    throw new Error('Supabase í´ë¼ì´ì–¸íŠ¸ê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                }

                const { data, error } = await supabaseClient
                    .from('projects')
                    .select('*')
                    .order('created_at', { ascending: false });

                if (error) throw error;

                projects = data || [];
                console.log('âœ… í”„ë¡œì íŠ¸ ë¡œë“œ ì„±ê³µ:', projects.length, 'ê°œ');

                renderProjectsTable();
                updateProjectsStats();

            } catch (error) {
                console.error('âŒ í”„ë¡œì íŠ¸ ë¡œë“œ ì˜¤ë¥˜:', error);
                document.getElementById('projectsTableBody').innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; color: #dc3545; padding: 40px;">
                            ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. (${error.message})
                        </td>
                    </tr>
                `;
            }
        }

        function renderProjectsTable(filteredProjects = null) {
            const tableBody = document.getElementById('projectsTableBody');
            const displayProjects = filteredProjects || projects;

            if (displayProjects.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; color: #6c757d; padding: 40px;">
                            ë“±ë¡ëœ í”„ë¡œì íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.
                        </td>
                    </tr>
                `;
                return;
            }

            tableBody.innerHTML = displayProjects.map(proj => `
                <tr>
                    <td>${proj.project_id || '-'}</td>
                    <td>${proj.project_name || '-'}</td>
                    <td>${proj.user_id || '-'}</td>
                    <td>${getProjectStatusBadge(proj.status)}</td>
                    <td>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="flex: 1; background: #e9ecef; border-radius: 4px; height: 8px; overflow: hidden;">
                                <div style="width: ${proj.progress || 0}%; height: 100%; background: ${getProgressColor(proj.progress || 0)};"></div>
                            </div>
                            <span style="font-size: 12px; font-weight: 600;">${proj.progress || 0}%</span>
                        </div>
                    </td>
                    <td>${formatDate(proj.created_at)}</td>
                    <td>
                        <a href="#" class="action-link" onclick="event.preventDefault(); viewProjectDetail('${proj.id}')">ìƒì„¸</a>
                    </td>
                </tr>
            `).join('');
        }

        function updateProjectsStats() {
            const total = projects.length;
            const inProgress = projects.filter(p => p.status === 'in_progress').length;
            const completed = projects.filter(p => p.status === 'completed').length;
            const archived = projects.filter(p => p.status === 'archived').length;

            document.getElementById('projectsTotalCount').textContent = total;
            document.getElementById('projectsInProgressCount').textContent = inProgress;
            document.getElementById('projectsCompletedCount').textContent = completed;
            document.getElementById('projectsArchivedCount').textContent = archived;
        }

        function getProjectStatusBadge(status) {
            switch (status) {
                case 'in_progress':
                    return '<span class="status-badge pending">ì§„í–‰ ì¤‘</span>';
                case 'completed':
                    return '<span class="status-badge active">ì™„ë£Œ</span>';
                case 'archived':
                    return '<span class="status-badge inactive">ë³´ê´€</span>';
                default:
                    return '<span class="status-badge">' + status + '</span>';
            }
        }

        function getProgressColor(progress) {
            if (progress >= 80) return 'var(--success)';
            if (progress >= 50) return 'var(--warning)';
            return 'var(--primary)';
        }

        function searchProjects() {
            const query = document.getElementById('projectSearchInput').value.toLowerCase().trim();

            if (!query) {
                renderProjectsTable();
                return;
            }

            const filtered = projects.filter(proj =>
                (proj.project_id || '').toLowerCase().includes(query) ||
                (proj.project_name || '').toLowerCase().includes(query) ||
                (proj.user_id || '').toLowerCase().includes(query)
            );

            renderProjectsTable(filtered);
        }

        function viewProjectDetail(projectId) {
            const project = projects.find(p => p.id === projectId);
            if (!project) {
                showToast('í”„ë¡œì íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
                return;
            }

            alert(`í”„ë¡œì íŠ¸ ìƒì„¸\n\ní”„ë¡œì íŠ¸ ID: ${project.project_id}\ní”„ë¡œì íŠ¸ëª…: ${project.project_name}\nì‚¬ìš©ì ID: ${project.user_id}\nìƒíƒœ: ${project.status}\nì§„í–‰ë¥ : ${project.progress}%\në“±ë¡ì¼: ${formatDateTime(project.created_at)}`);
        }

        // ========================================
        // ê²°ì œ ê´€ë¦¬ ê¸°ëŠ¥ (Agenda #6)
        // ========================================

        let billingHistory = [];

        async function loadBillingHistory() {
            console.log('ğŸ“‹ ê²°ì œ ë‚´ì—­ ë¡œë”© ì‹œì‘...');
            showLoading();

            try {
                // ê²°ì œ ë‚´ì—­ ì¡°íšŒ
                const { data, error } = await supabaseClient
                    .from('billing_history')
                    .select('*')
                    .order('billing_date', { ascending: false });

                if (error) throw error;

                billingHistory = data || [];
                console.log('âœ… ê²°ì œ ë‚´ì—­ ë¡œë“œ ì„±ê³µ:', billingHistory.length, 'ê°œ');

                updateBillingStats();
                renderBillingTable();

            } catch (error) {
                console.error('âŒ ê²°ì œ ë‚´ì—­ ë¡œë“œ ì˜¤ë¥˜:', error);
                document.querySelector('#payment-section .data-table tbody').innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; color: #dc3545; padding: 40px;">
                            ê²°ì œ ë‚´ì—­ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ${error.message}
                        </td>
                    </tr>
                `;
            } finally {
                hideLoading();
            }
        }

        function updateBillingStats() {
            const thisMonth = new Date().toISOString().slice(0, 7);

            // ì´ë²ˆ ë‹¬ ë§¤ì¶œ
            const monthlyRevenue = billingHistory
                .filter(b => b.billing_date && b.billing_date.startsWith(thisMonth) && b.status === 'paid')
                .reduce((sum, b) => sum + (b.amount || 0), 0);

            // ì™„ë£Œëœ ê²°ì œ
            const completedCount = billingHistory.filter(b => b.status === 'paid').length;

            // ëŒ€ê¸° ì¤‘
            const pendingCount = billingHistory.filter(b => b.status === 'pending').length;

            // í™˜ë¶ˆ
            const refundedCount = billingHistory.filter(b => b.status === 'refunded').length;

            // ì‹¤íŒ¨
            const failedCount = billingHistory.filter(b => b.status === 'failed').length;

            // í†µê³„ ì—…ë°ì´íŠ¸ (payment-section ë‚´ì˜ stat-cardë“¤)
            const statCards = document.querySelectorAll('#payment-section .stat-card .stat-value');
            if (statCards.length >= 4) {
                statCards[0].textContent = `â‚©${monthlyRevenue.toLocaleString()}`;
                statCards[1].textContent = completedCount;
                statCards[2].textContent = pendingCount + failedCount;
                statCards[3].textContent = refundedCount;
            }
        }

        function renderBillingTable() {
            const tbody = document.querySelector('#payment-section .data-table tbody');

            if (!billingHistory || billingHistory.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; color: #6c757d; padding: 40px;">
                            ê²°ì œ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.
                        </td>
                    </tr>
                `;
                return;
            }

            const statusLabels = {
                'paid': { text: 'ì™„ë£Œ', class: 'answered' },
                'failed': { text: 'ì‹¤íŒ¨', class: 'closed' },
                'refunded': { text: 'í™˜ë¶ˆ', class: 'pending' },
                'pending': { text: 'ëŒ€ê¸°', class: 'pending' }
            };

            const typeLabels = {
                'platform_fee': 'í”Œë«í¼ ì´ìš©ë£Œ',
                'credit_purchase': 'í¬ë ˆë”§ ì¶©ì „',
                'installation_fee': 'ì„¤ì¹˜ë¹„'
            };

            tbody.innerHTML = billingHistory.map(bill => {
                const status = statusLabels[bill.status] || { text: bill.status, class: '' };
                const type = typeLabels[bill.billing_type] || bill.billing_type;

                return `
                    <tr>
                        <td>${bill.id ? bill.id.slice(0, 8) : '-'}</td>
                        <td>${bill.user_id || '-'}</td>
                        <td>â‚©${(bill.amount || 0).toLocaleString()}</td>
                        <td>${bill.payment_method || '-'}</td>
                        <td><span class="status-badge ${status.class}">${status.text}</span></td>
                        <td>${formatDateTime(bill.billing_date)}</td>
                        <td>
                            <a href="#" class="action-link" onclick="event.preventDefault(); viewBillingDetail('${bill.id}')">ìƒì„¸</a>
                            ${bill.status === 'paid' ? `<a href="#" class="action-link" style="color: #dc3545;" onclick="event.preventDefault(); processRefund('${bill.id}')">í™˜ë¶ˆ</a>` : ''}
                            ${bill.status === 'failed' ? `<a href="#" class="action-link" style="color: #f59e0b;" onclick="event.preventDefault(); retryPayment('${bill.id}')">ì¬ì‹œë„</a>` : ''}
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function viewBillingDetail(billingId) {
            const bill = billingHistory.find(b => b.id === billingId);
            if (!bill) {
                showToast('ê²°ì œ ë‚´ì—­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
                return;
            }

            const typeLabels = {
                'platform_fee': 'í”Œë«í¼ ì´ìš©ë£Œ',
                'credit_purchase': 'í¬ë ˆë”§ ì¶©ì „',
                'installation_fee': 'ì„¤ì¹˜ë¹„'
            };

            const statusLabels = {
                'paid': 'ê²°ì œ ì™„ë£Œ',
                'failed': 'ê²°ì œ ì‹¤íŒ¨',
                'refunded': 'í™˜ë¶ˆ',
                'pending': 'ëŒ€ê¸° ì¤‘'
            };

            let details = `ê²°ì œ ìƒì„¸ ì •ë³´\n\n`;
            details += `ê²°ì œ ID: ${bill.id}\n`;
            details += `ì‚¬ìš©ì ID: ${bill.user_id}\n`;
            details += `ê²°ì œ ìœ í˜•: ${typeLabels[bill.billing_type] || bill.billing_type}\n`;
            details += `ê¸ˆì•¡: â‚©${(bill.amount || 0).toLocaleString()}\n`;
            details += `ìƒíƒœ: ${statusLabels[bill.status] || bill.status}\n`;
            details += `ê²°ì œ ìˆ˜ë‹¨: ${bill.payment_method || '-'}\n`;
            details += `ê²°ì œì¼: ${formatDateTime(bill.billing_date)}\n`;

            if (bill.failure_reason) {
                details += `ì‹¤íŒ¨ ì‚¬ìœ : ${bill.failure_reason}\n`;
            }
            if (bill.refund_reason) {
                details += `í™˜ë¶ˆ ì‚¬ìœ : ${bill.refund_reason}\n`;
                details += `í™˜ë¶ˆ ê¸ˆì•¡: â‚©${(bill.refund_amount || 0).toLocaleString()}\n`;
                details += `í™˜ë¶ˆì¼: ${formatDateTime(bill.refund_date)}\n`;
            }
            if (bill.receipt_url) {
                details += `ì˜ìˆ˜ì¦: ${bill.receipt_url}\n`;
            }

            alert(details);
        }

        async function processRefund(billingId) {
            const reason = prompt('í™˜ë¶ˆ ì‚¬ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”:');
            if (!reason) return;

            const bill = billingHistory.find(b => b.id === billingId);
            if (!bill) {
                showToast('ê²°ì œ ë‚´ì—­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
                return;
            }

            if (!confirm(`â‚©${bill.amount.toLocaleString()}ì„ í™˜ë¶ˆ ì²˜ë¦¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) return;

            showLoading();
            try {
                const { error } = await supabaseClient
                    .from('billing_history')
                    .update({
                        status: 'refunded',
                        refund_amount: bill.amount,
                        refund_date: new Date().toISOString(),
                        refund_reason: reason
                    })
                    .eq('id', billingId);

                if (error) throw error;

                showToast('í™˜ë¶ˆ ì²˜ë¦¬ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                loadBillingHistory();

            } catch (error) {
                console.error('í™˜ë¶ˆ ì²˜ë¦¬ ì‹¤íŒ¨:', error);
                showToast('í™˜ë¶ˆ ì²˜ë¦¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message, 'error');
            } finally {
                hideLoading();
            }
        }

        async function retryPayment(billingId) {
            if (!confirm('ê²°ì œë¥¼ ì¬ì‹œë„í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

            showLoading();
            try {
                // ì¬ì‹œë„ íšŸìˆ˜ ì¦ê°€ (ì‹¤ì œ ê²°ì œ ì¬ì‹œë„ëŠ” í† ìŠ¤í˜ì´ë¨¼ì¸  ì—°ë™ í•„ìš”)
                const bill = billingHistory.find(b => b.id === billingId);

                const { error } = await supabaseClient
                    .from('billing_history')
                    .update({
                        retry_count: (bill.retry_count || 0) + 1
                    })
                    .eq('id', billingId);

                if (error) throw error;

                showToast('ê²°ì œ ì¬ì‹œë„ê°€ ìš”ì²­ë˜ì—ˆìŠµë‹ˆë‹¤. (í† ìŠ¤í˜ì´ë¨¼ì¸  ì—°ë™ í•„ìš”)', 'info');
                loadBillingHistory();

            } catch (error) {
                console.error('ê²°ì œ ì¬ì‹œë„ ì‹¤íŒ¨:', error);
                showToast('ê²°ì œ ì¬ì‹œë„ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message, 'error');
            } finally {
                hideLoading();
            }
        }

        // ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
        function formatDateTime(dateStr) {
            if (!dateStr) return '-';
            const date = new Date(dateStr);
            return `${date.getFullYear()}.${String(date.getMonth() + 1).padStart(2, '0')}.${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`;
        }

        function formatDate(dateStr) {
            if (!dateStr) return '-';
            const date = new Date(dateStr);
            return `${date.getFullYear()}.${String(date.getMonth() + 1).padStart(2, '0')}.${String(date.getDate()).padStart(2, '0')}`;
        }

        // ========================================
        // AI í¬ë ˆë”§ ê´€ë¦¬ í•¨ìˆ˜ë“¤ (Agenda #7)
        // ========================================

        async function loadCreditData() {
            await Promise.all([
                loadAIPricing(),
                loadUserCredits(),
                loadCreditTransactions(),
                loadAIUsageLog(),
                loadLowBalanceUsers(),
                loadCreditStats()
            ]);
        }

        async function loadCreditStats() {
            try {
                // ì „ì²´ í¬ë ˆë”§ ì”ì•¡
                const { data: users } = await supabaseClient
                    .from('users')
                    .select('credit_balance');

                if (users) {
                    const totalBalance = users.reduce((sum, u) => sum + (u.credit_balance || 0), 0);
                    document.getElementById('creditTotalBalance').textContent = `â‚©${totalBalance.toLocaleString()}`;
                }

                // ì˜¤ëŠ˜ ì¶©ì „/ì‚¬ìš©
                const today = new Date();
                today.setHours(0, 0, 0, 0);

                const { data: todayTrans } = await supabaseClient
                    .from('credit_transactions')
                    .select('*')
                    .gte('created_at', today.toISOString());

                if (todayTrans) {
                    const todayCharge = todayTrans
                        .filter(t => t.type === 'charge' || t.type === 'bonus')
                        .reduce((sum, t) => sum + t.amount, 0);
                    const todayUsage = todayTrans
                        .filter(t => t.type === 'spend')
                        .reduce((sum, t) => sum + Math.abs(t.amount), 0);

                    document.getElementById('creditTodayCharge').textContent = `+â‚©${todayCharge.toLocaleString()}`;
                    document.getElementById('creditTodayUsage').textContent = `-â‚©${todayUsage.toLocaleString()}`;
                }

                // AI ì‚¬ìš© íšŸìˆ˜
                const { data: usageCount, count } = await supabaseClient
                    .from('ai_usage_log')
                    .select('*', { count: 'exact', head: true });

                document.getElementById('creditAIUsageCount').textContent = `${count || 0}íšŒ`;

            } catch (error) {
                console.error('í¬ë ˆë”§ í†µê³„ ë¡œë“œ ì‹¤íŒ¨:', error);
            }
        }

        async function loadAIPricing() {
            try {
                const { data: pricing, error } = await supabaseClient
                    .from('ai_service_pricing')
                    .select('*')
                    .order('price_per_use', { ascending: false });

                if (error) throw error;

                const tbody = document.getElementById('aiPricingTableBody');
                if (!pricing || pricing.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="7" style="text-align:center;color:#6c757d;padding:40px;">ë“±ë¡ëœ AI ì„œë¹„ìŠ¤ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
                    return;
                }

                const serviceIcons = {
                    'ChatGPT': 'ğŸŸ¢',
                    'Gemini': 'ğŸ”µ',
                    'Perplexity': 'ğŸŸ '
                };

                tbody.innerHTML = pricing.map(p => `
                    <tr>
                        <td><strong>${serviceIcons[p.service_name] || 'ğŸ¤–'} ${DOMPurify.sanitize(p.service_name)}</strong></td>
                        <td style="font-weight:600;color:var(--primary);">â‚©${p.price_per_use.toLocaleString()}</td>
                        <td>â‚©${(p.api_cost || 0).toLocaleString()}</td>
                        <td>${p.margin_percent || 0}%</td>
                        <td>${DOMPurify.sanitize(p.description || '-')}</td>
                        <td><span class="status-badge ${p.is_active ? 'active' : 'inactive'}">${p.is_active ? 'í™œì„±' : 'ë¹„í™œì„±'}</span></td>
                        <td>
                            <a href="#" class="action-link" onclick="editAIPricing('${p.service_name}')">ìˆ˜ì •</a>
                            <a href="#" class="action-link" onclick="toggleAIPricing('${p.service_name}', ${!p.is_active})">${p.is_active ? 'ë¹„í™œì„±í™”' : 'í™œì„±í™”'}</a>
                        </td>
                    </tr>
                `).join('');

            } catch (error) {
                console.error('AI ê°€ê²© ë¡œë“œ ì‹¤íŒ¨:', error);
                document.getElementById('aiPricingTableBody').innerHTML =
                    '<tr><td colspan="7" style="text-align:center;color:#dc3545;padding:40px;">ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨</td></tr>';
            }
        }

        async function loadUserCredits() {
            try {
                const { data: users, error } = await supabaseClient
                    .from('users')
                    .select('user_id, name, email, credit_balance, updated_at')
                    .order('credit_balance', { ascending: false })
                    .limit(20);

                if (error) throw error;

                const tbody = document.getElementById('userCreditTableBody');
                if (!users || users.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="5" style="text-align:center;color:#6c757d;padding:40px;">ë“±ë¡ëœ ì‚¬ìš©ìê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
                    return;
                }

                tbody.innerHTML = users.map(u => `
                    <tr>
                        <td>${DOMPurify.sanitize(u.user_id)}</td>
                        <td>${DOMPurify.sanitize(u.name || '-')}</td>
                        <td style="font-weight:600;color:${(u.credit_balance || 0) < 1000 ? 'var(--danger)' : 'var(--success)'};">â‚©${(u.credit_balance || 0).toLocaleString()}</td>
                        <td>${formatDateTime(u.updated_at)}</td>
                        <td>
                            <a href="#" class="action-link" onclick="showUserCreditHistory('${u.user_id}')">ë‚´ì—­</a>
                            <a href="#" class="action-link" onclick="chargeUserCredit('${u.user_id}', '${u.name || u.user_id}')">ì¶©ì „</a>
                        </td>
                    </tr>
                `).join('');

            } catch (error) {
                console.error('ì‚¬ìš©ì í¬ë ˆë”§ ë¡œë“œ ì‹¤íŒ¨:', error);
                document.getElementById('userCreditTableBody').innerHTML =
                    '<tr><td colspan="5" style="text-align:center;color:#dc3545;padding:40px;">ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨</td></tr>';
            }
        }

        async function loadCreditTransactions() {
            try {
                const { data: transactions, error } = await supabaseClient
                    .from('credit_transactions')
                    .select('*')
                    .order('created_at', { ascending: false })
                    .limit(20);

                if (error) throw error;

                const tbody = document.getElementById('creditTransactionsTableBody');
                if (!transactions || transactions.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="7" style="text-align:center;color:#6c757d;padding:40px;">ê±°ë˜ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
                    return;
                }

                const typeLabels = {
                    'charge': { text: 'ì¶©ì „', class: 'active' },
                    'spend': { text: 'ì‚¬ìš©', class: 'warning' },
                    'refund': { text: 'í™˜ë¶ˆ', class: 'pending' },
                    'bonus': { text: 'ë³´ë„ˆìŠ¤', class: 'active' },
                    'expire': { text: 'ë§Œë£Œ', class: 'inactive' }
                };

                tbody.innerHTML = transactions.map(t => {
                    const typeInfo = typeLabels[t.type] || { text: t.type, class: 'neutral' };
                    return `
                        <tr>
                            <td>${formatDateTime(t.created_at)}</td>
                            <td>${DOMPurify.sanitize(t.user_id)}</td>
                            <td><span class="status-badge ${typeInfo.class}">${typeInfo.text}</span></td>
                            <td style="font-weight:600;color:${t.amount >= 0 ? 'var(--success)' : 'var(--danger)'};">${t.amount >= 0 ? '+' : ''}â‚©${t.amount.toLocaleString()}</td>
                            <td>â‚©${t.balance_after.toLocaleString()}</td>
                            <td>${DOMPurify.sanitize(t.description || '-')}</td>
                            <td>${t.related_service ? DOMPurify.sanitize(t.related_service) : '-'}</td>
                        </tr>
                    `;
                }).join('');

            } catch (error) {
                console.error('ê±°ë˜ ë‚´ì—­ ë¡œë“œ ì‹¤íŒ¨:', error);
                document.getElementById('creditTransactionsTableBody').innerHTML =
                    '<tr><td colspan="7" style="text-align:center;color:#dc3545;padding:40px;">ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨</td></tr>';
            }
        }

        async function loadAIUsageLog() {
            try {
                const { data: logs, error } = await supabaseClient
                    .from('ai_usage_log')
                    .select('*')
                    .order('created_at', { ascending: false })
                    .limit(20);

                if (error) throw error;

                const tbody = document.getElementById('aiUsageLogTableBody');
                if (!logs || logs.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="7" style="text-align:center;color:#6c757d;padding:40px;">ì‚¬ìš© ë¡œê·¸ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
                    return;
                }

                const serviceIcons = {
                    'ChatGPT': 'ğŸŸ¢',
                    'Gemini': 'ğŸ”µ',
                    'Perplexity': 'ğŸŸ '
                };

                tbody.innerHTML = logs.map(l => `
                    <tr>
                        <td>${formatDateTime(l.created_at)}</td>
                        <td>${DOMPurify.sanitize(l.user_id)}</td>
                        <td>${serviceIcons[l.service_name] || 'ğŸ¤–'} ${DOMPurify.sanitize(l.service_name)}</td>
                        <td>${(l.tokens_used || 0).toLocaleString()}</td>
                        <td style="color:var(--danger);">-â‚©${l.cost.toLocaleString()}</td>
                        <td>${l.response_time_ms || 0}ms</td>
                        <td title="${DOMPurify.sanitize(l.prompt || '')}">${DOMPurify.sanitize((l.prompt || '').substring(0, 30))}...</td>
                    </tr>
                `).join('');

            } catch (error) {
                console.error('AI ì‚¬ìš© ë¡œê·¸ ë¡œë“œ ì‹¤íŒ¨:', error);
                document.getElementById('aiUsageLogTableBody').innerHTML =
                    '<tr><td colspan="7" style="text-align:center;color:#dc3545;padding:40px;">ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨</td></tr>';
            }
        }

        async function loadLowBalanceUsers() {
            try {
                const { data: users, error } = await supabaseClient
                    .from('users')
                    .select('user_id, name, credit_balance')
                    .lt('credit_balance', 1000)
                    .order('credit_balance', { ascending: true });

                if (error) throw error;

                const tbody = document.getElementById('lowBalanceTableBody');
                if (!users || users.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="3" style="text-align:center;color:#6c757d;padding:40px;">ì”ì•¡ ë¶€ì¡± ì‚¬ìš©ì ì—†ìŒ</td></tr>';
                    return;
                }

                tbody.innerHTML = users.map(u => `
                    <tr>
                        <td>${DOMPurify.sanitize(u.name || u.user_id)}</td>
                        <td style="color:var(--danger);font-weight:600;">â‚©${(u.credit_balance || 0).toLocaleString()}</td>
                        <td>
                            <a href="#" class="action-link" onclick="chargeUserCredit('${u.user_id}', '${u.name || u.user_id}')">ì¶©ì „</a>
                        </td>
                    </tr>
                `).join('');

            } catch (error) {
                console.error('ì”ì•¡ ë¶€ì¡± ì‚¬ìš©ì ë¡œë“œ ì‹¤íŒ¨:', error);
                document.getElementById('lowBalanceTableBody').innerHTML =
                    '<tr><td colspan="3" style="text-align:center;color:#dc3545;padding:40px;">ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨</td></tr>';
            }
        }

        async function toggleAIPricing(serviceName, active) {
            if (!confirm(`${serviceName}ì„(ë¥¼) ${active ? 'í™œì„±í™”' : 'ë¹„í™œì„±í™”'} í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) return;

            showLoading();
            try {
                const { error } = await supabaseClient
                    .from('ai_service_pricing')
                    .update({ is_active: active, updated_at: new Date().toISOString() })
                    .eq('service_name', serviceName);

                if (error) throw error;

                showToast(`${serviceName} ${active ? 'í™œì„±í™”' : 'ë¹„í™œì„±í™”'} ì™„ë£Œ`, 'success');
                await loadAIPricing();

            } catch (error) {
                showToast('ì²˜ë¦¬ ì‹¤íŒ¨: ' + error.message, 'error');
            } finally {
                hideLoading();
            }
        }

        function editAIPricing(serviceName) {
            const newPrice = prompt(`${serviceName}ì˜ ìƒˆ ê°€ê²©ì„ ì…ë ¥í•˜ì„¸ìš” (ì›):`);
            if (!newPrice || isNaN(parseInt(newPrice))) return;

            updateAIPricing(serviceName, parseInt(newPrice));
        }

        async function updateAIPricing(serviceName, newPrice) {
            showLoading();
            try {
                const { error } = await supabaseClient
                    .from('ai_service_pricing')
                    .update({ price_per_use: newPrice, updated_at: new Date().toISOString() })
                    .eq('service_name', serviceName);

                if (error) throw error;

                showToast(`${serviceName} ê°€ê²©ì´ â‚©${newPrice.toLocaleString()}ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.`, 'success');
                await loadAIPricing();

            } catch (error) {
                showToast('ê°€ê²© ë³€ê²½ ì‹¤íŒ¨: ' + error.message, 'error');
            } finally {
                hideLoading();
            }
        }

        function showUserCreditHistory(userId) {
            showToast(`${userId} ì‚¬ìš©ìì˜ ìƒì„¸ ë‚´ì—­ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.`, 'info');
        }

        async function chargeUserCredit(userId, userName) {
            const amount = prompt(`${userName}ì—ê²Œ ì¶©ì „í•  ê¸ˆì•¡ì„ ì…ë ¥í•˜ì„¸ìš” (ì›):`);
            if (!amount || isNaN(parseInt(amount))) return;

            const chargeAmount = parseInt(amount);
            const reason = prompt('ì¶©ì „ ì‚¬ìœ ë¥¼ ì…ë ¥í•˜ì„¸ìš”:') || 'ê´€ë¦¬ì ìˆ˜ë™ ì¶©ì „';

            showLoading();
            try {
                // í˜„ì¬ ì”ì•¡ ì¡°íšŒ
                const { data: user } = await supabaseClient
                    .from('users')
                    .select('credit_balance')
                    .eq('user_id', userId)
                    .single();

                const currentBalance = user?.credit_balance || 0;
                const newBalance = currentBalance + chargeAmount;

                // ê±°ë˜ ë‚´ì—­ ì¶”ê°€
                const { error: transError } = await supabaseClient
                    .from('credit_transactions')
                    .insert({
                        user_id: userId,
                        type: chargeAmount >= 0 ? 'bonus' : 'spend',
                        amount: chargeAmount,
                        balance_after: newBalance,
                        description: reason
                    });

                if (transError) throw transError;

                // ì‚¬ìš©ì ì”ì•¡ ì—…ë°ì´íŠ¸
                const { error: userError } = await supabaseClient
                    .from('users')
                    .update({ credit_balance: newBalance })
                    .eq('user_id', userId);

                if (userError) throw userError;

                showToast(`${userName}ì—ê²Œ â‚©${chargeAmount.toLocaleString()} ${chargeAmount >= 0 ? 'ì¶©ì „' : 'ì°¨ê°'} ì™„ë£Œ`, 'success');
                await loadCreditData();

            } catch (error) {
                showToast('ì²˜ë¦¬ ì‹¤íŒ¨: ' + error.message, 'error');
            } finally {
                hideLoading();
            }
        }

        function showCreditChargeModal() {
            const userId = prompt('ì¶©ì „í•  ì‚¬ìš©ì IDë¥¼ ì…ë ¥í•˜ì„¸ìš”:');
            if (!userId) return;
            chargeUserCredit(userId, userId);
        }

        function exportCreditTransactions() {
            showToast('CSV ë‚´ë³´ë‚´ê¸° ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.', 'info');
        }

        // ========================================
        // ë¬¸ì˜ ê´€ë¦¬ (Inquiries) í•¨ìˆ˜ë“¤
        // ========================================
        let allInquiries = [];
        let currentInquiryFilter = 'all';

        async function loadInquiriesData() {
            try {
                showLoading();
                await Promise.all([
                    loadInquiriesStats(),
                    loadInquiriesList()
                ]);
            } catch (error) {
                console.error('ë¬¸ì˜ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                showToast('ë¬¸ì˜ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
            } finally {
                hideLoading();
            }
        }

        async function loadInquiriesStats() {
            try {
                const { data, error } = await supabaseClient
                    .from('inquiries')
                    .select('status');

                if (error) throw error;

                const total = data.length;
                const pending = data.filter(i => i.status === 'pending').length;
                const inProgress = data.filter(i => i.status === 'in_progress').length;
                const answered = data.filter(i => i.status === 'answered' || i.status === 'closed').length;

                document.getElementById('inquiriesTotalCount').textContent = total;
                document.getElementById('inquiriesPendingCount').textContent = pending;
                document.getElementById('inquiriesInProgressCount').textContent = inProgress;
                document.getElementById('inquiriesAnsweredCount').textContent = answered;
            } catch (error) {
                console.error('ë¬¸ì˜ í†µê³„ ë¡œë“œ ì‹¤íŒ¨:', error);
            }
        }

        async function loadInquiriesList() {
            try {
                const { data, error } = await supabaseClient
                    .from('inquiries')
                    .select('*')
                    .order('created_at', { ascending: false });

                if (error) throw error;

                allInquiries = data || [];
                renderInquiriesTable(allInquiries);
            } catch (error) {
                console.error('ë¬¸ì˜ ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:', error);
                document.getElementById('inquiriesTableBody').innerHTML = `
                    <tr>
                        <td colspan="8" style="text-align: center; padding: 40px; color: #dc3545;">
                            ë¬¸ì˜ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.
                        </td>
                    </tr>
                `;
            }
        }

        function filterInquiries(filter) {
            currentInquiryFilter = filter;

            // ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
            document.getElementById('btnInquiryAll').style.background = filter === 'all' ? 'var(--primary)' : 'var(--neutral)';
            document.getElementById('btnInquiryPending').style.background = filter === 'pending' ? 'var(--danger)' : 'var(--neutral)';
            document.getElementById('btnInquiryInProgress').style.background = filter === 'in_progress' ? 'var(--warning)' : 'var(--neutral)';
            document.getElementById('btnInquiryAnswered').style.background = filter === 'answered' ? 'var(--success)' : 'var(--neutral)';

            let filtered = allInquiries;
            if (filter !== 'all') {
                if (filter === 'answered') {
                    filtered = allInquiries.filter(i => i.status === 'answered' || i.status === 'closed');
                } else {
                    filtered = allInquiries.filter(i => i.status === filter);
                }
            }

            renderInquiriesTable(filtered);
        }

        function renderInquiriesTable(inquiries) {
            const tbody = document.getElementById('inquiriesTableBody');

            if (!inquiries || inquiries.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="8" style="text-align: center; padding: 40px; color: #6c757d;">
                            ë¬¸ì˜ê°€ ì—†ìŠµë‹ˆë‹¤.
                        </td>
                    </tr>
                `;
                return;
            }

            const typeLabels = {
                'general': 'ì¼ë°˜ ë¬¸ì˜',
                'technical': 'ê¸°ìˆ  ì§€ì›',
                'payment': 'ê²°ì œ/í™˜ë¶ˆ',
                'account': 'ê³„ì • ê´€ë ¨',
                'partnership': 'ì œíœ´/í˜‘ë ¥',
                'other': 'ê¸°íƒ€'
            };

            const typeColors = {
                'general': '#6c757d',
                'technical': '#0099ff',
                'payment': '#28a745',
                'account': '#6B5CCC',
                'partnership': '#CC785C',
                'other': '#868e96'
            };

            const statusLabels = {
                'pending': 'ëŒ€ê¸°',
                'in_progress': 'ì²˜ë¦¬ì¤‘',
                'answered': 'ì™„ë£Œ',
                'closed': 'ì¢…ë£Œ'
            };

            const statusClasses = {
                'pending': 'pending',
                'in_progress': 'active',
                'answered': 'answered',
                'closed': 'answered'
            };

            const priorityLabels = {
                'low': 'ë‚®ìŒ',
                'normal': 'ë³´í†µ',
                'high': 'ë†’ìŒ',
                'urgent': 'ê¸´ê¸‰'
            };

            const priorityColors = {
                'low': '#6c757d',
                'normal': '#0099ff',
                'high': '#ffc107',
                'urgent': '#dc3545'
            };

            tbody.innerHTML = inquiries.map(inquiry => `
                <tr>
                    <td>
                        <span style="display: inline-block; padding: 4px 8px; border-radius: 4px; font-size: 11px; font-weight: 500; background: ${typeColors[inquiry.inquiry_type] || '#6c757d'}20; color: ${typeColors[inquiry.inquiry_type] || '#6c757d'};">
                            ${DOMPurify.sanitize(typeLabels[inquiry.inquiry_type] || inquiry.inquiry_type)}
                        </span>
                    </td>
                    <td style="max-width: 200px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                        ${DOMPurify.sanitize(inquiry.title)}
                    </td>
                    <td>${DOMPurify.sanitize(inquiry.name)}</td>
                    <td>${DOMPurify.sanitize(inquiry.email)}</td>
                    <td>
                        <span class="status-badge ${statusClasses[inquiry.status] || 'pending'}">
                            ${statusLabels[inquiry.status] || inquiry.status}
                        </span>
                    </td>
                    <td>
                        <span style="color: ${priorityColors[inquiry.priority] || '#6c757d'}; font-weight: 500;">
                            ${priorityLabels[inquiry.priority] || inquiry.priority}
                        </span>
                    </td>
                    <td>${formatDateTime(inquiry.created_at)}</td>
                    <td>
                        <a href="#" class="action-link" onclick="event.preventDefault(); showInquiryDetail('${inquiry.id}')">
                            ${inquiry.status === 'pending' || inquiry.status === 'in_progress' ? 'ë‹µë³€í•˜ê¸°' : 'ë³´ê¸°'}
                        </a>
                    </td>
                </tr>
            `).join('');
        }

        function formatDateTime(dateStr) {
            if (!dateStr) return '-';
            const date = new Date(dateStr);
            return date.toLocaleDateString('ko-KR') + ' ' + date.toLocaleTimeString('ko-KR', { hour: '2-digit', minute: '2-digit' });
        }

        function showInquiryDetail(inquiryId) {
            const inquiry = allInquiries.find(i => i.id === inquiryId);
            if (!inquiry) return;

            const typeLabels = {
                'general': 'ì¼ë°˜ ë¬¸ì˜',
                'technical': 'ê¸°ìˆ  ì§€ì›',
                'payment': 'ê²°ì œ/í™˜ë¶ˆ',
                'account': 'ê³„ì • ê´€ë ¨',
                'partnership': 'ì œíœ´/í˜‘ë ¥',
                'other': 'ê¸°íƒ€'
            };

            const statusLabels = {
                'pending': 'ëŒ€ê¸° ì¤‘',
                'in_progress': 'ì²˜ë¦¬ ì¤‘',
                'answered': 'ë‹µë³€ ì™„ë£Œ',
                'closed': 'ì¢…ë£Œ'
            };

            const priorityLabels = {
                'low': 'ë‚®ìŒ',
                'normal': 'ë³´í†µ',
                'high': 'ë†’ìŒ',
                'urgent': 'ê¸´ê¸‰'
            };

            const content = document.getElementById('inquiryDetailContent');
            content.innerHTML = `
                <div style="margin-bottom: 24px;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px;">
                        <div>
                            <div style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">ë¬¸ì˜ ìœ í˜•</div>
                            <div style="font-weight: 500;">${DOMPurify.sanitize(typeLabels[inquiry.inquiry_type] || inquiry.inquiry_type)}</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">ìš°ì„ ìˆœìœ„</div>
                            <div style="font-weight: 500;">${DOMPurify.sanitize(priorityLabels[inquiry.priority] || inquiry.priority)}</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">ì‘ì„±ì</div>
                            <div style="font-weight: 500;">${DOMPurify.sanitize(inquiry.name)}</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">ì´ë©”ì¼</div>
                            <div style="font-weight: 500;">${DOMPurify.sanitize(inquiry.email)}</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">ì—°ë½ì²˜</div>
                            <div style="font-weight: 500;">${DOMPurify.sanitize(inquiry.phone || '-')}</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">ì ‘ìˆ˜ì¼</div>
                            <div style="font-weight: 500;">${formatDateTime(inquiry.created_at)}</div>
                        </div>
                    </div>

                    <div style="margin-bottom: 16px;">
                        <div style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">ì œëª©</div>
                        <div style="font-weight: 600; font-size: 16px;">${DOMPurify.sanitize(inquiry.title)}</div>
                    </div>

                    <div style="margin-bottom: 16px;">
                        <div style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">ë¬¸ì˜ ë‚´ìš©</div>
                        <div style="background: #f8f9fa; padding: 16px; border-radius: 8px; white-space: pre-wrap;">${DOMPurify.sanitize(inquiry.content)}</div>
                    </div>

                    ${inquiry.answer ? `
                        <div style="margin-bottom: 16px;">
                            <div style="font-size: 12px; color: #6c757d; margin-bottom: 4px;">ë‹µë³€ (${formatDateTime(inquiry.answered_at)})</div>
                            <div style="background: #e8f5e9; padding: 16px; border-radius: 8px; white-space: pre-wrap;">${DOMPurify.sanitize(inquiry.answer)}</div>
                        </div>
                    ` : ''}

                    ${inquiry.status === 'pending' || inquiry.status === 'in_progress' ? `
                        <div style="margin-top: 24px;">
                            <div style="font-size: 12px; color: #6c757d; margin-bottom: 8px;">ë‹µë³€ ì‘ì„±</div>
                            <textarea id="inquiryAnswerText" style="width: 100%; min-height: 150px; padding: 12px; border: 1px solid #dee2e6; border-radius: 8px; font-family: inherit; resize: vertical;" placeholder="ë‹µë³€ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
                            <div style="display: flex; gap: 10px; margin-top: 12px;">
                                <button onclick="submitInquiryAnswer('${inquiry.id}')" style="flex: 1; padding: 12px; background: var(--primary); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">ë‹µë³€ ì €ì¥</button>
                                <button onclick="updateInquiryStatus('${inquiry.id}', 'in_progress')" style="padding: 12px 20px; background: var(--warning); color: white; border: none; border-radius: 8px; cursor: pointer;">ì²˜ë¦¬ì¤‘ìœ¼ë¡œ ë³€ê²½</button>
                            </div>
                        </div>
                    ` : ''}
                </div>
            `;

            document.getElementById('inquiryDetailModal').style.display = 'flex';
        }

        function closeInquiryModal() {
            document.getElementById('inquiryDetailModal').style.display = 'none';
        }

        async function submitInquiryAnswer(inquiryId) {
            const answerText = document.getElementById('inquiryAnswerText').value.trim();
            if (!answerText) {
                showToast('ë‹µë³€ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'warning');
                return;
            }

            try {
                showLoading();
                const { error } = await supabaseClient
                    .from('inquiries')
                    .update({
                        answer: answerText,
                        status: 'answered',
                        answered_at: new Date().toISOString(),
                        answered_by: 'ADMIN001'
                    })
                    .eq('id', inquiryId);

                if (error) throw error;

                showToast('ë‹µë³€ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                closeInquiryModal();
                await loadInquiriesData();
            } catch (error) {
                console.error('ë‹µë³€ ì €ì¥ ì‹¤íŒ¨:', error);
                showToast('ë‹µë³€ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
            } finally {
                hideLoading();
            }
        }

        async function updateInquiryStatus(inquiryId, status) {
            try {
                showLoading();
                const { error } = await supabaseClient
                    .from('inquiries')
                    .update({ status: status })
                    .eq('id', inquiryId);

                if (error) throw error;

                showToast('ìƒíƒœê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                closeInquiryModal();
                await loadInquiriesData();
            } catch (error) {
                console.error('ìƒíƒœ ë³€ê²½ ì‹¤íŒ¨:', error);
                showToast('ìƒíƒœ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
            } finally {
                hideLoading();
            }
        }

    </script>
</body>
</html>
